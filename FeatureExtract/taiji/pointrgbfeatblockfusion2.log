/usr/local/python38/lib/python3.8/site-packages/torch/utils/cpp_extension.py:284: UserWarning: 

                               !! WARNING !!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Your compiler (c++) is not compatible with the compiler Pytorch was
built with for this platform, which is g++ on linux. Please
use g++ to to compile your extension. Alternatively, you may
compile PyTorch from source using c++, and then you can also use
c++ to compile your extension.

See https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md for help
with compiling PyTorch from source.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

                              !! WARNING !!

  warnings.warn(WRONG_COMPILER_WARNING.format(
unexpected_keys
['mask_token', 'decoder_pos_embed.0.weight', 'decoder_pos_embed.0.bias', 'decoder_pos_embed.2.weight', 'decoder_pos_embed.2.bias', 'MAE_decoder.blocks.0.norm1.weight', 'MAE_decoder.blocks.0.norm1.bias', 'MAE_decoder.blocks.0.norm2.weight', 'MAE_decoder.blocks.0.norm2.bias', 'MAE_decoder.blocks.0.mlp.fc1.weight', 'MAE_decoder.blocks.0.mlp.fc1.bias', 'MAE_decoder.blocks.0.mlp.fc2.weight', 'MAE_decoder.blocks.0.mlp.fc2.bias', 'MAE_decoder.blocks.0.attn.qkv.weight', 'MAE_decoder.blocks.0.attn.proj.weight', 'MAE_decoder.blocks.0.attn.proj.bias', 'MAE_decoder.blocks.1.norm1.weight', 'MAE_decoder.blocks.1.norm1.bias', 'MAE_decoder.blocks.1.norm2.weight', 'MAE_decoder.blocks.1.norm2.bias', 'MAE_decoder.blocks.1.mlp.fc1.weight', 'MAE_decoder.blocks.1.mlp.fc1.bias', 'MAE_decoder.blocks.1.mlp.fc2.weight', 'MAE_decoder.blocks.1.mlp.fc2.bias', 'MAE_decoder.blocks.1.attn.qkv.weight', 'MAE_decoder.blocks.1.attn.proj.weight', 'MAE_decoder.blocks.1.attn.proj.bias', 'MAE_decoder.blocks.2.norm1.weight', 'MAE_decoder.blocks.2.norm1.bias', 'MAE_decoder.blocks.2.norm2.weight', 'MAE_decoder.blocks.2.norm2.bias', 'MAE_decoder.blocks.2.mlp.fc1.weight', 'MAE_decoder.blocks.2.mlp.fc1.bias', 'MAE_decoder.blocks.2.mlp.fc2.weight', 'MAE_decoder.blocks.2.mlp.fc2.bias', 'MAE_decoder.blocks.2.attn.qkv.weight', 'MAE_decoder.blocks.2.attn.proj.weight', 'MAE_decoder.blocks.2.attn.proj.bias', 'MAE_decoder.blocks.3.norm1.weight', 'MAE_decoder.blocks.3.norm1.bias', 'MAE_decoder.blocks.3.norm2.weight', 'MAE_decoder.blocks.3.norm2.bias', 'MAE_decoder.blocks.3.mlp.fc1.weight', 'MAE_decoder.blocks.3.mlp.fc1.bias', 'MAE_decoder.blocks.3.mlp.fc2.weight', 'MAE_decoder.blocks.3.mlp.fc2.bias', 'MAE_decoder.blocks.3.attn.qkv.weight', 'MAE_decoder.blocks.3.attn.proj.weight', 'MAE_decoder.blocks.3.attn.proj.bias', 'MAE_decoder.norm.weight', 'MAE_decoder.norm.bias', 'increase_dim.0.weight', 'increase_dim.0.bias']
[Transformer] Successful Loading the ckpt from checkpoints/pointmae_pretrain.pth
point: <All keys matched successfully>
7fusion_block: <All keys matched successfully>
Extracting train features for class bagel:   0%|          | 0/244 [00:00<?, ?it/s]Extracting train features for class bagel:   0%|          | 1/244 [00:03<14:14,  3.52s/it]Extracting train features for class bagel:   1%|          | 2/244 [00:06<13:20,  3.31s/it]Extracting train features for class bagel:   1%|          | 3/244 [00:09<11:31,  2.87s/it]Extracting train features for class bagel:   2%|▏         | 4/244 [00:11<10:54,  2.73s/it]Extracting train features for class bagel:   2%|▏         | 5/244 [00:14<11:41,  2.94s/it]Extracting train features for class bagel:   2%|▏         | 6/244 [00:18<12:26,  3.14s/it]Extracting train features for class bagel:   3%|▎         | 7/244 [00:21<12:52,  3.26s/it]Extracting train features for class bagel:   3%|▎         | 8/244 [00:25<12:43,  3.23s/it]Extracting train features for class bagel:   4%|▎         | 9/244 [00:28<12:52,  3.29s/it]Extracting train features for class bagel:   4%|▍         | 10/244 [00:31<12:24,  3.18s/it]Extracting train features for class bagel:   5%|▍         | 11/244 [00:33<11:06,  2.86s/it]Extracting train features for class bagel:   5%|▍         | 12/244 [00:36<11:11,  2.90s/it]Extracting train features for class bagel:   5%|▌         | 13/244 [00:40<11:51,  3.08s/it]Extracting train features for class bagel:   6%|▌         | 14/244 [00:43<12:41,  3.31s/it]Extracting train features for class bagel:   6%|▌         | 15/244 [00:47<13:20,  3.50s/it]Extracting train features for class bagel:   7%|▋         | 16/244 [00:51<13:35,  3.58s/it]Extracting train features for class bagel:   7%|▋         | 17/244 [00:54<13:20,  3.53s/it]Extracting train features for class bagel:   7%|▋         | 18/244 [00:58<13:17,  3.53s/it]Extracting train features for class bagel:   8%|▊         | 19/244 [01:01<13:07,  3.50s/it]Extracting train features for class bagel:   8%|▊         | 20/244 [01:04<12:26,  3.33s/it]Extracting train features for class bagel:   9%|▊         | 21/244 [01:06<10:57,  2.95s/it]Extracting train features for class bagel:   9%|▉         | 22/244 [01:10<11:15,  3.04s/it]Extracting train features for class bagel:   9%|▉         | 23/244 [01:13<11:56,  3.24s/it]Extracting train features for class bagel:  10%|▉         | 24/244 [01:17<12:31,  3.42s/it]Extracting train features for class bagel:  10%|█         | 25/244 [01:21<12:30,  3.43s/it]Extracting train features for class bagel:  11%|█         | 26/244 [01:24<12:41,  3.49s/it]Extracting train features for class bagel:  11%|█         | 27/244 [01:28<12:54,  3.57s/it]Extracting train features for class bagel:  11%|█▏        | 28/244 [01:32<13:00,  3.61s/it]Extracting train features for class bagel:  12%|█▏        | 29/244 [01:35<12:44,  3.56s/it]Extracting train features for class bagel:  12%|█▏        | 30/244 [01:39<12:54,  3.62s/it]Extracting train features for class bagel:  13%|█▎        | 31/244 [01:43<13:07,  3.70s/it]Extracting train features for class bagel:  13%|█▎        | 32/244 [01:47<13:01,  3.69s/it]Extracting train features for class bagel:  14%|█▎        | 33/244 [01:50<12:47,  3.64s/it]Extracting train features for class bagel:  14%|█▍        | 34/244 [01:54<12:59,  3.71s/it]Extracting train features for class bagel:  14%|█▍        | 35/244 [01:58<13:12,  3.79s/it]Extracting train features for class bagel:  15%|█▍        | 36/244 [02:02<13:19,  3.85s/it]Extracting train features for class bagel:  15%|█▌        | 37/244 [02:06<13:08,  3.81s/it]Extracting train features for class bagel:  16%|█▌        | 38/244 [02:09<12:41,  3.70s/it]Extracting train features for class bagel:  16%|█▌        | 39/244 [02:13<12:30,  3.66s/it]Extracting train features for class bagel:  16%|█▋        | 40/244 [02:16<12:30,  3.68s/it]Extracting train features for class bagel:  17%|█▋        | 41/244 [02:20<12:11,  3.60s/it]Extracting train features for class bagel:  17%|█▋        | 42/244 [02:23<12:12,  3.63s/it]Extracting train features for class bagel:  18%|█▊        | 43/244 [02:27<12:20,  3.68s/it]Extracting train features for class bagel:  18%|█▊        | 44/244 [02:31<12:04,  3.62s/it]Extracting train features for class bagel:  18%|█▊        | 45/244 [02:34<12:02,  3.63s/it]Extracting train features for class bagel:  19%|█▉        | 46/244 [02:38<12:11,  3.70s/it]Extracting train features for class bagel:  19%|█▉        | 47/244 [02:42<12:24,  3.78s/it]Extracting train features for class bagel:  20%|█▉        | 48/244 [02:46<12:11,  3.73s/it]Extracting train features for class bagel:  20%|██        | 49/244 [02:49<11:30,  3.54s/it]Extracting train features for class bagel:  20%|██        | 50/244 [02:51<10:04,  3.12s/it]Extracting train features for class bagel:  21%|██        | 51/244 [02:54<09:42,  3.02s/it]Extracting train features for class bagel:  21%|██▏       | 52/244 [02:57<09:41,  3.03s/it]Extracting train features for class bagel:  22%|██▏       | 53/244 [03:00<09:49,  3.09s/it]Extracting train features for class bagel:  22%|██▏       | 54/244 [03:03<10:00,  3.16s/it]Extracting train features for class bagel:  23%|██▎       | 55/244 [03:07<09:55,  3.15s/it]Extracting train features for class bagel:  23%|██▎       | 56/244 [03:09<09:15,  2.95s/it]Extracting train features for class bagel:  23%|██▎       | 57/244 [03:11<08:32,  2.74s/it]Extracting train features for class bagel:  24%|██▍       | 58/244 [03:14<08:33,  2.76s/it]Extracting train features for class bagel:  24%|██▍       | 59/244 [03:17<08:55,  2.89s/it]Extracting train features for class bagel:  25%|██▍       | 60/244 [03:20<09:04,  2.96s/it]Extracting train features for class bagel:  25%|██▌       | 61/244 [03:23<08:49,  2.89s/it]Extracting train features for class bagel:  25%|██▌       | 62/244 [03:25<08:00,  2.64s/it]Extracting train features for class bagel:  26%|██▌       | 63/244 [03:28<07:57,  2.64s/it]Extracting train features for class bagel:  26%|██▌       | 64/244 [03:31<08:18,  2.77s/it]Extracting train features for class bagel:  27%|██▋       | 65/244 [03:34<08:50,  2.96s/it]Extracting train features for class bagel:  27%|██▋       | 66/244 [03:38<09:06,  3.07s/it]Extracting train features for class bagel:  27%|██▋       | 67/244 [03:41<09:14,  3.13s/it]Extracting train features for class bagel:  28%|██▊       | 68/244 [03:44<09:06,  3.10s/it]Extracting train features for class bagel:  28%|██▊       | 69/244 [03:46<08:05,  2.77s/it]Extracting train features for class bagel:  29%|██▊       | 70/244 [03:49<08:01,  2.77s/it]Extracting train features for class bagel:  29%|██▉       | 71/244 [03:52<08:20,  2.89s/it]Extracting train features for class bagel:  30%|██▉       | 72/244 [03:55<08:32,  2.98s/it]Extracting train features for class bagel:  30%|██▉       | 73/244 [03:58<08:28,  2.97s/it]Extracting train features for class bagel:  30%|███       | 74/244 [04:00<07:55,  2.79s/it]Extracting train features for class bagel:  31%|███       | 75/244 [04:03<07:35,  2.70s/it]Extracting train features for class bagel:  31%|███       | 76/244 [04:06<07:56,  2.83s/it]Extracting train features for class bagel:  32%|███▏      | 77/244 [04:09<08:06,  2.91s/it]Extracting train features for class bagel:  32%|███▏      | 78/244 [04:12<07:54,  2.86s/it]Extracting train features for class bagel:  32%|███▏      | 79/244 [04:14<07:15,  2.64s/it]Extracting train features for class bagel:  33%|███▎      | 80/244 [04:17<07:20,  2.69s/it]Extracting train features for class bagel:  33%|███▎      | 81/244 [04:20<07:41,  2.83s/it]Extracting train features for class bagel:  34%|███▎      | 82/244 [04:23<08:03,  2.99s/it]Extracting train features for class bagel:  34%|███▍      | 83/244 [04:27<08:24,  3.13s/it]Extracting train features for class bagel:  34%|███▍      | 84/244 [04:30<08:36,  3.23s/it]Extracting train features for class bagel:  35%|███▍      | 85/244 [04:33<08:16,  3.13s/it]Extracting train features for class bagel:  35%|███▌      | 86/244 [04:35<07:23,  2.81s/it]Extracting train features for class bagel:  36%|███▌      | 87/244 [04:38<07:28,  2.86s/it]Extracting train features for class bagel:  36%|███▌      | 88/244 [04:42<07:54,  3.04s/it]Extracting train features for class bagel:  36%|███▋      | 89/244 [04:45<08:03,  3.12s/it]Extracting train features for class bagel:  37%|███▋      | 90/244 [04:49<08:22,  3.26s/it]Extracting train features for class bagel:  37%|███▋      | 91/244 [04:52<08:39,  3.39s/it]Extracting train features for class bagel:  38%|███▊      | 92/244 [04:56<08:33,  3.38s/it]Extracting train features for class bagel:  38%|███▊      | 93/244 [04:58<07:56,  3.15s/it]Extracting train features for class bagel:  39%|███▊      | 94/244 [05:00<07:05,  2.84s/it]Extracting train features for class bagel:  39%|███▉      | 95/244 [05:03<07:10,  2.89s/it]Extracting train features for class bagel:  39%|███▉      | 96/244 [05:07<07:22,  2.99s/it]Extracting train features for class bagel:  40%|███▉      | 97/244 [05:10<07:29,  3.06s/it]Extracting train features for class bagel:  40%|████      | 98/244 [05:13<07:27,  3.06s/it]Extracting train features for class bagel:  41%|████      | 99/244 [05:15<07:00,  2.90s/it]Extracting train features for class bagel:  41%|████      | 100/244 [05:18<06:27,  2.69s/it]Extracting train features for class bagel:  41%|████▏     | 101/244 [05:21<06:41,  2.81s/it]Extracting train features for class bagel:  42%|████▏     | 102/244 [05:24<06:58,  2.95s/it]Extracting train features for class bagel:  42%|████▏     | 103/244 [05:26<06:38,  2.83s/it]Extracting train features for class bagel:  43%|████▎     | 104/244 [05:29<06:19,  2.71s/it]Extracting train features for class bagel:  43%|████▎     | 105/244 [05:32<06:18,  2.72s/it]Extracting train features for class bagel:  43%|████▎     | 106/244 [05:35<06:22,  2.77s/it]Extracting train features for class bagel:  44%|████▍     | 107/244 [05:37<05:59,  2.62s/it]Extracting train features for class bagel:  44%|████▍     | 108/244 [05:39<05:49,  2.57s/it]Extracting train features for class bagel:  45%|████▍     | 109/244 [05:42<05:41,  2.53s/it]Extracting train features for class bagel:  45%|████▌     | 110/244 [05:44<05:42,  2.55s/it]Extracting train features for class bagel:  45%|████▌     | 111/244 [05:47<05:46,  2.60s/it]Extracting train features for class bagel:  46%|████▌     | 112/244 [05:50<05:51,  2.66s/it]Extracting train features for class bagel:  46%|████▋     | 113/244 [05:53<06:14,  2.86s/it]Extracting train features for class bagel:  47%|████▋     | 114/244 [05:57<06:44,  3.11s/it]Extracting train features for class bagel:  47%|████▋     | 115/244 [06:00<06:58,  3.25s/it]Extracting train features for class bagel:  48%|████▊     | 116/244 [06:04<07:07,  3.34s/it]Extracting train features for class bagel:  48%|████▊     | 117/244 [06:08<07:16,  3.44s/it]Extracting train features for class bagel:  48%|████▊     | 118/244 [06:11<07:16,  3.47s/it]Extracting train features for class bagel:  49%|████▉     | 119/244 [06:15<07:13,  3.47s/it]Extracting train features for class bagel:  49%|████▉     | 120/244 [06:18<07:11,  3.48s/it]Extracting train features for class bagel:  50%|████▉     | 121/244 [06:22<07:04,  3.45s/it]Extracting train features for class bagel:  50%|█████     | 122/244 [06:25<07:02,  3.46s/it]Extracting train features for class bagel:  50%|█████     | 123/244 [06:28<06:58,  3.45s/it]Extracting train features for class bagel:  51%|█████     | 124/244 [06:32<07:01,  3.52s/it]Extracting train features for class bagel:  51%|█████     | 125/244 [06:36<06:57,  3.51s/it]Extracting train features for class bagel:  52%|█████▏    | 126/244 [06:39<07:00,  3.57s/it]Extracting train features for class bagel:  52%|█████▏    | 127/244 [06:43<06:56,  3.56s/it]Extracting train features for class bagel:  52%|█████▏    | 128/244 [06:46<06:47,  3.51s/it]Extracting train features for class bagel:  53%|█████▎    | 129/244 [06:50<06:41,  3.49s/it]Extracting train features for class bagel:  53%|█████▎    | 130/244 [06:53<06:39,  3.50s/it]Extracting train features for class bagel:  54%|█████▎    | 131/244 [06:57<06:43,  3.57s/it]Extracting train features for class bagel:  54%|█████▍    | 132/244 [07:01<06:44,  3.61s/it]Extracting train features for class bagel:  55%|█████▍    | 133/244 [07:04<06:33,  3.54s/it]Extracting train features for class bagel:  55%|█████▍    | 134/244 [07:08<06:29,  3.54s/it]Extracting train features for class bagel:  55%|█████▌    | 135/244 [07:11<06:22,  3.51s/it]Extracting train features for class bagel:  56%|█████▌    | 136/244 [07:15<06:20,  3.52s/it]Extracting train features for class bagel:  56%|█████▌    | 137/244 [07:18<06:11,  3.47s/it]Extracting train features for class bagel:  57%|█████▋    | 138/244 [07:21<06:11,  3.51s/it]Extracting train features for class bagel:  57%|█████▋    | 139/244 [07:25<06:14,  3.57s/it]Extracting train features for class bagel:  57%|█████▋    | 140/244 [07:29<06:10,  3.57s/it]Extracting train features for class bagel:  58%|█████▊    | 141/244 [07:33<06:12,  3.61s/it]Extracting train features for class bagel:  58%|█████▊    | 142/244 [07:36<06:07,  3.61s/it]Extracting train features for class bagel:  59%|█████▊    | 143/244 [07:40<06:01,  3.58s/it]Extracting train features for class bagel:  59%|█████▉    | 144/244 [07:43<05:53,  3.53s/it]Extracting train features for class bagel:  59%|█████▉    | 145/244 [07:46<05:38,  3.41s/it]Extracting train features for class bagel:  60%|█████▉    | 146/244 [07:49<05:28,  3.35s/it]Extracting train features for class bagel:  60%|██████    | 147/244 [07:52<05:09,  3.19s/it]Extracting train features for class bagel:  61%|██████    | 148/244 [07:55<04:47,  3.00s/it]Extracting train features for class bagel:  61%|██████    | 149/244 [07:57<04:35,  2.90s/it]Extracting train features for class bagel:  61%|██████▏   | 150/244 [08:01<04:39,  2.97s/it]Extracting train features for class bagel:  62%|██████▏   | 151/244 [08:03<04:29,  2.90s/it]Extracting train features for class bagel:  62%|██████▏   | 152/244 [08:06<04:23,  2.87s/it]Extracting train features for class bagel:  63%|██████▎   | 153/244 [08:09<04:29,  2.96s/it]Extracting train features for class bagel:  63%|██████▎   | 154/244 [08:12<04:22,  2.92s/it]Extracting train features for class bagel:  64%|██████▎   | 155/244 [08:15<04:20,  2.93s/it]Extracting train features for class bagel:  64%|██████▍   | 156/244 [08:18<04:24,  3.00s/it]Extracting train features for class bagel:  64%|██████▍   | 157/244 [08:21<04:17,  2.96s/it]Extracting train features for class bagel:  65%|██████▍   | 158/244 [08:24<04:19,  3.02s/it]Extracting train features for class bagel:  65%|██████▌   | 159/244 [08:27<04:08,  2.93s/it]Extracting train features for class bagel:  66%|██████▌   | 160/244 [08:29<03:44,  2.67s/it]Extracting train features for class bagel:  66%|██████▌   | 161/244 [08:32<03:39,  2.64s/it]Extracting train features for class bagel:  66%|██████▋   | 162/244 [08:34<03:41,  2.70s/it]Extracting train features for class bagel:  67%|██████▋   | 163/244 [08:37<03:29,  2.58s/it]Extracting train features for class bagel:  67%|██████▋   | 164/244 [08:39<03:14,  2.43s/it]Extracting train features for class bagel:  68%|██████▊   | 165/244 [08:42<03:21,  2.55s/it]Extracting train features for class bagel:  68%|██████▊   | 166/244 [08:45<03:26,  2.65s/it]Extracting train features for class bagel:  68%|██████▊   | 167/244 [08:47<03:18,  2.58s/it]Extracting train features for class bagel:  69%|██████▉   | 168/244 [08:49<03:12,  2.54s/it]Extracting train features for class bagel:  69%|██████▉   | 169/244 [08:52<03:15,  2.60s/it]Extracting train features for class bagel:  70%|██████▉   | 170/244 [08:55<03:23,  2.75s/it]Extracting train features for class bagel:  70%|███████   | 171/244 [08:58<03:16,  2.70s/it]Extracting train features for class bagel:  70%|███████   | 172/244 [09:01<03:15,  2.71s/it]Extracting train features for class bagel:  71%|███████   | 173/244 [09:04<03:22,  2.85s/it]Extracting train features for class bagel:  71%|███████▏  | 174/244 [09:07<03:22,  2.90s/it]Extracting train features for class bagel:  72%|███████▏  | 175/244 [09:10<03:26,  2.99s/it]Extracting train features for class bagel:  72%|███████▏  | 176/244 [09:13<03:23,  2.99s/it]Extracting train features for class bagel:  73%|███████▎  | 177/244 [09:16<03:20,  3.00s/it]Extracting train features for class bagel:  73%|███████▎  | 178/244 [09:19<03:21,  3.05s/it]Extracting train features for class bagel:  73%|███████▎  | 179/244 [09:22<03:14,  3.00s/it]Extracting train features for class bagel:  74%|███████▍  | 180/244 [09:25<03:12,  3.01s/it]Extracting train features for class bagel:  74%|███████▍  | 181/244 [09:28<03:05,  2.95s/it]Extracting train features for class bagel:  75%|███████▍  | 182/244 [09:30<02:52,  2.79s/it]Extracting train features for class bagel:  75%|███████▌  | 183/244 [09:33<02:46,  2.73s/it]Extracting train features for class bagel:  75%|███████▌  | 184/244 [09:36<02:48,  2.80s/it]Extracting train features for class bagel:  76%|███████▌  | 185/244 [09:38<02:42,  2.76s/it]Extracting train features for class bagel:  76%|███████▌  | 186/244 [09:41<02:41,  2.78s/it]Extracting train features for class bagel:  77%|███████▋  | 187/244 [09:44<02:45,  2.91s/it]Extracting train features for class bagel:  77%|███████▋  | 188/244 [09:48<02:46,  2.96s/it]Extracting train features for class bagel:  77%|███████▋  | 189/244 [09:51<02:47,  3.05s/it]Extracting train features for class bagel:  78%|███████▊  | 190/244 [09:54<02:42,  3.02s/it]Extracting train features for class bagel:  78%|███████▊  | 191/244 [09:57<02:37,  2.98s/it]Extracting train features for class bagel:  79%|███████▊  | 192/244 [10:00<02:39,  3.06s/it]Extracting train features for class bagel:  79%|███████▉  | 193/244 [10:03<02:33,  3.00s/it]Extracting train features for class bagel:  80%|███████▉  | 194/244 [10:06<02:29,  2.98s/it]Extracting train features for class bagel:  80%|███████▉  | 195/244 [10:09<02:25,  2.98s/it]Extracting train features for class bagel:  80%|████████  | 196/244 [10:11<02:16,  2.85s/it]Extracting train features for class bagel:  81%|████████  | 197/244 [10:14<02:12,  2.83s/it]Extracting train features for class bagel:  81%|████████  | 198/244 [10:17<02:13,  2.90s/it]Extracting train features for class bagel:  82%|████████▏ | 199/244 [10:20<02:09,  2.89s/it]Extracting train features for class bagel:  82%|████████▏ | 200/244 [10:23<02:08,  2.93s/it]Extracting train features for class bagel:  82%|████████▏ | 201/244 [10:26<02:08,  2.98s/it]Extracting train features for class bagel:  83%|████████▎ | 202/244 [10:29<02:07,  3.03s/it]Extracting train features for class bagel:  83%|████████▎ | 203/244 [10:33<02:08,  3.12s/it]Extracting train features for class bagel:  84%|████████▎ | 204/244 [10:36<02:09,  3.23s/it]Extracting train features for class bagel:  84%|████████▍ | 205/244 [10:39<02:07,  3.26s/it]Extracting train features for class bagel:  84%|████████▍ | 206/244 [10:43<02:07,  3.36s/it]Extracting train features for class bagel:  85%|████████▍ | 207/244 [10:46<02:03,  3.33s/it]Extracting train features for class bagel:  85%|████████▌ | 208/244 [10:49<01:59,  3.31s/it]Extracting train features for class bagel:  86%|████████▌ | 209/244 [10:53<01:53,  3.23s/it]Extracting train features for class bagel:  86%|████████▌ | 210/244 [10:56<01:50,  3.24s/it]Extracting train features for class bagel:  86%|████████▋ | 211/244 [10:59<01:48,  3.27s/it]Extracting train features for class bagel:  87%|████████▋ | 212/244 [11:03<01:46,  3.32s/it]Extracting train features for class bagel:  87%|████████▋ | 213/244 [11:05<01:32,  3.00s/it]Extracting train features for class bagel:  88%|████████▊ | 214/244 [11:07<01:21,  2.73s/it]Extracting train features for class bagel:  88%|████████▊ | 215/244 [11:10<01:18,  2.70s/it]Extracting train features for class bagel:  89%|████████▊ | 216/244 [11:12<01:13,  2.64s/it]Extracting train features for class bagel:  89%|████████▉ | 217/244 [11:14<01:07,  2.49s/it]Extracting train features for class bagel:  89%|████████▉ | 218/244 [11:17<01:06,  2.54s/it]Extracting train features for class bagel:  90%|████████▉ | 219/244 [11:20<01:06,  2.67s/it]Extracting train features for class bagel:  90%|█████████ | 220/244 [11:22<01:03,  2.66s/it]Extracting train features for class bagel:  91%|█████████ | 221/244 [11:26<01:04,  2.81s/it]Extracting train features for class bagel:  91%|█████████ | 222/244 [11:28<01:00,  2.75s/it]Extracting train features for class bagel:  91%|█████████▏| 223/244 [11:31<01:00,  2.88s/it]Extracting train features for class bagel:  92%|█████████▏| 224/244 [11:34<00:57,  2.85s/it]Extracting train features for class bagel:  92%|█████████▏| 225/244 [11:37<00:54,  2.87s/it]Extracting train features for class bagel:  93%|█████████▎| 226/244 [11:40<00:52,  2.90s/it]Extracting train features for class bagel:  93%|█████████▎| 227/244 [11:42<00:46,  2.73s/it]Extracting train features for class bagel:  93%|█████████▎| 228/244 [11:46<00:45,  2.85s/it]Extracting train features for class bagel:  94%|█████████▍| 229/244 [11:48<00:42,  2.86s/it]Extracting train features for class bagel:  94%|█████████▍| 230/244 [11:51<00:38,  2.72s/it]Extracting train features for class bagel:  95%|█████████▍| 231/244 [11:54<00:36,  2.80s/it]Extracting train features for class bagel:  95%|█████████▌| 232/244 [11:57<00:34,  2.91s/it]Extracting train features for class bagel:  95%|█████████▌| 233/244 [12:00<00:31,  2.85s/it]Extracting train features for class bagel:  96%|█████████▌| 234/244 [12:02<00:27,  2.71s/it]Extracting train features for class bagel:  96%|█████████▋| 235/244 [12:04<00:22,  2.54s/it]Extracting train features for class bagel:  97%|█████████▋| 236/244 [12:06<00:19,  2.40s/it]Extracting train features for class bagel:  97%|█████████▋| 237/244 [12:08<00:16,  2.29s/it]Extracting train features for class bagel:  98%|█████████▊| 238/244 [12:11<00:14,  2.37s/it]Extracting train features for class bagel:  98%|█████████▊| 239/244 [12:14<00:13,  2.62s/it]Extracting train features for class bagel:  98%|█████████▊| 240/244 [12:17<00:11,  2.77s/it]Extracting train features for class bagel:  99%|█████████▉| 241/244 [12:20<00:08,  2.67s/it]Extracting train features for class bagel:  99%|█████████▉| 242/244 [12:22<00:05,  2.56s/it]Extracting train features for class bagel: 100%|█████████▉| 243/244 [12:24<00:02,  2.43s/it]Extracting train features for class bagel: 100%|██████████| 244/244 [12:26<00:00,  2.32s/it]Extracting train features for class bagel: 100%|██████████| 244/244 [12:26<00:00,  3.06s/it]


Running coreset for Fusion on class bagel...
Traceback (most recent call last):
  File "main.py", line 99, in <module>
    run_3d_ads(args)
  File "main.py", line 31, in run_3d_ads
    model.fit(cls)
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/m3dm_runner.py", line 60, in fit
    method.run_coreset()
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/feature_extractors/features_dino_fusion.py", line 174, in run_coreset
    self.coreset_idx = get_coreset_idx_randomp(self.patch_lib,
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/utils/utils.py", line 48, in get_coreset_idx_randomp
    z_lib = torch.tensor(transformer.fit_transform(z_lib))
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/random_projection.py", line 359, in fit
    X = self._validate_data(
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
  File "/usr/local/python38/lib/python3.8/site-packages/torch/_tensor.py", line 645, in __array__
    return self.numpy().astype(dtype, copy=False)
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
/usr/local/python38/lib/python3.8/site-packages/torch/utils/cpp_extension.py:284: UserWarning: 

                               !! WARNING !!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Your compiler (c++) is not compatible with the compiler Pytorch was
built with for this platform, which is g++ on linux. Please
use g++ to to compile your extension. Alternatively, you may
compile PyTorch from source using c++, and then you can also use
c++ to compile your extension.

See https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md for help
with compiling PyTorch from source.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

                              !! WARNING !!

  warnings.warn(WRONG_COMPILER_WARNING.format(
unexpected_keys
['mask_token', 'decoder_pos_embed.0.weight', 'decoder_pos_embed.0.bias', 'decoder_pos_embed.2.weight', 'decoder_pos_embed.2.bias', 'MAE_decoder.blocks.0.norm1.weight', 'MAE_decoder.blocks.0.norm1.bias', 'MAE_decoder.blocks.0.norm2.weight', 'MAE_decoder.blocks.0.norm2.bias', 'MAE_decoder.blocks.0.mlp.fc1.weight', 'MAE_decoder.blocks.0.mlp.fc1.bias', 'MAE_decoder.blocks.0.mlp.fc2.weight', 'MAE_decoder.blocks.0.mlp.fc2.bias', 'MAE_decoder.blocks.0.attn.qkv.weight', 'MAE_decoder.blocks.0.attn.proj.weight', 'MAE_decoder.blocks.0.attn.proj.bias', 'MAE_decoder.blocks.1.norm1.weight', 'MAE_decoder.blocks.1.norm1.bias', 'MAE_decoder.blocks.1.norm2.weight', 'MAE_decoder.blocks.1.norm2.bias', 'MAE_decoder.blocks.1.mlp.fc1.weight', 'MAE_decoder.blocks.1.mlp.fc1.bias', 'MAE_decoder.blocks.1.mlp.fc2.weight', 'MAE_decoder.blocks.1.mlp.fc2.bias', 'MAE_decoder.blocks.1.attn.qkv.weight', 'MAE_decoder.blocks.1.attn.proj.weight', 'MAE_decoder.blocks.1.attn.proj.bias', 'MAE_decoder.blocks.2.norm1.weight', 'MAE_decoder.blocks.2.norm1.bias', 'MAE_decoder.blocks.2.norm2.weight', 'MAE_decoder.blocks.2.norm2.bias', 'MAE_decoder.blocks.2.mlp.fc1.weight', 'MAE_decoder.blocks.2.mlp.fc1.bias', 'MAE_decoder.blocks.2.mlp.fc2.weight', 'MAE_decoder.blocks.2.mlp.fc2.bias', 'MAE_decoder.blocks.2.attn.qkv.weight', 'MAE_decoder.blocks.2.attn.proj.weight', 'MAE_decoder.blocks.2.attn.proj.bias', 'MAE_decoder.blocks.3.norm1.weight', 'MAE_decoder.blocks.3.norm1.bias', 'MAE_decoder.blocks.3.norm2.weight', 'MAE_decoder.blocks.3.norm2.bias', 'MAE_decoder.blocks.3.mlp.fc1.weight', 'MAE_decoder.blocks.3.mlp.fc1.bias', 'MAE_decoder.blocks.3.mlp.fc2.weight', 'MAE_decoder.blocks.3.mlp.fc2.bias', 'MAE_decoder.blocks.3.attn.qkv.weight', 'MAE_decoder.blocks.3.attn.proj.weight', 'MAE_decoder.blocks.3.attn.proj.bias', 'MAE_decoder.norm.weight', 'MAE_decoder.norm.bias', 'increase_dim.0.weight', 'increase_dim.0.bias']
[Transformer] Successful Loading the ckpt from checkpoints/pointmae_pretrain.pth
point: <All keys matched successfully>
7fusion_block: <All keys matched successfully>
Extracting train features for class cable_gland:   0%|          | 0/223 [00:00<?, ?it/s]Extracting train features for class cable_gland:   0%|          | 1/223 [00:01<06:55,  1.87s/it]Extracting train features for class cable_gland:   1%|          | 2/223 [00:03<06:31,  1.77s/it]Extracting train features for class cable_gland:   1%|▏         | 3/223 [00:05<07:10,  1.96s/it]Extracting train features for class cable_gland:   2%|▏         | 4/223 [00:08<07:48,  2.14s/it]Extracting train features for class cable_gland:   2%|▏         | 5/223 [00:10<07:59,  2.20s/it]Extracting train features for class cable_gland:   3%|▎         | 6/223 [00:12<07:54,  2.19s/it]Extracting train features for class cable_gland:   3%|▎         | 7/223 [00:14<07:44,  2.15s/it]Extracting train features for class cable_gland:   4%|▎         | 8/223 [00:16<07:48,  2.18s/it]Extracting train features for class cable_gland:   4%|▍         | 9/223 [00:18<07:30,  2.10s/it]Extracting train features for class cable_gland:   4%|▍         | 10/223 [00:20<07:16,  2.05s/it]Extracting train features for class cable_gland:   5%|▍         | 11/223 [00:22<06:59,  1.98s/it]Extracting train features for class cable_gland:   5%|▌         | 12/223 [00:24<06:34,  1.87s/it]Extracting train features for class cable_gland:   6%|▌         | 13/223 [00:25<06:19,  1.81s/it]Extracting train features for class cable_gland:   6%|▋         | 14/223 [00:27<06:26,  1.85s/it]Extracting train features for class cable_gland:   7%|▋         | 15/223 [00:29<06:34,  1.90s/it]Extracting train features for class cable_gland:   7%|▋         | 16/223 [00:32<06:48,  1.98s/it]Extracting train features for class cable_gland:   8%|▊         | 17/223 [00:34<06:58,  2.03s/it]Extracting train features for class cable_gland:   8%|▊         | 18/223 [00:36<06:50,  2.00s/it]Extracting train features for class cable_gland:   9%|▊         | 19/223 [00:38<06:51,  2.02s/it]Extracting train features for class cable_gland:   9%|▉         | 20/223 [00:40<06:50,  2.02s/it]Extracting train features for class cable_gland:   9%|▉         | 21/223 [00:41<06:19,  1.88s/it]Extracting train features for class cable_gland:  10%|▉         | 22/223 [00:43<06:00,  1.79s/it]Extracting train features for class cable_gland:  10%|█         | 23/223 [00:45<06:09,  1.85s/it]Extracting train features for class cable_gland:  11%|█         | 24/223 [00:47<06:35,  1.99s/it]Extracting train features for class cable_gland:  11%|█         | 25/223 [00:49<06:46,  2.05s/it]Extracting train features for class cable_gland:  12%|█▏        | 26/223 [00:51<06:45,  2.06s/it]Extracting train features for class cable_gland:  12%|█▏        | 27/223 [00:54<07:03,  2.16s/it]Extracting train features for class cable_gland:  13%|█▎        | 28/223 [00:56<07:25,  2.28s/it]Extracting train features for class cable_gland:  13%|█▎        | 29/223 [00:59<07:33,  2.34s/it]Extracting train features for class cable_gland:  13%|█▎        | 30/223 [01:01<07:34,  2.35s/it]Extracting train features for class cable_gland:  14%|█▍        | 31/223 [01:03<07:18,  2.29s/it]Extracting train features for class cable_gland:  14%|█▍        | 32/223 [01:05<06:42,  2.11s/it]Extracting train features for class cable_gland:  15%|█▍        | 33/223 [01:07<06:15,  1.98s/it]Extracting train features for class cable_gland:  15%|█▌        | 34/223 [01:08<05:55,  1.88s/it]Extracting train features for class cable_gland:  16%|█▌        | 35/223 [01:10<05:43,  1.83s/it]Extracting train features for class cable_gland:  16%|█▌        | 36/223 [01:12<05:31,  1.77s/it]Extracting train features for class cable_gland:  17%|█▋        | 37/223 [01:13<05:19,  1.72s/it]Extracting train features for class cable_gland:  17%|█▋        | 38/223 [01:15<05:12,  1.69s/it]Extracting train features for class cable_gland:  17%|█▋        | 39/223 [01:17<05:08,  1.68s/it]Extracting train features for class cable_gland:  18%|█▊        | 40/223 [01:18<05:10,  1.70s/it]Extracting train features for class cable_gland:  18%|█▊        | 41/223 [01:20<05:20,  1.76s/it]Extracting train features for class cable_gland:  19%|█▉        | 42/223 [01:22<05:16,  1.75s/it]Extracting train features for class cable_gland:  19%|█▉        | 43/223 [01:24<05:16,  1.76s/it]Extracting train features for class cable_gland:  20%|█▉        | 44/223 [01:26<05:24,  1.81s/it]Extracting train features for class cable_gland:  20%|██        | 45/223 [01:28<05:25,  1.83s/it]Extracting train features for class cable_gland:  21%|██        | 46/223 [01:29<05:23,  1.83s/it]Extracting train features for class cable_gland:  21%|██        | 47/223 [01:31<05:30,  1.88s/it]Extracting train features for class cable_gland:  22%|██▏       | 48/223 [01:33<05:31,  1.89s/it]Extracting train features for class cable_gland:  22%|██▏       | 49/223 [01:35<05:28,  1.89s/it]Extracting train features for class cable_gland:  22%|██▏       | 50/223 [01:37<05:32,  1.92s/it]Extracting train features for class cable_gland:  23%|██▎       | 51/223 [01:39<05:27,  1.90s/it]Extracting train features for class cable_gland:  23%|██▎       | 52/223 [01:41<05:30,  1.93s/it]Extracting train features for class cable_gland:  24%|██▍       | 53/223 [01:43<05:34,  1.97s/it]Extracting train features for class cable_gland:  24%|██▍       | 54/223 [01:45<05:29,  1.95s/it]Extracting train features for class cable_gland:  25%|██▍       | 55/223 [01:47<05:31,  1.97s/it]Extracting train features for class cable_gland:  25%|██▌       | 56/223 [01:49<05:36,  2.01s/it]Extracting train features for class cable_gland:  26%|██▌       | 57/223 [01:51<05:38,  2.04s/it]Extracting train features for class cable_gland:  26%|██▌       | 58/223 [01:53<05:34,  2.03s/it]Extracting train features for class cable_gland:  26%|██▋       | 59/223 [01:55<05:33,  2.04s/it]Extracting train features for class cable_gland:  27%|██▋       | 60/223 [01:57<05:35,  2.06s/it]Extracting train features for class cable_gland:  27%|██▋       | 61/223 [01:59<05:33,  2.06s/it]Extracting train features for class cable_gland:  28%|██▊       | 62/223 [02:02<05:35,  2.08s/it]Extracting train features for class cable_gland:  28%|██▊       | 63/223 [02:04<05:29,  2.06s/it]Extracting train features for class cable_gland:  29%|██▊       | 64/223 [02:06<05:39,  2.13s/it]Extracting train features for class cable_gland:  29%|██▉       | 65/223 [02:08<05:31,  2.10s/it]Extracting train features for class cable_gland:  30%|██▉       | 66/223 [02:10<05:39,  2.16s/it]Extracting train features for class cable_gland:  30%|███       | 67/223 [02:12<05:34,  2.14s/it]Extracting train features for class cable_gland:  30%|███       | 68/223 [02:15<05:46,  2.24s/it]Extracting train features for class cable_gland:  31%|███       | 69/223 [02:17<05:41,  2.22s/it]Extracting train features for class cable_gland:  31%|███▏      | 70/223 [02:19<05:41,  2.23s/it]Extracting train features for class cable_gland:  32%|███▏      | 71/223 [02:22<05:43,  2.26s/it]Extracting train features for class cable_gland:  32%|███▏      | 72/223 [02:24<05:41,  2.26s/it]Extracting train features for class cable_gland:  33%|███▎      | 73/223 [02:26<05:39,  2.26s/it]Extracting train features for class cable_gland:  33%|███▎      | 74/223 [02:28<05:26,  2.19s/it]Extracting train features for class cable_gland:  34%|███▎      | 75/223 [02:30<05:28,  2.22s/it]Extracting train features for class cable_gland:  34%|███▍      | 76/223 [02:32<05:18,  2.17s/it]Extracting train features for class cable_gland:  35%|███▍      | 77/223 [02:35<05:19,  2.19s/it]Extracting train features for class cable_gland:  35%|███▍      | 78/223 [02:37<05:07,  2.12s/it]Extracting train features for class cable_gland:  35%|███▌      | 79/223 [02:39<05:11,  2.17s/it]Extracting train features for class cable_gland:  36%|███▌      | 80/223 [02:41<05:11,  2.18s/it]Extracting train features for class cable_gland:  36%|███▋      | 81/223 [02:43<05:15,  2.22s/it]Extracting train features for class cable_gland:  37%|███▋      | 82/223 [02:46<05:10,  2.20s/it]Extracting train features for class cable_gland:  37%|███▋      | 83/223 [02:48<05:13,  2.24s/it]Extracting train features for class cable_gland:  38%|███▊      | 84/223 [02:50<05:05,  2.19s/it]Extracting train features for class cable_gland:  38%|███▊      | 85/223 [02:52<05:10,  2.25s/it]Extracting train features for class cable_gland:  39%|███▊      | 86/223 [02:55<05:02,  2.21s/it]Extracting train features for class cable_gland:  39%|███▉      | 87/223 [02:57<05:09,  2.28s/it]Extracting train features for class cable_gland:  39%|███▉      | 88/223 [02:59<05:01,  2.24s/it]Extracting train features for class cable_gland:  40%|███▉      | 89/223 [03:01<05:04,  2.27s/it]Extracting train features for class cable_gland:  40%|████      | 90/223 [03:04<05:00,  2.26s/it]Extracting train features for class cable_gland:  41%|████      | 91/223 [03:06<04:58,  2.26s/it]Extracting train features for class cable_gland:  41%|████▏     | 92/223 [03:08<04:56,  2.27s/it]Extracting train features for class cable_gland:  42%|████▏     | 93/223 [03:10<04:51,  2.25s/it]Extracting train features for class cable_gland:  42%|████▏     | 94/223 [03:13<04:55,  2.29s/it]Extracting train features for class cable_gland:  43%|████▎     | 95/223 [03:15<04:44,  2.22s/it]Extracting train features for class cable_gland:  43%|████▎     | 96/223 [03:17<04:42,  2.22s/it]Extracting train features for class cable_gland:  43%|████▎     | 97/223 [03:19<04:31,  2.15s/it]Extracting train features for class cable_gland:  44%|████▍     | 98/223 [03:21<04:35,  2.20s/it]Extracting train features for class cable_gland:  44%|████▍     | 99/223 [03:24<04:30,  2.18s/it]Extracting train features for class cable_gland:  45%|████▍     | 100/223 [03:26<04:31,  2.21s/it]Extracting train features for class cable_gland:  45%|████▌     | 101/223 [03:28<04:30,  2.21s/it]Extracting train features for class cable_gland:  46%|████▌     | 102/223 [03:30<04:30,  2.23s/it]Extracting train features for class cable_gland:  46%|████▌     | 103/223 [03:32<04:25,  2.21s/it]Extracting train features for class cable_gland:  47%|████▋     | 104/223 [03:35<04:26,  2.24s/it]Extracting train features for class cable_gland:  47%|████▋     | 105/223 [03:37<04:28,  2.27s/it]Extracting train features for class cable_gland:  48%|████▊     | 106/223 [03:39<04:14,  2.18s/it]Extracting train features for class cable_gland:  48%|████▊     | 107/223 [03:41<04:15,  2.20s/it]Extracting train features for class cable_gland:  48%|████▊     | 108/223 [03:43<04:04,  2.12s/it]Extracting train features for class cable_gland:  49%|████▉     | 109/223 [03:46<04:06,  2.16s/it]Extracting train features for class cable_gland:  49%|████▉     | 110/223 [03:48<04:04,  2.16s/it]Extracting train features for class cable_gland:  50%|████▉     | 111/223 [03:50<04:04,  2.19s/it]Extracting train features for class cable_gland:  50%|█████     | 112/223 [03:52<04:05,  2.21s/it]Extracting train features for class cable_gland:  51%|█████     | 113/223 [03:54<03:56,  2.15s/it]Extracting train features for class cable_gland:  51%|█████     | 114/223 [03:56<03:57,  2.18s/it]Extracting train features for class cable_gland:  52%|█████▏    | 115/223 [03:59<03:52,  2.16s/it]Extracting train features for class cable_gland:  52%|█████▏    | 116/223 [04:01<03:54,  2.20s/it]Extracting train features for class cable_gland:  52%|█████▏    | 117/223 [04:03<03:51,  2.18s/it]Extracting train features for class cable_gland:  53%|█████▎    | 118/223 [04:05<03:53,  2.22s/it]Extracting train features for class cable_gland:  53%|█████▎    | 119/223 [04:07<03:48,  2.20s/it]Extracting train features for class cable_gland:  54%|█████▍    | 120/223 [04:10<03:51,  2.25s/it]Extracting train features for class cable_gland:  54%|█████▍    | 121/223 [04:12<03:49,  2.25s/it]Extracting train features for class cable_gland:  55%|█████▍    | 122/223 [04:14<03:48,  2.27s/it]Extracting train features for class cable_gland:  55%|█████▌    | 123/223 [04:17<03:45,  2.25s/it]Extracting train features for class cable_gland:  56%|█████▌    | 124/223 [04:19<03:43,  2.26s/it]Extracting train features for class cable_gland:  56%|█████▌    | 125/223 [04:21<03:37,  2.22s/it]Extracting train features for class cable_gland:  57%|█████▋    | 126/223 [04:23<03:34,  2.22s/it]Extracting train features for class cable_gland:  57%|█████▋    | 127/223 [04:25<03:24,  2.13s/it]Extracting train features for class cable_gland:  57%|█████▋    | 128/223 [04:27<03:24,  2.15s/it]Extracting train features for class cable_gland:  58%|█████▊    | 129/223 [04:30<03:24,  2.18s/it]Extracting train features for class cable_gland:  58%|█████▊    | 130/223 [04:32<03:22,  2.18s/it]Extracting train features for class cable_gland:  59%|█████▊    | 131/223 [04:34<03:21,  2.19s/it]Extracting train features for class cable_gland:  59%|█████▉    | 132/223 [04:36<03:13,  2.12s/it]Extracting train features for class cable_gland:  60%|█████▉    | 133/223 [04:38<03:12,  2.14s/it]Extracting train features for class cable_gland:  60%|██████    | 134/223 [04:40<03:07,  2.11s/it]Extracting train features for class cable_gland:  61%|██████    | 135/223 [04:42<03:07,  2.14s/it]Extracting train features for class cable_gland:  61%|██████    | 136/223 [04:44<03:05,  2.13s/it]Extracting train features for class cable_gland:  61%|██████▏   | 137/223 [04:47<03:07,  2.18s/it]Extracting train features for class cable_gland:  62%|██████▏   | 138/223 [04:49<03:03,  2.16s/it]Extracting train features for class cable_gland:  62%|██████▏   | 139/223 [04:51<03:05,  2.20s/it]Extracting train features for class cable_gland:  63%|██████▎   | 140/223 [04:53<02:58,  2.15s/it]Extracting train features for class cable_gland:  63%|██████▎   | 141/223 [04:56<03:00,  2.20s/it]Extracting train features for class cable_gland:  64%|██████▎   | 142/223 [04:58<02:55,  2.16s/it]Extracting train features for class cable_gland:  64%|██████▍   | 143/223 [05:00<02:54,  2.19s/it]Extracting train features for class cable_gland:  65%|██████▍   | 144/223 [05:02<02:49,  2.15s/it]Extracting train features for class cable_gland:  65%|██████▌   | 145/223 [05:04<02:51,  2.20s/it]Extracting train features for class cable_gland:  65%|██████▌   | 146/223 [05:06<02:42,  2.11s/it]Extracting train features for class cable_gland:  66%|██████▌   | 147/223 [05:08<02:40,  2.12s/it]Extracting train features for class cable_gland:  66%|██████▋   | 148/223 [05:10<02:40,  2.14s/it]Extracting train features for class cable_gland:  67%|██████▋   | 149/223 [05:13<02:41,  2.19s/it]Extracting train features for class cable_gland:  67%|██████▋   | 150/223 [05:15<02:39,  2.18s/it]Extracting train features for class cable_gland:  68%|██████▊   | 151/223 [05:17<02:39,  2.22s/it]Extracting train features for class cable_gland:  68%|██████▊   | 152/223 [05:19<02:36,  2.21s/it]Extracting train features for class cable_gland:  69%|██████▊   | 153/223 [05:22<02:35,  2.22s/it]Extracting train features for class cable_gland:  69%|██████▉   | 154/223 [05:24<02:30,  2.18s/it]Extracting train features for class cable_gland:  70%|██████▉   | 155/223 [05:26<02:30,  2.21s/it]Extracting train features for class cable_gland:  70%|██████▉   | 156/223 [05:28<02:24,  2.15s/it]Extracting train features for class cable_gland:  70%|███████   | 157/223 [05:30<02:23,  2.17s/it]Extracting train features for class cable_gland:  71%|███████   | 158/223 [05:33<02:22,  2.19s/it]Extracting train features for class cable_gland:  71%|███████▏  | 159/223 [05:35<02:20,  2.20s/it]Extracting train features for class cable_gland:  72%|███████▏  | 160/223 [05:37<02:20,  2.23s/it]Extracting train features for class cable_gland:  72%|███████▏  | 161/223 [05:39<02:13,  2.16s/it]Extracting train features for class cable_gland:  73%|███████▎  | 162/223 [05:41<02:14,  2.20s/it]Extracting train features for class cable_gland:  73%|███████▎  | 163/223 [05:44<02:12,  2.21s/it]Extracting train features for class cable_gland:  74%|███████▎  | 164/223 [05:46<02:13,  2.26s/it]Extracting train features for class cable_gland:  74%|███████▍  | 165/223 [05:48<02:09,  2.23s/it]Extracting train features for class cable_gland:  74%|███████▍  | 166/223 [05:50<02:08,  2.25s/it]Extracting train features for class cable_gland:  75%|███████▍  | 167/223 [05:53<02:06,  2.25s/it]Extracting train features for class cable_gland:  75%|███████▌  | 168/223 [05:55<02:04,  2.26s/it]Extracting train features for class cable_gland:  76%|███████▌  | 169/223 [05:57<02:03,  2.29s/it]Extracting train features for class cable_gland:  76%|███████▌  | 170/223 [05:59<01:59,  2.25s/it]Extracting train features for class cable_gland:  77%|███████▋  | 171/223 [06:02<01:57,  2.26s/it]Extracting train features for class cable_gland:  77%|███████▋  | 172/223 [06:04<01:52,  2.20s/it]Extracting train features for class cable_gland:  78%|███████▊  | 173/223 [06:06<01:51,  2.24s/it]Extracting train features for class cable_gland:  78%|███████▊  | 174/223 [06:08<01:51,  2.27s/it]Extracting train features for class cable_gland:  78%|███████▊  | 175/223 [06:11<01:47,  2.25s/it]Extracting train features for class cable_gland:  79%|███████▉  | 176/223 [06:13<01:45,  2.24s/it]Extracting train features for class cable_gland:  79%|███████▉  | 177/223 [06:15<01:39,  2.17s/it]Extracting train features for class cable_gland:  80%|███████▉  | 178/223 [06:17<01:39,  2.21s/it]Extracting train features for class cable_gland:  80%|████████  | 179/223 [06:19<01:35,  2.18s/it]Extracting train features for class cable_gland:  81%|████████  | 180/223 [06:21<01:33,  2.18s/it]Extracting train features for class cable_gland:  81%|████████  | 181/223 [06:24<01:29,  2.13s/it]Extracting train features for class cable_gland:  82%|████████▏ | 182/223 [06:26<01:29,  2.17s/it]Extracting train features for class cable_gland:  82%|████████▏ | 183/223 [06:28<01:26,  2.17s/it]Extracting train features for class cable_gland:  83%|████████▎ | 184/223 [06:30<01:20,  2.06s/it]Extracting train features for class cable_gland:  83%|████████▎ | 185/223 [06:31<01:12,  1.92s/it]Extracting train features for class cable_gland:  83%|████████▎ | 186/223 [06:33<01:07,  1.83s/it]Extracting train features for class cable_gland:  84%|████████▍ | 187/223 [06:35<01:04,  1.79s/it]Extracting train features for class cable_gland:  84%|████████▍ | 188/223 [06:36<01:03,  1.80s/it]Extracting train features for class cable_gland:  85%|████████▍ | 189/223 [06:38<01:00,  1.77s/it]Extracting train features for class cable_gland:  85%|████████▌ | 190/223 [06:40<00:57,  1.73s/it]Extracting train features for class cable_gland:  86%|████████▌ | 191/223 [06:42<00:56,  1.76s/it]Extracting train features for class cable_gland:  86%|████████▌ | 192/223 [06:44<00:56,  1.83s/it]Extracting train features for class cable_gland:  87%|████████▋ | 193/223 [06:45<00:52,  1.76s/it]Extracting train features for class cable_gland:  87%|████████▋ | 194/223 [06:47<00:49,  1.71s/it]Extracting train features for class cable_gland:  87%|████████▋ | 195/223 [06:48<00:47,  1.68s/it]Extracting train features for class cable_gland:  88%|████████▊ | 196/223 [06:50<00:47,  1.75s/it]Extracting train features for class cable_gland:  88%|████████▊ | 197/223 [06:52<00:47,  1.83s/it]Extracting train features for class cable_gland:  89%|████████▉ | 198/223 [06:54<00:44,  1.78s/it]Extracting train features for class cable_gland:  89%|████████▉ | 199/223 [06:56<00:41,  1.73s/it]Extracting train features for class cable_gland:  90%|████████▉ | 200/223 [06:57<00:40,  1.76s/it]Extracting train features for class cable_gland:  90%|█████████ | 201/223 [06:59<00:40,  1.83s/it]Extracting train features for class cable_gland:  91%|█████████ | 202/223 [07:01<00:36,  1.75s/it]Extracting train features for class cable_gland:  91%|█████████ | 203/223 [07:03<00:34,  1.73s/it]Extracting train features for class cable_gland:  91%|█████████▏| 204/223 [07:05<00:34,  1.82s/it]Extracting train features for class cable_gland:  92%|█████████▏| 205/223 [07:07<00:33,  1.85s/it]Extracting train features for class cable_gland:  92%|█████████▏| 206/223 [07:08<00:30,  1.81s/it]Extracting train features for class cable_gland:  93%|█████████▎| 207/223 [07:10<00:27,  1.74s/it]Extracting train features for class cable_gland:  93%|█████████▎| 208/223 [07:12<00:25,  1.69s/it]Extracting train features for class cable_gland:  94%|█████████▎| 209/223 [07:13<00:23,  1.66s/it]Extracting train features for class cable_gland:  94%|█████████▍| 210/223 [07:15<00:21,  1.65s/it]Extracting train features for class cable_gland:  95%|█████████▍| 211/223 [07:17<00:20,  1.73s/it]Extracting train features for class cable_gland:  95%|█████████▌| 212/223 [07:19<00:20,  1.83s/it]Extracting train features for class cable_gland:  96%|█████████▌| 213/223 [07:20<00:18,  1.81s/it]Extracting train features for class cable_gland:  96%|█████████▌| 214/223 [07:22<00:15,  1.75s/it]Extracting train features for class cable_gland:  96%|█████████▋| 215/223 [07:24<00:13,  1.68s/it]Extracting train features for class cable_gland:  97%|█████████▋| 216/223 [07:25<00:11,  1.65s/it]Extracting train features for class cable_gland:  97%|█████████▋| 217/223 [07:27<00:09,  1.63s/it]Extracting train features for class cable_gland:  98%|█████████▊| 218/223 [07:28<00:08,  1.62s/it]Extracting train features for class cable_gland:  98%|█████████▊| 219/223 [07:30<00:06,  1.61s/it]Extracting train features for class cable_gland:  99%|█████████▊| 220/223 [07:32<00:04,  1.59s/it]Extracting train features for class cable_gland:  99%|█████████▉| 221/223 [07:33<00:03,  1.59s/it]Extracting train features for class cable_gland: 100%|█████████▉| 222/223 [07:35<00:01,  1.65s/it]Extracting train features for class cable_gland: 100%|██████████| 223/223 [07:37<00:00,  1.79s/it]Extracting train features for class cable_gland: 100%|██████████| 223/223 [07:37<00:00,  2.05s/it]


Running coreset for Fusion on class cable_gland...
Traceback (most recent call last):
  File "main.py", line 99, in <module>
    run_3d_ads(args)
  File "main.py", line 31, in run_3d_ads
    model.fit(cls)
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/m3dm_runner.py", line 60, in fit
    method.run_coreset()
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/feature_extractors/features_dino_fusion.py", line 174, in run_coreset
    self.coreset_idx = get_coreset_idx_randomp(self.patch_lib,
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/utils/utils.py", line 48, in get_coreset_idx_randomp
    z_lib = torch.tensor(transformer.fit_transform(z_lib))
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/random_projection.py", line 359, in fit
    X = self._validate_data(
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
  File "/usr/local/python38/lib/python3.8/site-packages/torch/_tensor.py", line 645, in __array__
    return self.numpy().astype(dtype, copy=False)
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
/usr/local/python38/lib/python3.8/site-packages/torch/utils/cpp_extension.py:284: UserWarning: 

                               !! WARNING !!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Your compiler (c++) is not compatible with the compiler Pytorch was
built with for this platform, which is g++ on linux. Please
use g++ to to compile your extension. Alternatively, you may
compile PyTorch from source using c++, and then you can also use
c++ to compile your extension.

See https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md for help
with compiling PyTorch from source.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

                              !! WARNING !!

  warnings.warn(WRONG_COMPILER_WARNING.format(
unexpected_keys
['mask_token', 'decoder_pos_embed.0.weight', 'decoder_pos_embed.0.bias', 'decoder_pos_embed.2.weight', 'decoder_pos_embed.2.bias', 'MAE_decoder.blocks.0.norm1.weight', 'MAE_decoder.blocks.0.norm1.bias', 'MAE_decoder.blocks.0.norm2.weight', 'MAE_decoder.blocks.0.norm2.bias', 'MAE_decoder.blocks.0.mlp.fc1.weight', 'MAE_decoder.blocks.0.mlp.fc1.bias', 'MAE_decoder.blocks.0.mlp.fc2.weight', 'MAE_decoder.blocks.0.mlp.fc2.bias', 'MAE_decoder.blocks.0.attn.qkv.weight', 'MAE_decoder.blocks.0.attn.proj.weight', 'MAE_decoder.blocks.0.attn.proj.bias', 'MAE_decoder.blocks.1.norm1.weight', 'MAE_decoder.blocks.1.norm1.bias', 'MAE_decoder.blocks.1.norm2.weight', 'MAE_decoder.blocks.1.norm2.bias', 'MAE_decoder.blocks.1.mlp.fc1.weight', 'MAE_decoder.blocks.1.mlp.fc1.bias', 'MAE_decoder.blocks.1.mlp.fc2.weight', 'MAE_decoder.blocks.1.mlp.fc2.bias', 'MAE_decoder.blocks.1.attn.qkv.weight', 'MAE_decoder.blocks.1.attn.proj.weight', 'MAE_decoder.blocks.1.attn.proj.bias', 'MAE_decoder.blocks.2.norm1.weight', 'MAE_decoder.blocks.2.norm1.bias', 'MAE_decoder.blocks.2.norm2.weight', 'MAE_decoder.blocks.2.norm2.bias', 'MAE_decoder.blocks.2.mlp.fc1.weight', 'MAE_decoder.blocks.2.mlp.fc1.bias', 'MAE_decoder.blocks.2.mlp.fc2.weight', 'MAE_decoder.blocks.2.mlp.fc2.bias', 'MAE_decoder.blocks.2.attn.qkv.weight', 'MAE_decoder.blocks.2.attn.proj.weight', 'MAE_decoder.blocks.2.attn.proj.bias', 'MAE_decoder.blocks.3.norm1.weight', 'MAE_decoder.blocks.3.norm1.bias', 'MAE_decoder.blocks.3.norm2.weight', 'MAE_decoder.blocks.3.norm2.bias', 'MAE_decoder.blocks.3.mlp.fc1.weight', 'MAE_decoder.blocks.3.mlp.fc1.bias', 'MAE_decoder.blocks.3.mlp.fc2.weight', 'MAE_decoder.blocks.3.mlp.fc2.bias', 'MAE_decoder.blocks.3.attn.qkv.weight', 'MAE_decoder.blocks.3.attn.proj.weight', 'MAE_decoder.blocks.3.attn.proj.bias', 'MAE_decoder.norm.weight', 'MAE_decoder.norm.bias', 'increase_dim.0.weight', 'increase_dim.0.bias']
[Transformer] Successful Loading the ckpt from checkpoints/pointmae_pretrain.pth
point: <All keys matched successfully>
7fusion_block: <All keys matched successfully>
Extracting train features for class carrot:   0%|          | 0/286 [00:00<?, ?it/s]Extracting train features for class carrot:   0%|          | 1/286 [00:01<08:32,  1.80s/it]Extracting train features for class carrot:   1%|          | 2/286 [00:03<07:01,  1.48s/it]Extracting train features for class carrot:   1%|          | 3/286 [00:04<06:38,  1.41s/it]Extracting train features for class carrot:   1%|▏         | 4/286 [00:05<06:25,  1.37s/it]Extracting train features for class carrot:   2%|▏         | 5/286 [00:06<06:10,  1.32s/it]Extracting train features for class carrot:   2%|▏         | 6/286 [00:08<06:08,  1.32s/it]Extracting train features for class carrot:   2%|▏         | 7/286 [00:09<06:25,  1.38s/it]Extracting train features for class carrot:   3%|▎         | 8/286 [00:11<06:37,  1.43s/it]Extracting train features for class carrot:   3%|▎         | 9/286 [00:12<06:45,  1.47s/it]Extracting train features for class carrot:   3%|▎         | 10/286 [00:14<06:42,  1.46s/it]Extracting train features for class carrot:   4%|▍         | 11/286 [00:15<06:37,  1.45s/it]Extracting train features for class carrot:   4%|▍         | 12/286 [00:17<06:33,  1.43s/it]Extracting train features for class carrot:   5%|▍         | 13/286 [00:18<06:20,  1.39s/it]Extracting train features for class carrot:   5%|▍         | 14/286 [00:19<06:03,  1.34s/it]Extracting train features for class carrot:   5%|▌         | 15/286 [00:20<05:59,  1.33s/it]Extracting train features for class carrot:   6%|▌         | 16/286 [00:22<05:56,  1.32s/it]Extracting train features for class carrot:   6%|▌         | 17/286 [00:23<05:56,  1.32s/it]Extracting train features for class carrot:   6%|▋         | 18/286 [00:24<06:00,  1.35s/it]Extracting train features for class carrot:   7%|▋         | 19/286 [00:26<05:59,  1.35s/it]Extracting train features for class carrot:   7%|▋         | 20/286 [00:27<05:54,  1.33s/it]Extracting train features for class carrot:   7%|▋         | 21/286 [00:28<05:51,  1.33s/it]Extracting train features for class carrot:   8%|▊         | 22/286 [00:30<05:49,  1.32s/it]Extracting train features for class carrot:   8%|▊         | 23/286 [00:31<05:43,  1.31s/it]Extracting train features for class carrot:   8%|▊         | 24/286 [00:32<05:38,  1.29s/it]Extracting train features for class carrot:   9%|▊         | 25/286 [00:34<05:36,  1.29s/it]Extracting train features for class carrot:   9%|▉         | 26/286 [00:35<05:36,  1.29s/it]Extracting train features for class carrot:   9%|▉         | 27/286 [00:36<05:43,  1.33s/it]Extracting train features for class carrot:  10%|▉         | 28/286 [00:38<05:44,  1.34s/it]Extracting train features for class carrot:  10%|█         | 29/286 [00:39<05:38,  1.32s/it]Extracting train features for class carrot:  10%|█         | 30/286 [00:40<05:36,  1.31s/it]Extracting train features for class carrot:  11%|█         | 31/286 [00:42<05:36,  1.32s/it]Extracting train features for class carrot:  11%|█         | 32/286 [00:43<05:36,  1.32s/it]Extracting train features for class carrot:  12%|█▏        | 33/286 [00:44<05:37,  1.34s/it]Extracting train features for class carrot:  12%|█▏        | 34/286 [00:46<05:38,  1.34s/it]Extracting train features for class carrot:  12%|█▏        | 35/286 [00:47<06:03,  1.45s/it]Extracting train features for class carrot:  13%|█▎        | 36/286 [00:49<05:54,  1.42s/it]Extracting train features for class carrot:  13%|█▎        | 37/286 [00:50<06:07,  1.48s/it]Extracting train features for class carrot:  13%|█▎        | 38/286 [00:52<06:18,  1.53s/it]Extracting train features for class carrot:  14%|█▎        | 39/286 [00:53<06:04,  1.47s/it]Extracting train features for class carrot:  14%|█▍        | 40/286 [00:55<06:22,  1.56s/it]Extracting train features for class carrot:  14%|█▍        | 41/286 [00:56<06:01,  1.47s/it]Extracting train features for class carrot:  15%|█▍        | 42/286 [00:58<06:03,  1.49s/it]Extracting train features for class carrot:  15%|█▌        | 43/286 [00:59<05:49,  1.44s/it]Extracting train features for class carrot:  15%|█▌        | 44/286 [01:00<05:36,  1.39s/it]Extracting train features for class carrot:  16%|█▌        | 45/286 [01:02<05:46,  1.44s/it]Extracting train features for class carrot:  16%|█▌        | 46/286 [01:03<05:34,  1.40s/it]Extracting train features for class carrot:  16%|█▋        | 47/286 [01:05<05:42,  1.43s/it]Extracting train features for class carrot:  17%|█▋        | 48/286 [01:06<05:34,  1.40s/it]Extracting train features for class carrot:  17%|█▋        | 49/286 [01:08<05:45,  1.46s/it]Extracting train features for class carrot:  17%|█▋        | 50/286 [01:09<05:31,  1.41s/it]Extracting train features for class carrot:  18%|█▊        | 51/286 [01:10<05:40,  1.45s/it]Extracting train features for class carrot:  18%|█▊        | 52/286 [01:12<05:24,  1.39s/it]Extracting train features for class carrot:  19%|█▊        | 53/286 [01:13<05:18,  1.37s/it]Extracting train features for class carrot:  19%|█▉        | 54/286 [01:15<05:30,  1.42s/it]Extracting train features for class carrot:  19%|█▉        | 55/286 [01:16<05:18,  1.38s/it]Extracting train features for class carrot:  20%|█▉        | 56/286 [01:17<05:26,  1.42s/it]Extracting train features for class carrot:  20%|█▉        | 57/286 [01:19<05:19,  1.39s/it]Extracting train features for class carrot:  20%|██        | 58/286 [01:20<05:36,  1.48s/it]Extracting train features for class carrot:  21%|██        | 59/286 [01:22<05:29,  1.45s/it]Extracting train features for class carrot:  21%|██        | 60/286 [01:23<05:27,  1.45s/it]Extracting train features for class carrot:  21%|██▏       | 61/286 [01:25<05:40,  1.51s/it]Extracting train features for class carrot:  22%|██▏       | 62/286 [01:26<05:34,  1.49s/it]Extracting train features for class carrot:  22%|██▏       | 63/286 [01:28<05:35,  1.50s/it]Extracting train features for class carrot:  22%|██▏       | 64/286 [01:30<05:53,  1.59s/it]Extracting train features for class carrot:  23%|██▎       | 65/286 [01:31<05:43,  1.55s/it]Extracting train features for class carrot:  23%|██▎       | 66/286 [01:33<05:35,  1.53s/it]Extracting train features for class carrot:  23%|██▎       | 67/286 [01:34<05:55,  1.63s/it]Extracting train features for class carrot:  24%|██▍       | 68/286 [01:36<05:40,  1.56s/it]Extracting train features for class carrot:  24%|██▍       | 69/286 [01:37<05:31,  1.53s/it]Extracting train features for class carrot:  24%|██▍       | 70/286 [01:39<05:48,  1.61s/it]Extracting train features for class carrot:  25%|██▍       | 71/286 [01:41<05:38,  1.57s/it]Extracting train features for class carrot:  25%|██▌       | 72/286 [01:42<05:31,  1.55s/it]Extracting train features for class carrot:  26%|██▌       | 73/286 [01:44<05:42,  1.61s/it]Extracting train features for class carrot:  26%|██▌       | 74/286 [01:45<05:25,  1.53s/it]Extracting train features for class carrot:  26%|██▌       | 75/286 [01:47<05:31,  1.57s/it]Extracting train features for class carrot:  27%|██▋       | 76/286 [01:48<05:33,  1.59s/it]Extracting train features for class carrot:  27%|██▋       | 77/286 [01:50<05:14,  1.51s/it]Extracting train features for class carrot:  27%|██▋       | 78/286 [01:51<05:15,  1.52s/it]Extracting train features for class carrot:  28%|██▊       | 79/286 [01:53<04:58,  1.44s/it]Extracting train features for class carrot:  28%|██▊       | 80/286 [01:54<05:11,  1.51s/it]Extracting train features for class carrot:  28%|██▊       | 81/286 [01:56<05:01,  1.47s/it]Extracting train features for class carrot:  29%|██▊       | 82/286 [01:57<04:55,  1.45s/it]Extracting train features for class carrot:  29%|██▉       | 83/286 [01:59<05:12,  1.54s/it]Extracting train features for class carrot:  29%|██▉       | 84/286 [02:00<04:56,  1.47s/it]Extracting train features for class carrot:  30%|██▉       | 85/286 [02:02<05:00,  1.49s/it]Extracting train features for class carrot:  30%|███       | 86/286 [02:03<04:44,  1.42s/it]Extracting train features for class carrot:  30%|███       | 87/286 [02:04<04:51,  1.47s/it]Extracting train features for class carrot:  31%|███       | 88/286 [02:06<05:01,  1.52s/it]Extracting train features for class carrot:  31%|███       | 89/286 [02:08<04:56,  1.51s/it]Extracting train features for class carrot:  31%|███▏      | 90/286 [02:09<05:07,  1.57s/it]Extracting train features for class carrot:  32%|███▏      | 91/286 [02:11<05:06,  1.57s/it]Extracting train features for class carrot:  32%|███▏      | 92/286 [02:12<04:59,  1.55s/it]Extracting train features for class carrot:  33%|███▎      | 93/286 [02:14<05:11,  1.62s/it]Extracting train features for class carrot:  33%|███▎      | 94/286 [02:16<04:57,  1.55s/it]Extracting train features for class carrot:  33%|███▎      | 95/286 [02:17<04:41,  1.47s/it]Extracting train features for class carrot:  34%|███▎      | 96/286 [02:19<04:51,  1.54s/it]Extracting train features for class carrot:  34%|███▍      | 97/286 [02:20<04:37,  1.47s/it]Extracting train features for class carrot:  34%|███▍      | 98/286 [02:21<04:36,  1.47s/it]Extracting train features for class carrot:  35%|███▍      | 99/286 [02:23<04:25,  1.42s/it]Extracting train features for class carrot:  35%|███▍      | 100/286 [02:24<04:32,  1.46s/it]Extracting train features for class carrot:  35%|███▌      | 101/286 [02:26<04:28,  1.45s/it]Extracting train features for class carrot:  36%|███▌      | 102/286 [02:27<04:23,  1.43s/it]Extracting train features for class carrot:  36%|███▌      | 103/286 [02:29<04:30,  1.48s/it]Extracting train features for class carrot:  36%|███▋      | 104/286 [02:30<04:21,  1.44s/it]Extracting train features for class carrot:  37%|███▋      | 105/286 [02:32<04:30,  1.50s/it]Extracting train features for class carrot:  37%|███▋      | 106/286 [02:33<04:18,  1.44s/it]Extracting train features for class carrot:  37%|███▋      | 107/286 [02:34<04:19,  1.45s/it]Extracting train features for class carrot:  38%|███▊      | 108/286 [02:36<04:17,  1.45s/it]Extracting train features for class carrot:  38%|███▊      | 109/286 [02:37<04:07,  1.40s/it]Extracting train features for class carrot:  38%|███▊      | 110/286 [02:39<04:15,  1.45s/it]Extracting train features for class carrot:  39%|███▉      | 111/286 [02:40<04:06,  1.41s/it]Extracting train features for class carrot:  39%|███▉      | 112/286 [02:42<04:17,  1.48s/it]Extracting train features for class carrot:  40%|███▉      | 113/286 [02:43<04:07,  1.43s/it]Extracting train features for class carrot:  40%|███▉      | 114/286 [02:44<04:08,  1.44s/it]Extracting train features for class carrot:  40%|████      | 115/286 [02:46<04:25,  1.55s/it]Extracting train features for class carrot:  41%|████      | 116/286 [02:48<04:17,  1.51s/it]Extracting train features for class carrot:  41%|████      | 117/286 [02:49<04:24,  1.57s/it]Extracting train features for class carrot:  41%|████▏     | 118/286 [02:51<04:21,  1.56s/it]Extracting train features for class carrot:  42%|████▏     | 119/286 [02:52<04:13,  1.52s/it]Extracting train features for class carrot:  42%|████▏     | 120/286 [02:54<04:25,  1.60s/it]Extracting train features for class carrot:  42%|████▏     | 121/286 [02:56<04:21,  1.59s/it]Extracting train features for class carrot:  43%|████▎     | 122/286 [02:57<04:17,  1.57s/it]Extracting train features for class carrot:  43%|████▎     | 123/286 [02:59<04:25,  1.63s/it]Extracting train features for class carrot:  43%|████▎     | 124/286 [03:01<04:28,  1.66s/it]Extracting train features for class carrot:  44%|████▎     | 125/286 [03:02<04:24,  1.64s/it]Extracting train features for class carrot:  44%|████▍     | 126/286 [03:04<04:26,  1.67s/it]Extracting train features for class carrot:  44%|████▍     | 127/286 [03:05<04:12,  1.59s/it]Extracting train features for class carrot:  45%|████▍     | 128/286 [03:07<03:55,  1.49s/it]Extracting train features for class carrot:  45%|████▌     | 129/286 [03:08<03:59,  1.53s/it]Extracting train features for class carrot:  45%|████▌     | 130/286 [03:10<03:46,  1.45s/it]Extracting train features for class carrot:  46%|████▌     | 131/286 [03:11<03:52,  1.50s/it]Extracting train features for class carrot:  46%|████▌     | 132/286 [03:12<03:41,  1.44s/it]Extracting train features for class carrot:  47%|████▋     | 133/286 [03:14<03:44,  1.46s/it]Extracting train features for class carrot:  47%|████▋     | 134/286 [03:15<03:33,  1.41s/it]Extracting train features for class carrot:  47%|████▋     | 135/286 [03:17<03:37,  1.44s/it]Extracting train features for class carrot:  48%|████▊     | 136/286 [03:18<03:37,  1.45s/it]Extracting train features for class carrot:  48%|████▊     | 137/286 [03:20<03:29,  1.40s/it]Extracting train features for class carrot:  48%|████▊     | 138/286 [03:21<03:31,  1.43s/it]Extracting train features for class carrot:  49%|████▊     | 139/286 [03:22<03:22,  1.38s/it]Extracting train features for class carrot:  49%|████▉     | 140/286 [03:24<03:25,  1.41s/it]Extracting train features for class carrot:  49%|████▉     | 141/286 [03:25<03:17,  1.36s/it]Extracting train features for class carrot:  50%|████▉     | 142/286 [03:26<03:20,  1.40s/it]Extracting train features for class carrot:  50%|█████     | 143/286 [03:28<03:13,  1.35s/it]Extracting train features for class carrot:  50%|█████     | 144/286 [03:29<03:18,  1.40s/it]Extracting train features for class carrot:  51%|█████     | 145/286 [03:30<03:09,  1.35s/it]Extracting train features for class carrot:  51%|█████     | 146/286 [03:32<03:15,  1.40s/it]Extracting train features for class carrot:  51%|█████▏    | 147/286 [03:33<03:19,  1.43s/it]Extracting train features for class carrot:  52%|█████▏    | 148/286 [03:35<03:11,  1.39s/it]Extracting train features for class carrot:  52%|█████▏    | 149/286 [03:36<03:18,  1.45s/it]Extracting train features for class carrot:  52%|█████▏    | 150/286 [03:38<03:14,  1.43s/it]Extracting train features for class carrot:  53%|█████▎    | 151/286 [03:40<03:27,  1.54s/it]Extracting train features for class carrot:  53%|█████▎    | 152/286 [03:41<03:29,  1.57s/it]Extracting train features for class carrot:  53%|█████▎    | 153/286 [03:42<03:15,  1.47s/it]Extracting train features for class carrot:  54%|█████▍    | 154/286 [03:44<03:19,  1.51s/it]Extracting train features for class carrot:  54%|█████▍    | 155/286 [03:45<03:10,  1.45s/it]Extracting train features for class carrot:  55%|█████▍    | 156/286 [03:47<03:16,  1.51s/it]Extracting train features for class carrot:  55%|█████▍    | 157/286 [03:48<03:06,  1.45s/it]Extracting train features for class carrot:  55%|█████▌    | 158/286 [03:50<03:02,  1.43s/it]Extracting train features for class carrot:  56%|█████▌    | 159/286 [03:51<03:07,  1.48s/it]Extracting train features for class carrot:  56%|█████▌    | 160/286 [03:53<03:00,  1.43s/it]Extracting train features for class carrot:  56%|█████▋    | 161/286 [03:54<03:00,  1.44s/it]Extracting train features for class carrot:  57%|█████▋    | 162/286 [03:55<02:51,  1.38s/it]Extracting train features for class carrot:  57%|█████▋    | 163/286 [03:57<02:51,  1.40s/it]Extracting train features for class carrot:  57%|█████▋    | 164/286 [03:58<02:44,  1.35s/it]Extracting train features for class carrot:  58%|█████▊    | 165/286 [03:59<02:49,  1.40s/it]Extracting train features for class carrot:  58%|█████▊    | 166/286 [04:01<02:43,  1.36s/it]Extracting train features for class carrot:  58%|█████▊    | 167/286 [04:02<02:49,  1.42s/it]Extracting train features for class carrot:  59%|█████▊    | 168/286 [04:04<02:43,  1.39s/it]Extracting train features for class carrot:  59%|█████▉    | 169/286 [04:05<02:44,  1.40s/it]Extracting train features for class carrot:  59%|█████▉    | 170/286 [04:07<02:49,  1.46s/it]Extracting train features for class carrot:  60%|█████▉    | 171/286 [04:08<02:42,  1.41s/it]Extracting train features for class carrot:  60%|██████    | 172/286 [04:10<02:45,  1.45s/it]Extracting train features for class carrot:  60%|██████    | 173/286 [04:11<02:39,  1.41s/it]Extracting train features for class carrot:  61%|██████    | 174/286 [04:12<02:43,  1.46s/it]Extracting train features for class carrot:  61%|██████    | 175/286 [04:14<02:36,  1.41s/it]Extracting train features for class carrot:  62%|██████▏   | 176/286 [04:15<02:41,  1.47s/it]Extracting train features for class carrot:  62%|██████▏   | 177/286 [04:17<02:35,  1.43s/it]Extracting train features for class carrot:  62%|██████▏   | 178/286 [04:18<02:29,  1.38s/it]Extracting train features for class carrot:  63%|██████▎   | 179/286 [04:20<02:37,  1.48s/it]Extracting train features for class carrot:  63%|██████▎   | 180/286 [04:21<02:31,  1.43s/it]Extracting train features for class carrot:  63%|██████▎   | 181/286 [04:23<02:38,  1.51s/it]Extracting train features for class carrot:  64%|██████▎   | 182/286 [04:24<02:29,  1.44s/it]Extracting train features for class carrot:  64%|██████▍   | 183/286 [04:25<02:26,  1.42s/it]Extracting train features for class carrot:  64%|██████▍   | 184/286 [04:27<02:35,  1.52s/it]Extracting train features for class carrot:  65%|██████▍   | 185/286 [04:28<02:32,  1.51s/it]Extracting train features for class carrot:  65%|██████▌   | 186/286 [04:30<02:40,  1.60s/it]Extracting train features for class carrot:  65%|██████▌   | 187/286 [04:32<02:30,  1.52s/it]Extracting train features for class carrot:  66%|██████▌   | 188/286 [04:33<02:22,  1.46s/it]Extracting train features for class carrot:  66%|██████▌   | 189/286 [04:35<02:27,  1.52s/it]Extracting train features for class carrot:  66%|██████▋   | 190/286 [04:36<02:19,  1.45s/it]Extracting train features for class carrot:  67%|██████▋   | 191/286 [04:37<02:20,  1.47s/it]Extracting train features for class carrot:  67%|██████▋   | 192/286 [04:39<02:13,  1.42s/it]Extracting train features for class carrot:  67%|██████▋   | 193/286 [04:40<02:15,  1.46s/it]Extracting train features for class carrot:  68%|██████▊   | 194/286 [04:42<02:10,  1.41s/it]Extracting train features for class carrot:  68%|██████▊   | 195/286 [04:43<02:09,  1.43s/it]Extracting train features for class carrot:  69%|██████▊   | 196/286 [04:45<02:10,  1.45s/it]Extracting train features for class carrot:  69%|██████▉   | 197/286 [04:46<02:05,  1.41s/it]Extracting train features for class carrot:  69%|██████▉   | 198/286 [04:47<02:07,  1.44s/it]Extracting train features for class carrot:  70%|██████▉   | 199/286 [04:49<02:01,  1.40s/it]Extracting train features for class carrot:  70%|██████▉   | 200/286 [04:50<02:02,  1.42s/it]Extracting train features for class carrot:  70%|███████   | 201/286 [04:51<01:56,  1.37s/it]Extracting train features for class carrot:  71%|███████   | 202/286 [04:53<01:57,  1.40s/it]Extracting train features for class carrot:  71%|███████   | 203/286 [04:54<01:52,  1.36s/it]Extracting train features for class carrot:  71%|███████▏  | 204/286 [04:56<01:54,  1.40s/it]Extracting train features for class carrot:  72%|███████▏  | 205/286 [04:57<01:50,  1.36s/it]Extracting train features for class carrot:  72%|███████▏  | 206/286 [04:58<01:49,  1.37s/it]Extracting train features for class carrot:  72%|███████▏  | 207/286 [05:00<01:47,  1.36s/it]Extracting train features for class carrot:  73%|███████▎  | 208/286 [05:01<01:44,  1.34s/it]Extracting train features for class carrot:  73%|███████▎  | 209/286 [05:03<01:48,  1.41s/it]Extracting train features for class carrot:  73%|███████▎  | 210/286 [05:04<01:43,  1.37s/it]Extracting train features for class carrot:  74%|███████▍  | 211/286 [05:05<01:46,  1.43s/it]Extracting train features for class carrot:  74%|███████▍  | 212/286 [05:07<01:43,  1.40s/it]Extracting train features for class carrot:  74%|███████▍  | 213/286 [05:08<01:47,  1.47s/it]Extracting train features for class carrot:  75%|███████▍  | 214/286 [05:10<01:41,  1.41s/it]Extracting train features for class carrot:  75%|███████▌  | 215/286 [05:11<01:38,  1.39s/it]Extracting train features for class carrot:  76%|███████▌  | 216/286 [05:12<01:37,  1.39s/it]Extracting train features for class carrot:  76%|███████▌  | 217/286 [05:14<01:32,  1.35s/it]Extracting train features for class carrot:  76%|███████▌  | 218/286 [05:15<01:37,  1.44s/it]Extracting train features for class carrot:  77%|███████▋  | 219/286 [05:17<01:34,  1.41s/it]Extracting train features for class carrot:  77%|███████▋  | 220/286 [05:18<01:35,  1.44s/it]Extracting train features for class carrot:  77%|███████▋  | 221/286 [05:19<01:29,  1.38s/it]Extracting train features for class carrot:  78%|███████▊  | 222/286 [05:21<01:34,  1.47s/it]Extracting train features for class carrot:  78%|███████▊  | 223/286 [05:23<01:33,  1.49s/it]Extracting train features for class carrot:  78%|███████▊  | 224/286 [05:24<01:30,  1.46s/it]Extracting train features for class carrot:  79%|███████▊  | 225/286 [05:26<01:33,  1.53s/it]Extracting train features for class carrot:  79%|███████▉  | 226/286 [05:27<01:30,  1.50s/it]Extracting train features for class carrot:  79%|███████▉  | 227/286 [05:28<01:26,  1.47s/it]Extracting train features for class carrot:  80%|███████▉  | 228/286 [05:30<01:28,  1.53s/it]Extracting train features for class carrot:  80%|████████  | 229/286 [05:31<01:22,  1.45s/it]Extracting train features for class carrot:  80%|████████  | 230/286 [05:33<01:22,  1.48s/it]Extracting train features for class carrot:  81%|████████  | 231/286 [05:34<01:17,  1.41s/it]Extracting train features for class carrot:  81%|████████  | 232/286 [05:36<01:18,  1.45s/it]Extracting train features for class carrot:  81%|████████▏ | 233/286 [05:37<01:15,  1.42s/it]Extracting train features for class carrot:  82%|████████▏ | 234/286 [05:38<01:12,  1.40s/it]Extracting train features for class carrot:  82%|████████▏ | 235/286 [05:40<01:14,  1.47s/it]Extracting train features for class carrot:  83%|████████▎ | 236/286 [05:41<01:10,  1.41s/it]Extracting train features for class carrot:  83%|████████▎ | 237/286 [05:43<01:12,  1.49s/it]Extracting train features for class carrot:  83%|████████▎ | 238/286 [05:44<01:08,  1.42s/it]Extracting train features for class carrot:  84%|████████▎ | 239/286 [05:46<01:07,  1.44s/it]Extracting train features for class carrot:  84%|████████▍ | 240/286 [05:47<01:05,  1.43s/it]Extracting train features for class carrot:  84%|████████▍ | 241/286 [05:48<01:02,  1.39s/it]Extracting train features for class carrot:  85%|████████▍ | 242/286 [05:50<01:02,  1.42s/it]Extracting train features for class carrot:  85%|████████▍ | 243/286 [05:51<00:59,  1.38s/it]Extracting train features for class carrot:  85%|████████▌ | 244/286 [05:53<00:59,  1.42s/it]Extracting train features for class carrot:  86%|████████▌ | 245/286 [05:54<00:56,  1.37s/it]Extracting train features for class carrot:  86%|████████▌ | 246/286 [05:56<00:57,  1.44s/it]Extracting train features for class carrot:  86%|████████▋ | 247/286 [05:57<00:54,  1.40s/it]Extracting train features for class carrot:  87%|████████▋ | 248/286 [05:58<00:51,  1.36s/it]Extracting train features for class carrot:  87%|████████▋ | 249/286 [06:00<00:51,  1.40s/it]Extracting train features for class carrot:  87%|████████▋ | 250/286 [06:01<00:49,  1.36s/it]Extracting train features for class carrot:  88%|████████▊ | 251/286 [06:03<00:50,  1.44s/it]Extracting train features for class carrot:  88%|████████▊ | 252/286 [06:04<00:48,  1.41s/it]Extracting train features for class carrot:  88%|████████▊ | 253/286 [06:06<00:49,  1.51s/it]Extracting train features for class carrot:  89%|████████▉ | 254/286 [06:07<00:46,  1.45s/it]Extracting train features for class carrot:  89%|████████▉ | 255/286 [06:09<00:47,  1.55s/it]Extracting train features for class carrot:  90%|████████▉ | 256/286 [06:10<00:45,  1.53s/it]Extracting train features for class carrot:  90%|████████▉ | 257/286 [06:12<00:45,  1.58s/it]Extracting train features for class carrot:  90%|█████████ | 258/286 [06:14<00:44,  1.58s/it]Extracting train features for class carrot:  91%|█████████ | 259/286 [06:15<00:43,  1.60s/it]Extracting train features for class carrot:  91%|█████████ | 260/286 [06:17<00:40,  1.54s/it]Extracting train features for class carrot:  91%|█████████▏| 261/286 [06:18<00:37,  1.52s/it]Extracting train features for class carrot:  92%|█████████▏| 262/286 [06:20<00:37,  1.55s/it]Extracting train features for class carrot:  92%|█████████▏| 263/286 [06:21<00:36,  1.59s/it]Extracting train features for class carrot:  92%|█████████▏| 264/286 [06:23<00:36,  1.65s/it]Extracting train features for class carrot:  93%|█████████▎| 265/286 [06:25<00:34,  1.65s/it]Extracting train features for class carrot:  93%|█████████▎| 266/286 [06:26<00:32,  1.64s/it]Extracting train features for class carrot:  93%|█████████▎| 267/286 [06:28<00:29,  1.55s/it]Extracting train features for class carrot:  94%|█████████▎| 268/286 [06:29<00:28,  1.60s/it]Extracting train features for class carrot:  94%|█████████▍| 269/286 [06:31<00:25,  1.50s/it]Extracting train features for class carrot:  94%|█████████▍| 270/286 [06:32<00:25,  1.58s/it]Extracting train features for class carrot:  95%|█████████▍| 271/286 [06:34<00:22,  1.49s/it]Extracting train features for class carrot:  95%|█████████▌| 272/286 [06:35<00:21,  1.56s/it]Extracting train features for class carrot:  95%|█████████▌| 273/286 [06:37<00:19,  1.51s/it]Extracting train features for class carrot:  96%|█████████▌| 274/286 [06:39<00:18,  1.54s/it]Extracting train features for class carrot:  96%|█████████▌| 275/286 [06:40<00:16,  1.47s/it]Extracting train features for class carrot:  97%|█████████▋| 276/286 [06:41<00:15,  1.53s/it]Extracting train features for class carrot:  97%|█████████▋| 277/286 [06:43<00:13,  1.45s/it]Extracting train features for class carrot:  97%|█████████▋| 278/286 [06:44<00:12,  1.53s/it]Extracting train features for class carrot:  98%|█████████▊| 279/286 [06:46<00:10,  1.44s/it]Extracting train features for class carrot:  98%|█████████▊| 280/286 [06:47<00:08,  1.49s/it]Extracting train features for class carrot:  98%|█████████▊| 281/286 [06:49<00:07,  1.43s/it]Extracting train features for class carrot:  99%|█████████▊| 282/286 [06:50<00:06,  1.55s/it]Extracting train features for class carrot:  99%|█████████▉| 283/286 [06:52<00:04,  1.46s/it]Extracting train features for class carrot:  99%|█████████▉| 284/286 [06:53<00:02,  1.50s/it]Extracting train features for class carrot: 100%|█████████▉| 285/286 [06:55<00:01,  1.58s/it]Extracting train features for class carrot: 100%|██████████| 286/286 [06:56<00:00,  1.53s/it]Extracting train features for class carrot: 100%|██████████| 286/286 [06:57<00:00,  1.46s/it]


Running coreset for Fusion on class carrot...
Traceback (most recent call last):
  File "main.py", line 99, in <module>
    run_3d_ads(args)
  File "main.py", line 31, in run_3d_ads
    model.fit(cls)
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/m3dm_runner.py", line 60, in fit
    method.run_coreset()
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/feature_extractors/features_dino_fusion.py", line 174, in run_coreset
    self.coreset_idx = get_coreset_idx_randomp(self.patch_lib,
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/utils/utils.py", line 48, in get_coreset_idx_randomp
    z_lib = torch.tensor(transformer.fit_transform(z_lib))
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/random_projection.py", line 359, in fit
    X = self._validate_data(
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
  File "/usr/local/python38/lib/python3.8/site-packages/torch/_tensor.py", line 645, in __array__
    return self.numpy().astype(dtype, copy=False)
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
/usr/local/python38/lib/python3.8/site-packages/torch/utils/cpp_extension.py:284: UserWarning: 

                               !! WARNING !!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Your compiler (c++) is not compatible with the compiler Pytorch was
built with for this platform, which is g++ on linux. Please
use g++ to to compile your extension. Alternatively, you may
compile PyTorch from source using c++, and then you can also use
c++ to compile your extension.

See https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md for help
with compiling PyTorch from source.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

                              !! WARNING !!

  warnings.warn(WRONG_COMPILER_WARNING.format(
unexpected_keys
['mask_token', 'decoder_pos_embed.0.weight', 'decoder_pos_embed.0.bias', 'decoder_pos_embed.2.weight', 'decoder_pos_embed.2.bias', 'MAE_decoder.blocks.0.norm1.weight', 'MAE_decoder.blocks.0.norm1.bias', 'MAE_decoder.blocks.0.norm2.weight', 'MAE_decoder.blocks.0.norm2.bias', 'MAE_decoder.blocks.0.mlp.fc1.weight', 'MAE_decoder.blocks.0.mlp.fc1.bias', 'MAE_decoder.blocks.0.mlp.fc2.weight', 'MAE_decoder.blocks.0.mlp.fc2.bias', 'MAE_decoder.blocks.0.attn.qkv.weight', 'MAE_decoder.blocks.0.attn.proj.weight', 'MAE_decoder.blocks.0.attn.proj.bias', 'MAE_decoder.blocks.1.norm1.weight', 'MAE_decoder.blocks.1.norm1.bias', 'MAE_decoder.blocks.1.norm2.weight', 'MAE_decoder.blocks.1.norm2.bias', 'MAE_decoder.blocks.1.mlp.fc1.weight', 'MAE_decoder.blocks.1.mlp.fc1.bias', 'MAE_decoder.blocks.1.mlp.fc2.weight', 'MAE_decoder.blocks.1.mlp.fc2.bias', 'MAE_decoder.blocks.1.attn.qkv.weight', 'MAE_decoder.blocks.1.attn.proj.weight', 'MAE_decoder.blocks.1.attn.proj.bias', 'MAE_decoder.blocks.2.norm1.weight', 'MAE_decoder.blocks.2.norm1.bias', 'MAE_decoder.blocks.2.norm2.weight', 'MAE_decoder.blocks.2.norm2.bias', 'MAE_decoder.blocks.2.mlp.fc1.weight', 'MAE_decoder.blocks.2.mlp.fc1.bias', 'MAE_decoder.blocks.2.mlp.fc2.weight', 'MAE_decoder.blocks.2.mlp.fc2.bias', 'MAE_decoder.blocks.2.attn.qkv.weight', 'MAE_decoder.blocks.2.attn.proj.weight', 'MAE_decoder.blocks.2.attn.proj.bias', 'MAE_decoder.blocks.3.norm1.weight', 'MAE_decoder.blocks.3.norm1.bias', 'MAE_decoder.blocks.3.norm2.weight', 'MAE_decoder.blocks.3.norm2.bias', 'MAE_decoder.blocks.3.mlp.fc1.weight', 'MAE_decoder.blocks.3.mlp.fc1.bias', 'MAE_decoder.blocks.3.mlp.fc2.weight', 'MAE_decoder.blocks.3.mlp.fc2.bias', 'MAE_decoder.blocks.3.attn.qkv.weight', 'MAE_decoder.blocks.3.attn.proj.weight', 'MAE_decoder.blocks.3.attn.proj.bias', 'MAE_decoder.norm.weight', 'MAE_decoder.norm.bias', 'increase_dim.0.weight', 'increase_dim.0.bias']
[Transformer] Successful Loading the ckpt from checkpoints/pointmae_pretrain.pth
point: <All keys matched successfully>
7fusion_block: <All keys matched successfully>
Extracting train features for class cookie:   0%|          | 0/210 [00:00<?, ?it/s]Extracting train features for class cookie:   0%|          | 1/210 [00:03<11:46,  3.38s/it]Extracting train features for class cookie:   1%|          | 2/210 [00:06<11:25,  3.30s/it]Extracting train features for class cookie:   1%|▏         | 3/210 [00:10<11:38,  3.37s/it]Extracting train features for class cookie:   2%|▏         | 4/210 [00:13<11:45,  3.42s/it]Extracting train features for class cookie:   2%|▏         | 5/210 [00:17<11:44,  3.43s/it]Extracting train features for class cookie:   3%|▎         | 6/210 [00:20<11:35,  3.41s/it]Extracting train features for class cookie:   3%|▎         | 7/210 [00:23<11:42,  3.46s/it]Extracting train features for class cookie:   4%|▍         | 8/210 [00:26<11:10,  3.32s/it]Extracting train features for class cookie:   4%|▍         | 9/210 [00:29<09:54,  2.96s/it]Extracting train features for class cookie:   5%|▍         | 10/210 [00:32<10:02,  3.01s/it]Extracting train features for class cookie:   5%|▌         | 11/210 [00:35<10:41,  3.23s/it]Extracting train features for class cookie:   6%|▌         | 12/210 [00:39<11:23,  3.45s/it]Extracting train features for class cookie:   6%|▌         | 13/210 [00:44<12:01,  3.66s/it]Extracting train features for class cookie:   7%|▋         | 14/210 [00:48<12:27,  3.82s/it]Extracting train features for class cookie:   7%|▋         | 15/210 [00:52<12:47,  3.94s/it]Extracting train features for class cookie:   8%|▊         | 16/210 [00:56<12:56,  4.00s/it]Extracting train features for class cookie:   8%|▊         | 17/210 [01:00<13:01,  4.05s/it]Extracting train features for class cookie:   9%|▊         | 18/210 [01:05<13:14,  4.14s/it]Extracting train features for class cookie:   9%|▉         | 19/210 [01:09<13:11,  4.14s/it]Extracting train features for class cookie:  10%|▉         | 20/210 [01:13<13:00,  4.11s/it]Extracting train features for class cookie:  10%|█         | 21/210 [01:17<12:48,  4.06s/it]Extracting train features for class cookie:  10%|█         | 22/210 [01:20<12:17,  3.92s/it]Extracting train features for class cookie:  11%|█         | 23/210 [01:23<11:19,  3.63s/it]Extracting train features for class cookie:  11%|█▏        | 24/210 [01:25<09:51,  3.18s/it]Extracting train features for class cookie:  12%|█▏        | 25/210 [01:29<09:42,  3.15s/it]Extracting train features for class cookie:  12%|█▏        | 26/210 [01:32<10:01,  3.27s/it]Extracting train features for class cookie:  13%|█▎        | 27/210 [01:36<10:12,  3.35s/it]Extracting train features for class cookie:  13%|█▎        | 28/210 [01:39<10:25,  3.44s/it]Extracting train features for class cookie:  14%|█▍        | 29/210 [01:43<10:48,  3.58s/it]Extracting train features for class cookie:  14%|█▍        | 30/210 [01:47<11:01,  3.68s/it]Extracting train features for class cookie:  15%|█▍        | 31/210 [01:51<11:21,  3.81s/it]Extracting train features for class cookie:  15%|█▌        | 32/210 [01:55<11:15,  3.80s/it]Extracting train features for class cookie:  16%|█▌        | 33/210 [01:59<11:01,  3.74s/it]Extracting train features for class cookie:  16%|█▌        | 34/210 [02:02<10:59,  3.75s/it]Extracting train features for class cookie:  17%|█▋        | 35/210 [02:06<11:00,  3.77s/it]Extracting train features for class cookie:  17%|█▋        | 36/210 [02:10<10:44,  3.71s/it]Extracting train features for class cookie:  18%|█▊        | 37/210 [02:13<10:19,  3.58s/it]Extracting train features for class cookie:  18%|█▊        | 38/210 [02:16<10:05,  3.52s/it]Extracting train features for class cookie:  19%|█▊        | 39/210 [02:19<09:28,  3.32s/it]Extracting train features for class cookie:  19%|█▉        | 40/210 [02:21<08:29,  3.00s/it]Extracting train features for class cookie:  20%|█▉        | 41/210 [02:25<08:26,  3.00s/it]Extracting train features for class cookie:  20%|██        | 42/210 [02:28<08:34,  3.06s/it]Extracting train features for class cookie:  20%|██        | 43/210 [02:31<08:52,  3.19s/it]Extracting train features for class cookie:  21%|██        | 44/210 [02:35<09:00,  3.25s/it]Extracting train features for class cookie:  21%|██▏       | 45/210 [02:38<08:51,  3.22s/it]Extracting train features for class cookie:  22%|██▏       | 46/210 [02:41<08:27,  3.09s/it]Extracting train features for class cookie:  22%|██▏       | 47/210 [02:43<07:43,  2.84s/it]Extracting train features for class cookie:  23%|██▎       | 48/210 [02:46<07:44,  2.87s/it]Extracting train features for class cookie:  23%|██▎       | 49/210 [02:49<08:01,  2.99s/it]Extracting train features for class cookie:  24%|██▍       | 50/210 [02:52<08:18,  3.11s/it]Extracting train features for class cookie:  24%|██▍       | 51/210 [02:56<08:21,  3.16s/it]Extracting train features for class cookie:  25%|██▍       | 52/210 [02:59<08:05,  3.07s/it]Extracting train features for class cookie:  25%|██▌       | 53/210 [03:01<07:17,  2.78s/it]Extracting train features for class cookie:  26%|██▌       | 54/210 [03:03<07:15,  2.79s/it]Extracting train features for class cookie:  26%|██▌       | 55/210 [03:07<07:37,  2.95s/it]Extracting train features for class cookie:  27%|██▋       | 56/210 [03:10<08:05,  3.15s/it]Extracting train features for class cookie:  27%|██▋       | 57/210 [03:14<08:12,  3.22s/it]Extracting train features for class cookie:  28%|██▊       | 58/210 [03:17<08:18,  3.28s/it]Extracting train features for class cookie:  28%|██▊       | 59/210 [03:21<08:16,  3.29s/it]Extracting train features for class cookie:  29%|██▊       | 60/210 [03:23<07:49,  3.13s/it]Extracting train features for class cookie:  29%|██▉       | 61/210 [03:26<07:07,  2.87s/it]Extracting train features for class cookie:  30%|██▉       | 62/210 [03:29<07:11,  2.92s/it]Extracting train features for class cookie:  30%|███       | 63/210 [03:31<07:06,  2.90s/it]Extracting train features for class cookie:  30%|███       | 64/210 [03:34<06:51,  2.82s/it]Extracting train features for class cookie:  31%|███       | 65/210 [03:37<06:46,  2.80s/it]Extracting train features for class cookie:  31%|███▏      | 66/210 [03:40<06:42,  2.80s/it]Extracting train features for class cookie:  32%|███▏      | 67/210 [03:42<06:43,  2.83s/it]Extracting train features for class cookie:  32%|███▏      | 68/210 [03:46<07:02,  2.98s/it]Extracting train features for class cookie:  33%|███▎      | 69/210 [03:49<07:10,  3.05s/it]Extracting train features for class cookie:  33%|███▎      | 70/210 [03:52<07:05,  3.04s/it]Extracting train features for class cookie:  34%|███▍      | 71/210 [03:55<07:04,  3.05s/it]Extracting train features for class cookie:  34%|███▍      | 72/210 [03:58<07:00,  3.05s/it]Extracting train features for class cookie:  35%|███▍      | 73/210 [04:01<06:59,  3.07s/it]Extracting train features for class cookie:  35%|███▌      | 74/210 [04:04<07:01,  3.10s/it]Extracting train features for class cookie:  36%|███▌      | 75/210 [04:08<07:04,  3.15s/it]Extracting train features for class cookie:  36%|███▌      | 76/210 [04:11<07:01,  3.15s/it]Extracting train features for class cookie:  37%|███▋      | 77/210 [04:14<06:57,  3.14s/it]Extracting train features for class cookie:  37%|███▋      | 78/210 [04:17<06:55,  3.15s/it]Extracting train features for class cookie:  38%|███▊      | 79/210 [04:20<06:54,  3.17s/it]Extracting train features for class cookie:  38%|███▊      | 80/210 [04:24<06:58,  3.22s/it]Extracting train features for class cookie:  39%|███▊      | 81/210 [04:27<07:03,  3.28s/it]Extracting train features for class cookie:  39%|███▉      | 82/210 [04:30<07:01,  3.29s/it]Extracting train features for class cookie:  40%|███▉      | 83/210 [04:34<07:00,  3.31s/it]Extracting train features for class cookie:  40%|████      | 84/210 [04:37<06:58,  3.32s/it]Extracting train features for class cookie:  40%|████      | 85/210 [04:41<06:57,  3.34s/it]Extracting train features for class cookie:  41%|████      | 86/210 [04:44<06:56,  3.36s/it]Extracting train features for class cookie:  41%|████▏     | 87/210 [04:47<06:54,  3.37s/it]Extracting train features for class cookie:  42%|████▏     | 88/210 [04:51<06:54,  3.40s/it]Extracting train features for class cookie:  42%|████▏     | 89/210 [04:54<06:57,  3.45s/it]Extracting train features for class cookie:  43%|████▎     | 90/210 [04:58<06:56,  3.47s/it]Extracting train features for class cookie:  43%|████▎     | 91/210 [05:01<06:51,  3.46s/it]Extracting train features for class cookie:  44%|████▍     | 92/210 [05:05<06:48,  3.46s/it]Extracting train features for class cookie:  44%|████▍     | 93/210 [05:08<06:41,  3.43s/it]Extracting train features for class cookie:  45%|████▍     | 94/210 [05:11<06:24,  3.32s/it]Extracting train features for class cookie:  45%|████▌     | 95/210 [05:14<06:10,  3.22s/it]Extracting train features for class cookie:  46%|████▌     | 96/210 [05:17<06:01,  3.17s/it]Extracting train features for class cookie:  46%|████▌     | 97/210 [05:20<05:58,  3.17s/it]Extracting train features for class cookie:  47%|████▋     | 98/210 [05:24<05:57,  3.20s/it]Extracting train features for class cookie:  47%|████▋     | 99/210 [05:27<05:58,  3.23s/it]Extracting train features for class cookie:  48%|████▊     | 100/210 [05:30<05:55,  3.24s/it]Extracting train features for class cookie:  48%|████▊     | 101/210 [05:33<05:54,  3.25s/it]Extracting train features for class cookie:  49%|████▊     | 102/210 [05:37<05:51,  3.25s/it]Extracting train features for class cookie:  49%|████▉     | 103/210 [05:40<05:50,  3.27s/it]Extracting train features for class cookie:  50%|████▉     | 104/210 [05:43<05:49,  3.30s/it]Extracting train features for class cookie:  50%|█████     | 105/210 [05:47<05:48,  3.32s/it]Extracting train features for class cookie:  50%|█████     | 106/210 [05:50<05:49,  3.36s/it]Extracting train features for class cookie:  51%|█████     | 107/210 [05:54<05:53,  3.43s/it]Extracting train features for class cookie:  51%|█████▏    | 108/210 [05:57<05:54,  3.47s/it]Extracting train features for class cookie:  52%|█████▏    | 109/210 [06:01<05:52,  3.49s/it]Extracting train features for class cookie:  52%|█████▏    | 110/210 [06:05<05:53,  3.54s/it]Extracting train features for class cookie:  53%|█████▎    | 111/210 [06:08<05:49,  3.53s/it]Extracting train features for class cookie:  53%|█████▎    | 112/210 [06:11<05:40,  3.48s/it]Extracting train features for class cookie:  54%|█████▍    | 113/210 [06:15<05:30,  3.41s/it]Extracting train features for class cookie:  54%|█████▍    | 114/210 [06:18<05:17,  3.31s/it]Extracting train features for class cookie:  55%|█████▍    | 115/210 [06:21<05:08,  3.25s/it]Extracting train features for class cookie:  55%|█████▌    | 116/210 [06:24<05:02,  3.22s/it]Extracting train features for class cookie:  56%|█████▌    | 117/210 [06:27<04:56,  3.19s/it]Extracting train features for class cookie:  56%|█████▌    | 118/210 [06:30<04:49,  3.14s/it]Extracting train features for class cookie:  57%|█████▋    | 119/210 [06:33<04:46,  3.15s/it]Extracting train features for class cookie:  57%|█████▋    | 120/210 [06:37<04:53,  3.26s/it]Extracting train features for class cookie:  58%|█████▊    | 121/210 [06:40<04:58,  3.35s/it]Extracting train features for class cookie:  58%|█████▊    | 122/210 [06:44<05:01,  3.42s/it]Extracting train features for class cookie:  59%|█████▊    | 123/210 [06:48<05:01,  3.47s/it]Extracting train features for class cookie:  59%|█████▉    | 124/210 [06:51<04:56,  3.45s/it]Extracting train features for class cookie:  60%|█████▉    | 125/210 [06:54<04:52,  3.44s/it]Extracting train features for class cookie:  60%|██████    | 126/210 [06:58<04:47,  3.42s/it]Extracting train features for class cookie:  60%|██████    | 127/210 [07:01<04:45,  3.44s/it]Extracting train features for class cookie:  61%|██████    | 128/210 [07:05<04:42,  3.44s/it]Extracting train features for class cookie:  61%|██████▏   | 129/210 [07:08<04:43,  3.50s/it]Extracting train features for class cookie:  62%|██████▏   | 130/210 [07:12<04:41,  3.52s/it]Extracting train features for class cookie:  62%|██████▏   | 131/210 [07:15<04:38,  3.53s/it]Extracting train features for class cookie:  63%|██████▎   | 132/210 [07:19<04:35,  3.53s/it]Extracting train features for class cookie:  63%|██████▎   | 133/210 [07:22<04:29,  3.50s/it]Extracting train features for class cookie:  64%|██████▍   | 134/210 [07:26<04:21,  3.44s/it]Extracting train features for class cookie:  64%|██████▍   | 135/210 [07:29<04:13,  3.38s/it]Extracting train features for class cookie:  65%|██████▍   | 136/210 [07:32<04:05,  3.32s/it]Extracting train features for class cookie:  65%|██████▌   | 137/210 [07:35<03:59,  3.28s/it]Extracting train features for class cookie:  66%|██████▌   | 138/210 [07:38<03:51,  3.22s/it]Extracting train features for class cookie:  66%|██████▌   | 139/210 [07:42<03:45,  3.18s/it]Extracting train features for class cookie:  67%|██████▋   | 140/210 [07:45<03:42,  3.18s/it]Extracting train features for class cookie:  67%|██████▋   | 141/210 [07:48<03:39,  3.18s/it]Extracting train features for class cookie:  68%|██████▊   | 142/210 [07:51<03:37,  3.19s/it]Extracting train features for class cookie:  68%|██████▊   | 143/210 [07:54<03:34,  3.20s/it]Extracting train features for class cookie:  69%|██████▊   | 144/210 [07:58<03:34,  3.25s/it]Extracting train features for class cookie:  69%|██████▉   | 145/210 [08:01<03:32,  3.27s/it]Extracting train features for class cookie:  70%|██████▉   | 146/210 [08:04<03:32,  3.33s/it]Extracting train features for class cookie:  70%|███████   | 147/210 [08:08<03:32,  3.37s/it]Extracting train features for class cookie:  70%|███████   | 148/210 [08:11<03:31,  3.41s/it]Extracting train features for class cookie:  71%|███████   | 149/210 [08:15<03:27,  3.40s/it]Extracting train features for class cookie:  71%|███████▏  | 150/210 [08:18<03:24,  3.41s/it]Extracting train features for class cookie:  72%|███████▏  | 151/210 [08:22<03:19,  3.39s/it]Extracting train features for class cookie:  72%|███████▏  | 152/210 [08:25<03:14,  3.35s/it]Extracting train features for class cookie:  73%|███████▎  | 153/210 [08:28<03:06,  3.28s/it]Extracting train features for class cookie:  73%|███████▎  | 154/210 [08:31<03:00,  3.22s/it]Extracting train features for class cookie:  74%|███████▍  | 155/210 [08:34<02:55,  3.19s/it]Extracting train features for class cookie:  74%|███████▍  | 156/210 [08:37<02:52,  3.19s/it]Extracting train features for class cookie:  75%|███████▍  | 157/210 [08:40<02:46,  3.14s/it]Extracting train features for class cookie:  75%|███████▌  | 158/210 [08:43<02:40,  3.08s/it]Extracting train features for class cookie:  76%|███████▌  | 159/210 [08:47<02:41,  3.17s/it]Extracting train features for class cookie:  76%|███████▌  | 160/210 [08:50<02:44,  3.29s/it]Extracting train features for class cookie:  77%|███████▋  | 161/210 [08:54<02:44,  3.35s/it]Extracting train features for class cookie:  77%|███████▋  | 162/210 [08:57<02:39,  3.33s/it]Extracting train features for class cookie:  78%|███████▊  | 163/210 [09:00<02:31,  3.23s/it]Extracting train features for class cookie:  78%|███████▊  | 164/210 [09:03<02:25,  3.16s/it]Extracting train features for class cookie:  79%|███████▊  | 165/210 [09:06<02:21,  3.15s/it]Extracting train features for class cookie:  79%|███████▉  | 166/210 [09:09<02:17,  3.12s/it]Extracting train features for class cookie:  80%|███████▉  | 167/210 [09:12<02:14,  3.13s/it]Extracting train features for class cookie:  80%|████████  | 168/210 [09:16<02:15,  3.23s/it]Extracting train features for class cookie:  80%|████████  | 169/210 [09:19<02:12,  3.24s/it]Extracting train features for class cookie:  81%|████████  | 170/210 [09:22<02:08,  3.22s/it]Extracting train features for class cookie:  81%|████████▏ | 171/210 [09:26<02:06,  3.25s/it]Extracting train features for class cookie:  82%|████████▏ | 172/210 [09:29<02:02,  3.23s/it]Extracting train features for class cookie:  82%|████████▏ | 173/210 [09:32<01:58,  3.21s/it]Extracting train features for class cookie:  83%|████████▎ | 174/210 [09:35<01:55,  3.21s/it]Extracting train features for class cookie:  83%|████████▎ | 175/210 [09:38<01:53,  3.24s/it]Extracting train features for class cookie:  84%|████████▍ | 176/210 [09:42<01:50,  3.26s/it]Extracting train features for class cookie:  84%|████████▍ | 177/210 [09:45<01:47,  3.27s/it]Extracting train features for class cookie:  85%|████████▍ | 178/210 [09:48<01:44,  3.27s/it]Extracting train features for class cookie:  85%|████████▌ | 179/210 [09:52<01:41,  3.28s/it]Extracting train features for class cookie:  86%|████████▌ | 180/210 [09:55<01:38,  3.29s/it]Extracting train features for class cookie:  86%|████████▌ | 181/210 [09:58<01:36,  3.31s/it]Extracting train features for class cookie:  87%|████████▋ | 182/210 [10:02<01:33,  3.36s/it]Extracting train features for class cookie:  87%|████████▋ | 183/210 [10:05<01:31,  3.41s/it]Extracting train features for class cookie:  88%|████████▊ | 184/210 [10:09<01:29,  3.44s/it]Extracting train features for class cookie:  88%|████████▊ | 185/210 [10:12<01:26,  3.47s/it]Extracting train features for class cookie:  89%|████████▊ | 186/210 [10:15<01:20,  3.36s/it]Extracting train features for class cookie:  89%|████████▉ | 187/210 [10:19<01:15,  3.30s/it]Extracting train features for class cookie:  90%|████████▉ | 188/210 [10:21<01:08,  3.10s/it]Extracting train features for class cookie:  90%|█████████ | 189/210 [10:24<01:00,  2.88s/it]Extracting train features for class cookie:  90%|█████████ | 190/210 [10:26<00:54,  2.73s/it]Extracting train features for class cookie:  91%|█████████ | 191/210 [10:29<00:50,  2.66s/it]Extracting train features for class cookie:  91%|█████████▏| 192/210 [10:31<00:45,  2.51s/it]Extracting train features for class cookie:  92%|█████████▏| 193/210 [10:33<00:42,  2.52s/it]Extracting train features for class cookie:  92%|█████████▏| 194/210 [10:36<00:41,  2.57s/it]Extracting train features for class cookie:  93%|█████████▎| 195/210 [10:39<00:39,  2.62s/it]Extracting train features for class cookie:  93%|█████████▎| 196/210 [10:41<00:36,  2.61s/it]Extracting train features for class cookie:  94%|█████████▍| 197/210 [10:44<00:34,  2.62s/it]Extracting train features for class cookie:  94%|█████████▍| 198/210 [10:47<00:31,  2.63s/it]Extracting train features for class cookie:  95%|█████████▍| 199/210 [10:49<00:28,  2.62s/it]Extracting train features for class cookie:  95%|█████████▌| 200/210 [10:52<00:26,  2.64s/it]Extracting train features for class cookie:  96%|█████████▌| 201/210 [10:54<00:23,  2.61s/it]Extracting train features for class cookie:  96%|█████████▌| 202/210 [10:57<00:21,  2.63s/it]Extracting train features for class cookie:  97%|█████████▋| 203/210 [11:00<00:18,  2.61s/it]Extracting train features for class cookie:  97%|█████████▋| 204/210 [11:02<00:15,  2.63s/it]Extracting train features for class cookie:  98%|█████████▊| 205/210 [11:05<00:13,  2.61s/it]Extracting train features for class cookie:  98%|█████████▊| 206/210 [11:07<00:10,  2.62s/it]Extracting train features for class cookie:  99%|█████████▊| 207/210 [11:10<00:07,  2.64s/it]Extracting train features for class cookie:  99%|█████████▉| 208/210 [11:13<00:05,  2.62s/it]Extracting train features for class cookie: 100%|█████████▉| 209/210 [11:15<00:02,  2.63s/it]Extracting train features for class cookie: 100%|██████████| 210/210 [11:18<00:00,  2.61s/it]Extracting train features for class cookie: 100%|██████████| 210/210 [11:18<00:00,  3.23s/it]


Running coreset for Fusion on class cookie...
Traceback (most recent call last):
  File "main.py", line 99, in <module>
    run_3d_ads(args)
  File "main.py", line 31, in run_3d_ads
    model.fit(cls)
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/m3dm_runner.py", line 60, in fit
    method.run_coreset()
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/feature_extractors/features_dino_fusion.py", line 174, in run_coreset
    self.coreset_idx = get_coreset_idx_randomp(self.patch_lib,
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/utils/utils.py", line 48, in get_coreset_idx_randomp
    z_lib = torch.tensor(transformer.fit_transform(z_lib))
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/random_projection.py", line 359, in fit
    X = self._validate_data(
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
  File "/usr/local/python38/lib/python3.8/site-packages/torch/_tensor.py", line 645, in __array__
    return self.numpy().astype(dtype, copy=False)
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
/usr/local/python38/lib/python3.8/site-packages/torch/utils/cpp_extension.py:284: UserWarning: 

                               !! WARNING !!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Your compiler (c++) is not compatible with the compiler Pytorch was
built with for this platform, which is g++ on linux. Please
use g++ to to compile your extension. Alternatively, you may
compile PyTorch from source using c++, and then you can also use
c++ to compile your extension.

See https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md for help
with compiling PyTorch from source.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

                              !! WARNING !!

  warnings.warn(WRONG_COMPILER_WARNING.format(
unexpected_keys
['mask_token', 'decoder_pos_embed.0.weight', 'decoder_pos_embed.0.bias', 'decoder_pos_embed.2.weight', 'decoder_pos_embed.2.bias', 'MAE_decoder.blocks.0.norm1.weight', 'MAE_decoder.blocks.0.norm1.bias', 'MAE_decoder.blocks.0.norm2.weight', 'MAE_decoder.blocks.0.norm2.bias', 'MAE_decoder.blocks.0.mlp.fc1.weight', 'MAE_decoder.blocks.0.mlp.fc1.bias', 'MAE_decoder.blocks.0.mlp.fc2.weight', 'MAE_decoder.blocks.0.mlp.fc2.bias', 'MAE_decoder.blocks.0.attn.qkv.weight', 'MAE_decoder.blocks.0.attn.proj.weight', 'MAE_decoder.blocks.0.attn.proj.bias', 'MAE_decoder.blocks.1.norm1.weight', 'MAE_decoder.blocks.1.norm1.bias', 'MAE_decoder.blocks.1.norm2.weight', 'MAE_decoder.blocks.1.norm2.bias', 'MAE_decoder.blocks.1.mlp.fc1.weight', 'MAE_decoder.blocks.1.mlp.fc1.bias', 'MAE_decoder.blocks.1.mlp.fc2.weight', 'MAE_decoder.blocks.1.mlp.fc2.bias', 'MAE_decoder.blocks.1.attn.qkv.weight', 'MAE_decoder.blocks.1.attn.proj.weight', 'MAE_decoder.blocks.1.attn.proj.bias', 'MAE_decoder.blocks.2.norm1.weight', 'MAE_decoder.blocks.2.norm1.bias', 'MAE_decoder.blocks.2.norm2.weight', 'MAE_decoder.blocks.2.norm2.bias', 'MAE_decoder.blocks.2.mlp.fc1.weight', 'MAE_decoder.blocks.2.mlp.fc1.bias', 'MAE_decoder.blocks.2.mlp.fc2.weight', 'MAE_decoder.blocks.2.mlp.fc2.bias', 'MAE_decoder.blocks.2.attn.qkv.weight', 'MAE_decoder.blocks.2.attn.proj.weight', 'MAE_decoder.blocks.2.attn.proj.bias', 'MAE_decoder.blocks.3.norm1.weight', 'MAE_decoder.blocks.3.norm1.bias', 'MAE_decoder.blocks.3.norm2.weight', 'MAE_decoder.blocks.3.norm2.bias', 'MAE_decoder.blocks.3.mlp.fc1.weight', 'MAE_decoder.blocks.3.mlp.fc1.bias', 'MAE_decoder.blocks.3.mlp.fc2.weight', 'MAE_decoder.blocks.3.mlp.fc2.bias', 'MAE_decoder.blocks.3.attn.qkv.weight', 'MAE_decoder.blocks.3.attn.proj.weight', 'MAE_decoder.blocks.3.attn.proj.bias', 'MAE_decoder.norm.weight', 'MAE_decoder.norm.bias', 'increase_dim.0.weight', 'increase_dim.0.bias']
[Transformer] Successful Loading the ckpt from checkpoints/pointmae_pretrain.pth
point: <All keys matched successfully>
7fusion_block: <All keys matched successfully>
Extracting train features for class dowel:   0%|          | 0/288 [00:00<?, ?it/s]Extracting train features for class dowel:   0%|          | 1/288 [00:01<07:36,  1.59s/it]Extracting train features for class dowel:   1%|          | 2/288 [00:02<06:51,  1.44s/it]Extracting train features for class dowel:   1%|          | 3/288 [00:04<06:35,  1.39s/it]Extracting train features for class dowel:   1%|▏         | 4/288 [00:05<06:26,  1.36s/it]Extracting train features for class dowel:   2%|▏         | 5/288 [00:06<06:23,  1.36s/it]Extracting train features for class dowel:   2%|▏         | 6/288 [00:08<06:21,  1.35s/it]Extracting train features for class dowel:   2%|▏         | 7/288 [00:09<06:20,  1.35s/it]Extracting train features for class dowel:   3%|▎         | 8/288 [00:10<06:17,  1.35s/it]Extracting train features for class dowel:   3%|▎         | 9/288 [00:12<06:18,  1.36s/it]Extracting train features for class dowel:   3%|▎         | 10/288 [00:13<06:14,  1.35s/it]Extracting train features for class dowel:   4%|▍         | 11/288 [00:14<06:11,  1.34s/it]Extracting train features for class dowel:   4%|▍         | 12/288 [00:16<06:08,  1.34s/it]Extracting train features for class dowel:   5%|▍         | 13/288 [00:17<06:31,  1.42s/it]Extracting train features for class dowel:   5%|▍         | 14/288 [00:19<06:23,  1.40s/it]Extracting train features for class dowel:   5%|▌         | 15/288 [00:20<06:42,  1.48s/it]Extracting train features for class dowel:   6%|▌         | 16/288 [00:22<06:28,  1.43s/it]Extracting train features for class dowel:   6%|▌         | 17/288 [00:23<06:19,  1.40s/it]Extracting train features for class dowel:   6%|▋         | 18/288 [00:25<06:45,  1.50s/it]Extracting train features for class dowel:   7%|▋         | 19/288 [00:26<06:33,  1.46s/it]Extracting train features for class dowel:   7%|▋         | 20/288 [00:28<06:47,  1.52s/it]Extracting train features for class dowel:   7%|▋         | 21/288 [00:29<06:47,  1.53s/it]Extracting train features for class dowel:   8%|▊         | 22/288 [00:31<06:29,  1.46s/it]Extracting train features for class dowel:   8%|▊         | 23/288 [00:32<06:43,  1.52s/it]Extracting train features for class dowel:   8%|▊         | 24/288 [00:34<06:30,  1.48s/it]Extracting train features for class dowel:   9%|▊         | 25/288 [00:35<06:17,  1.44s/it]Extracting train features for class dowel:   9%|▉         | 26/288 [00:37<06:40,  1.53s/it]Extracting train features for class dowel:   9%|▉         | 27/288 [00:38<06:23,  1.47s/it]Extracting train features for class dowel:  10%|▉         | 28/288 [00:40<06:31,  1.50s/it]Extracting train features for class dowel:  10%|█         | 29/288 [00:42<07:01,  1.63s/it]Extracting train features for class dowel:  10%|█         | 30/288 [00:43<06:54,  1.61s/it]Extracting train features for class dowel:  11%|█         | 31/288 [00:45<06:50,  1.60s/it]Extracting train features for class dowel:  11%|█         | 32/288 [00:47<07:07,  1.67s/it]Extracting train features for class dowel:  11%|█▏        | 33/288 [00:49<07:21,  1.73s/it]Extracting train features for class dowel:  12%|█▏        | 34/288 [00:50<07:07,  1.68s/it]Extracting train features for class dowel:  12%|█▏        | 35/288 [00:52<06:59,  1.66s/it]Extracting train features for class dowel:  12%|█▎        | 36/288 [00:54<07:16,  1.73s/it]Extracting train features for class dowel:  13%|█▎        | 37/288 [00:55<07:20,  1.75s/it]Extracting train features for class dowel:  13%|█▎        | 38/288 [00:57<07:05,  1.70s/it]Extracting train features for class dowel:  14%|█▎        | 39/288 [00:59<07:02,  1.70s/it]Extracting train features for class dowel:  14%|█▍        | 40/288 [01:01<07:16,  1.76s/it]Extracting train features for class dowel:  14%|█▍        | 41/288 [01:02<07:01,  1.71s/it]Extracting train features for class dowel:  15%|█▍        | 42/288 [01:04<06:48,  1.66s/it]Extracting train features for class dowel:  15%|█▍        | 43/288 [01:06<07:01,  1.72s/it]Extracting train features for class dowel:  15%|█▌        | 44/288 [01:07<07:09,  1.76s/it]Extracting train features for class dowel:  16%|█▌        | 45/288 [01:09<06:55,  1.71s/it]Extracting train features for class dowel:  16%|█▌        | 46/288 [01:11<06:47,  1.68s/it]Extracting train features for class dowel:  16%|█▋        | 47/288 [01:13<07:03,  1.76s/it]Extracting train features for class dowel:  17%|█▋        | 48/288 [01:14<07:03,  1.76s/it]Extracting train features for class dowel:  17%|█▋        | 49/288 [01:16<06:40,  1.67s/it]Extracting train features for class dowel:  17%|█▋        | 50/288 [01:18<06:40,  1.68s/it]Extracting train features for class dowel:  18%|█▊        | 51/288 [01:19<06:55,  1.75s/it]Extracting train features for class dowel:  18%|█▊        | 52/288 [01:21<06:41,  1.70s/it]Extracting train features for class dowel:  18%|█▊        | 53/288 [01:23<06:32,  1.67s/it]Extracting train features for class dowel:  19%|█▉        | 54/288 [01:24<06:44,  1.73s/it]Extracting train features for class dowel:  19%|█▉        | 55/288 [01:26<06:56,  1.79s/it]Extracting train features for class dowel:  19%|█▉        | 56/288 [01:28<06:41,  1.73s/it]Extracting train features for class dowel:  20%|█▉        | 57/288 [01:30<06:29,  1.69s/it]Extracting train features for class dowel:  20%|██        | 58/288 [01:31<06:40,  1.74s/it]Extracting train features for class dowel:  20%|██        | 59/288 [01:33<06:49,  1.79s/it]Extracting train features for class dowel:  21%|██        | 60/288 [01:35<06:35,  1.73s/it]Extracting train features for class dowel:  21%|██        | 61/288 [01:37<06:24,  1.69s/it]Extracting train features for class dowel:  22%|██▏       | 62/288 [01:38<06:36,  1.76s/it]Extracting train features for class dowel:  22%|██▏       | 63/288 [01:40<06:41,  1.79s/it]Extracting train features for class dowel:  22%|██▏       | 64/288 [01:42<06:26,  1.73s/it]Extracting train features for class dowel:  23%|██▎       | 65/288 [01:43<06:15,  1.68s/it]Extracting train features for class dowel:  23%|██▎       | 66/288 [01:45<06:28,  1.75s/it]Extracting train features for class dowel:  23%|██▎       | 67/288 [01:47<06:25,  1.74s/it]Extracting train features for class dowel:  24%|██▎       | 68/288 [01:49<06:10,  1.69s/it]Extracting train features for class dowel:  24%|██▍       | 69/288 [01:50<06:11,  1.70s/it]Extracting train features for class dowel:  24%|██▍       | 70/288 [01:52<06:24,  1.76s/it]Extracting train features for class dowel:  25%|██▍       | 71/288 [01:54<06:15,  1.73s/it]Extracting train features for class dowel:  25%|██▌       | 72/288 [01:56<06:05,  1.69s/it]Extracting train features for class dowel:  25%|██▌       | 73/288 [01:57<05:53,  1.64s/it]Extracting train features for class dowel:  26%|██▌       | 74/288 [01:59<06:06,  1.71s/it]Extracting train features for class dowel:  26%|██▌       | 75/288 [02:01<05:54,  1.66s/it]Extracting train features for class dowel:  26%|██▋       | 76/288 [02:02<05:33,  1.57s/it]Extracting train features for class dowel:  27%|██▋       | 77/288 [02:04<05:45,  1.64s/it]Extracting train features for class dowel:  27%|██▋       | 78/288 [02:05<05:24,  1.55s/it]Extracting train features for class dowel:  27%|██▋       | 79/288 [02:06<05:09,  1.48s/it]Extracting train features for class dowel:  28%|██▊       | 80/288 [02:08<05:26,  1.57s/it]Extracting train features for class dowel:  28%|██▊       | 81/288 [02:09<05:10,  1.50s/it]Extracting train features for class dowel:  28%|██▊       | 82/288 [02:11<05:13,  1.52s/it]Extracting train features for class dowel:  29%|██▉       | 83/288 [02:13<05:26,  1.59s/it]Extracting train features for class dowel:  29%|██▉       | 84/288 [02:14<05:08,  1.51s/it]Extracting train features for class dowel:  30%|██▉       | 85/288 [02:16<05:22,  1.59s/it]Extracting train features for class dowel:  30%|██▉       | 86/288 [02:17<05:21,  1.59s/it]Extracting train features for class dowel:  30%|███       | 87/288 [02:19<05:04,  1.51s/it]Extracting train features for class dowel:  31%|███       | 88/288 [02:21<05:19,  1.60s/it]Extracting train features for class dowel:  31%|███       | 89/288 [02:22<05:01,  1.51s/it]Extracting train features for class dowel:  31%|███▏      | 90/288 [02:23<04:48,  1.46s/it]Extracting train features for class dowel:  32%|███▏      | 91/288 [02:25<05:01,  1.53s/it]Extracting train features for class dowel:  32%|███▏      | 92/288 [02:26<04:47,  1.47s/it]Extracting train features for class dowel:  32%|███▏      | 93/288 [02:28<04:59,  1.53s/it]Extracting train features for class dowel:  33%|███▎      | 94/288 [02:30<05:05,  1.58s/it]Extracting train features for class dowel:  33%|███▎      | 95/288 [02:31<04:49,  1.50s/it]Extracting train features for class dowel:  33%|███▎      | 96/288 [02:33<05:04,  1.59s/it]Extracting train features for class dowel:  34%|███▎      | 97/288 [02:34<04:50,  1.52s/it]Extracting train features for class dowel:  34%|███▍      | 98/288 [02:35<04:36,  1.46s/it]Extracting train features for class dowel:  34%|███▍      | 99/288 [02:37<04:43,  1.50s/it]Extracting train features for class dowel:  35%|███▍      | 100/288 [02:38<04:32,  1.45s/it]Extracting train features for class dowel:  35%|███▌      | 101/288 [02:40<04:41,  1.51s/it]Extracting train features for class dowel:  35%|███▌      | 102/288 [02:41<04:39,  1.50s/it]Extracting train features for class dowel:  36%|███▌      | 103/288 [02:43<04:29,  1.45s/it]Extracting train features for class dowel:  36%|███▌      | 104/288 [02:45<04:41,  1.53s/it]Extracting train features for class dowel:  36%|███▋      | 105/288 [02:46<04:28,  1.47s/it]Extracting train features for class dowel:  37%|███▋      | 106/288 [02:47<04:28,  1.47s/it]Extracting train features for class dowel:  37%|███▋      | 107/288 [02:49<04:35,  1.52s/it]Extracting train features for class dowel:  38%|███▊      | 108/288 [02:50<04:22,  1.46s/it]Extracting train features for class dowel:  38%|███▊      | 109/288 [02:52<04:31,  1.51s/it]Extracting train features for class dowel:  38%|███▊      | 110/288 [02:53<04:19,  1.46s/it]Extracting train features for class dowel:  39%|███▊      | 111/288 [02:55<04:17,  1.46s/it]Extracting train features for class dowel:  39%|███▉      | 112/288 [02:56<04:26,  1.51s/it]Extracting train features for class dowel:  39%|███▉      | 113/288 [02:58<04:15,  1.46s/it]Extracting train features for class dowel:  40%|███▉      | 114/288 [02:59<04:23,  1.52s/it]Extracting train features for class dowel:  40%|███▉      | 115/288 [03:01<04:12,  1.46s/it]Extracting train features for class dowel:  40%|████      | 116/288 [03:02<04:05,  1.43s/it]Extracting train features for class dowel:  41%|████      | 117/288 [03:04<04:13,  1.48s/it]Extracting train features for class dowel:  41%|████      | 118/288 [03:05<04:04,  1.44s/it]Extracting train features for class dowel:  41%|████▏     | 119/288 [03:07<04:11,  1.49s/it]Extracting train features for class dowel:  42%|████▏     | 120/288 [03:08<04:04,  1.46s/it]Extracting train features for class dowel:  42%|████▏     | 121/288 [03:09<03:59,  1.43s/it]Extracting train features for class dowel:  42%|████▏     | 122/288 [03:11<04:07,  1.49s/it]Extracting train features for class dowel:  43%|████▎     | 123/288 [03:12<03:58,  1.44s/it]Extracting train features for class dowel:  43%|████▎     | 124/288 [03:14<04:06,  1.50s/it]Extracting train features for class dowel:  43%|████▎     | 125/288 [03:15<04:02,  1.49s/it]Extracting train features for class dowel:  44%|████▍     | 126/288 [03:17<03:54,  1.45s/it]Extracting train features for class dowel:  44%|████▍     | 127/288 [03:18<04:00,  1.49s/it]Extracting train features for class dowel:  44%|████▍     | 128/288 [03:20<03:50,  1.44s/it]Extracting train features for class dowel:  45%|████▍     | 129/288 [03:21<03:57,  1.49s/it]Extracting train features for class dowel:  45%|████▌     | 130/288 [03:23<03:51,  1.47s/it]Extracting train features for class dowel:  45%|████▌     | 131/288 [03:24<03:44,  1.43s/it]Extracting train features for class dowel:  46%|████▌     | 132/288 [03:26<03:51,  1.48s/it]Extracting train features for class dowel:  46%|████▌     | 133/288 [03:27<03:42,  1.44s/it]Extracting train features for class dowel:  47%|████▋     | 134/288 [03:29<03:48,  1.49s/it]Extracting train features for class dowel:  47%|████▋     | 135/288 [03:30<03:41,  1.45s/it]Extracting train features for class dowel:  47%|████▋     | 136/288 [03:31<03:36,  1.43s/it]Extracting train features for class dowel:  48%|████▊     | 137/288 [03:33<03:44,  1.48s/it]Extracting train features for class dowel:  48%|████▊     | 138/288 [03:34<03:35,  1.44s/it]Extracting train features for class dowel:  48%|████▊     | 139/288 [03:36<03:40,  1.48s/it]Extracting train features for class dowel:  49%|████▊     | 140/288 [03:37<03:42,  1.50s/it]Extracting train features for class dowel:  49%|████▉     | 141/288 [03:39<03:34,  1.46s/it]Extracting train features for class dowel:  49%|████▉     | 142/288 [03:40<03:40,  1.51s/it]Extracting train features for class dowel:  50%|████▉     | 143/288 [03:42<03:31,  1.46s/it]Extracting train features for class dowel:  50%|█████     | 144/288 [03:43<03:29,  1.46s/it]Extracting train features for class dowel:  50%|█████     | 145/288 [03:45<03:35,  1.51s/it]Extracting train features for class dowel:  51%|█████     | 146/288 [03:46<03:28,  1.47s/it]Extracting train features for class dowel:  51%|█████     | 147/288 [03:48<03:32,  1.51s/it]Extracting train features for class dowel:  51%|█████▏    | 148/288 [03:49<03:23,  1.45s/it]Extracting train features for class dowel:  52%|█████▏    | 149/288 [03:50<03:18,  1.43s/it]Extracting train features for class dowel:  52%|█████▏    | 150/288 [03:52<03:24,  1.48s/it]Extracting train features for class dowel:  52%|█████▏    | 151/288 [03:53<03:18,  1.45s/it]Extracting train features for class dowel:  53%|█████▎    | 152/288 [03:55<03:24,  1.50s/it]Extracting train features for class dowel:  53%|█████▎    | 153/288 [03:56<03:15,  1.45s/it]Extracting train features for class dowel:  53%|█████▎    | 154/288 [03:58<03:13,  1.45s/it]Extracting train features for class dowel:  54%|█████▍    | 155/288 [03:59<03:19,  1.50s/it]Extracting train features for class dowel:  54%|█████▍    | 156/288 [04:01<03:12,  1.46s/it]Extracting train features for class dowel:  55%|█████▍    | 157/288 [04:02<03:17,  1.51s/it]Extracting train features for class dowel:  55%|█████▍    | 158/288 [04:04<03:09,  1.46s/it]Extracting train features for class dowel:  55%|█████▌    | 159/288 [04:05<03:06,  1.45s/it]Extracting train features for class dowel:  56%|█████▌    | 160/288 [04:07<03:11,  1.50s/it]Extracting train features for class dowel:  56%|█████▌    | 161/288 [04:08<03:05,  1.46s/it]Extracting train features for class dowel:  56%|█████▋    | 162/288 [04:10<03:09,  1.50s/it]Extracting train features for class dowel:  57%|█████▋    | 163/288 [04:11<03:00,  1.45s/it]Extracting train features for class dowel:  57%|█████▋    | 164/288 [04:13<02:59,  1.45s/it]Extracting train features for class dowel:  57%|█████▋    | 165/288 [04:14<03:04,  1.50s/it]Extracting train features for class dowel:  58%|█████▊    | 166/288 [04:16<02:58,  1.46s/it]Extracting train features for class dowel:  58%|█████▊    | 167/288 [04:17<03:02,  1.51s/it]Extracting train features for class dowel:  58%|█████▊    | 168/288 [04:18<02:54,  1.45s/it]Extracting train features for class dowel:  59%|█████▊    | 169/288 [04:20<02:50,  1.43s/it]Extracting train features for class dowel:  59%|█████▉    | 170/288 [04:21<02:55,  1.49s/it]Extracting train features for class dowel:  59%|█████▉    | 171/288 [04:23<02:49,  1.45s/it]Extracting train features for class dowel:  60%|█████▉    | 172/288 [04:24<02:53,  1.50s/it]Extracting train features for class dowel:  60%|██████    | 173/288 [04:26<02:47,  1.46s/it]Extracting train features for class dowel:  60%|██████    | 174/288 [04:27<02:41,  1.42s/it]Extracting train features for class dowel:  61%|██████    | 175/288 [04:29<02:49,  1.50s/it]Extracting train features for class dowel:  61%|██████    | 176/288 [04:30<02:43,  1.46s/it]Extracting train features for class dowel:  61%|██████▏   | 177/288 [04:32<02:47,  1.51s/it]Extracting train features for class dowel:  62%|██████▏   | 178/288 [04:33<02:47,  1.52s/it]Extracting train features for class dowel:  62%|██████▏   | 179/288 [04:35<02:39,  1.46s/it]Extracting train features for class dowel:  62%|██████▎   | 180/288 [04:36<02:44,  1.52s/it]Extracting train features for class dowel:  63%|██████▎   | 181/288 [04:38<02:38,  1.48s/it]Extracting train features for class dowel:  63%|██████▎   | 182/288 [04:39<02:39,  1.50s/it]Extracting train features for class dowel:  64%|██████▎   | 183/288 [04:41<02:40,  1.53s/it]Extracting train features for class dowel:  64%|██████▍   | 184/288 [04:42<02:33,  1.47s/it]Extracting train features for class dowel:  64%|██████▍   | 185/288 [04:44<02:37,  1.53s/it]Extracting train features for class dowel:  65%|██████▍   | 186/288 [04:45<02:31,  1.48s/it]Extracting train features for class dowel:  65%|██████▍   | 187/288 [04:47<02:29,  1.48s/it]Extracting train features for class dowel:  65%|██████▌   | 188/288 [04:48<02:32,  1.53s/it]Extracting train features for class dowel:  66%|██████▌   | 189/288 [04:50<02:25,  1.47s/it]Extracting train features for class dowel:  66%|██████▌   | 190/288 [04:51<02:28,  1.52s/it]Extracting train features for class dowel:  66%|██████▋   | 191/288 [04:53<02:22,  1.47s/it]Extracting train features for class dowel:  67%|██████▋   | 192/288 [04:54<02:21,  1.48s/it]Extracting train features for class dowel:  67%|██████▋   | 193/288 [04:56<02:24,  1.52s/it]Extracting train features for class dowel:  67%|██████▋   | 194/288 [04:57<02:17,  1.46s/it]Extracting train features for class dowel:  68%|██████▊   | 195/288 [04:59<02:21,  1.52s/it]Extracting train features for class dowel:  68%|██████▊   | 196/288 [05:00<02:14,  1.46s/it]Extracting train features for class dowel:  68%|██████▊   | 197/288 [05:01<02:10,  1.43s/it]Extracting train features for class dowel:  69%|██████▉   | 198/288 [05:03<02:15,  1.50s/it]Extracting train features for class dowel:  69%|██████▉   | 199/288 [05:04<02:08,  1.45s/it]Extracting train features for class dowel:  69%|██████▉   | 200/288 [05:06<02:12,  1.51s/it]Extracting train features for class dowel:  70%|██████▉   | 201/288 [05:07<02:06,  1.45s/it]Extracting train features for class dowel:  70%|███████   | 202/288 [05:09<02:03,  1.44s/it]Extracting train features for class dowel:  70%|███████   | 203/288 [05:11<02:11,  1.55s/it]Extracting train features for class dowel:  71%|███████   | 204/288 [05:12<02:05,  1.49s/it]Extracting train features for class dowel:  71%|███████   | 205/288 [05:14<02:09,  1.56s/it]Extracting train features for class dowel:  72%|███████▏  | 206/288 [05:16<02:14,  1.64s/it]Extracting train features for class dowel:  72%|███████▏  | 207/288 [05:17<02:04,  1.54s/it]Extracting train features for class dowel:  72%|███████▏  | 208/288 [05:19<02:08,  1.61s/it]Extracting train features for class dowel:  73%|███████▎  | 209/288 [05:20<02:04,  1.58s/it]Extracting train features for class dowel:  73%|███████▎  | 210/288 [05:21<01:56,  1.50s/it]Extracting train features for class dowel:  73%|███████▎  | 211/288 [05:23<01:59,  1.56s/it]Extracting train features for class dowel:  74%|███████▎  | 212/288 [05:24<01:53,  1.49s/it]Extracting train features for class dowel:  74%|███████▍  | 213/288 [05:26<01:50,  1.47s/it]Extracting train features for class dowel:  74%|███████▍  | 214/288 [05:28<01:55,  1.57s/it]Extracting train features for class dowel:  75%|███████▍  | 215/288 [05:29<01:49,  1.49s/it]Extracting train features for class dowel:  75%|███████▌  | 216/288 [05:31<01:52,  1.57s/it]Extracting train features for class dowel:  75%|███████▌  | 217/288 [05:32<01:50,  1.56s/it]Extracting train features for class dowel:  76%|███████▌  | 218/288 [05:34<01:44,  1.49s/it]Extracting train features for class dowel:  76%|███████▌  | 219/288 [05:35<01:46,  1.55s/it]Extracting train features for class dowel:  76%|███████▋  | 220/288 [05:37<01:41,  1.49s/it]Extracting train features for class dowel:  77%|███████▋  | 221/288 [05:38<01:38,  1.46s/it]Extracting train features for class dowel:  77%|███████▋  | 222/288 [05:40<01:43,  1.56s/it]Extracting train features for class dowel:  77%|███████▋  | 223/288 [05:41<01:37,  1.50s/it]Extracting train features for class dowel:  78%|███████▊  | 224/288 [05:43<01:40,  1.57s/it]Extracting train features for class dowel:  78%|███████▊  | 225/288 [05:45<01:39,  1.59s/it]Extracting train features for class dowel:  78%|███████▊  | 226/288 [05:46<01:33,  1.51s/it]Extracting train features for class dowel:  79%|███████▉  | 227/288 [05:48<01:35,  1.57s/it]Extracting train features for class dowel:  79%|███████▉  | 228/288 [05:49<01:30,  1.50s/it]Extracting train features for class dowel:  80%|███████▉  | 229/288 [05:50<01:26,  1.47s/it]Extracting train features for class dowel:  80%|███████▉  | 230/288 [05:52<01:30,  1.57s/it]Extracting train features for class dowel:  80%|████████  | 231/288 [05:53<01:25,  1.50s/it]Extracting train features for class dowel:  81%|████████  | 232/288 [05:55<01:25,  1.53s/it]Extracting train features for class dowel:  81%|████████  | 233/288 [05:57<01:27,  1.60s/it]Extracting train features for class dowel:  81%|████████▏ | 234/288 [05:58<01:22,  1.52s/it]Extracting train features for class dowel:  82%|████████▏ | 235/288 [06:00<01:23,  1.58s/it]Extracting train features for class dowel:  82%|████████▏ | 236/288 [06:02<01:23,  1.60s/it]Extracting train features for class dowel:  82%|████████▏ | 237/288 [06:03<01:17,  1.53s/it]Extracting train features for class dowel:  83%|████████▎ | 238/288 [06:05<01:18,  1.56s/it]Extracting train features for class dowel:  83%|████████▎ | 239/288 [06:06<01:13,  1.50s/it]Extracting train features for class dowel:  83%|████████▎ | 240/288 [06:07<01:09,  1.45s/it]Extracting train features for class dowel:  84%|████████▎ | 241/288 [06:09<01:11,  1.53s/it]Extracting train features for class dowel:  84%|████████▍ | 242/288 [06:10<01:07,  1.47s/it]Extracting train features for class dowel:  84%|████████▍ | 243/288 [06:12<01:08,  1.51s/it]Extracting train features for class dowel:  85%|████████▍ | 244/288 [06:14<01:08,  1.55s/it]Extracting train features for class dowel:  85%|████████▌ | 245/288 [06:15<01:03,  1.49s/it]Extracting train features for class dowel:  85%|████████▌ | 246/288 [06:17<01:04,  1.54s/it]Extracting train features for class dowel:  86%|████████▌ | 247/288 [06:18<01:00,  1.48s/it]Extracting train features for class dowel:  86%|████████▌ | 248/288 [06:19<00:57,  1.44s/it]Extracting train features for class dowel:  86%|████████▋ | 249/288 [06:21<00:59,  1.53s/it]Extracting train features for class dowel:  87%|████████▋ | 250/288 [06:22<00:56,  1.48s/it]Extracting train features for class dowel:  87%|████████▋ | 251/288 [06:24<00:56,  1.52s/it]Extracting train features for class dowel:  88%|████████▊ | 252/288 [06:25<00:53,  1.49s/it]Extracting train features for class dowel:  88%|████████▊ | 253/288 [06:27<00:50,  1.45s/it]Extracting train features for class dowel:  88%|████████▊ | 254/288 [06:28<00:51,  1.50s/it]Extracting train features for class dowel:  89%|████████▊ | 255/288 [06:30<00:48,  1.47s/it]Extracting train features for class dowel:  89%|████████▉ | 256/288 [06:31<00:46,  1.44s/it]Extracting train features for class dowel:  89%|████████▉ | 257/288 [06:33<00:46,  1.50s/it]Extracting train features for class dowel:  90%|████████▉ | 258/288 [06:34<00:43,  1.46s/it]Extracting train features for class dowel:  90%|████████▉ | 259/288 [06:35<00:41,  1.43s/it]Extracting train features for class dowel:  90%|█████████ | 260/288 [06:37<00:43,  1.56s/it]Extracting train features for class dowel:  91%|█████████ | 261/288 [06:39<00:40,  1.52s/it]Extracting train features for class dowel:  91%|█████████ | 262/288 [06:40<00:41,  1.59s/it]Extracting train features for class dowel:  91%|█████████▏| 263/288 [06:42<00:41,  1.64s/it]Extracting train features for class dowel:  92%|█████████▏| 264/288 [06:44<00:37,  1.56s/it]Extracting train features for class dowel:  92%|█████████▏| 265/288 [06:46<00:38,  1.68s/it]Extracting train features for class dowel:  92%|█████████▏| 266/288 [06:47<00:34,  1.58s/it]Extracting train features for class dowel:  93%|█████████▎| 267/288 [06:49<00:35,  1.68s/it]Extracting train features for class dowel:  93%|█████████▎| 268/288 [06:50<00:32,  1.61s/it]Extracting train features for class dowel:  93%|█████████▎| 269/288 [06:52<00:31,  1.66s/it]Extracting train features for class dowel:  94%|█████████▍| 270/288 [06:54<00:30,  1.72s/it]Extracting train features for class dowel:  94%|█████████▍| 271/288 [06:55<00:27,  1.62s/it]Extracting train features for class dowel:  94%|█████████▍| 272/288 [06:57<00:27,  1.72s/it]Extracting train features for class dowel:  95%|█████████▍| 273/288 [06:59<00:24,  1.61s/it]Extracting train features for class dowel:  95%|█████████▌| 274/288 [07:01<00:23,  1.70s/it]Extracting train features for class dowel:  95%|█████████▌| 275/288 [07:02<00:20,  1.59s/it]Extracting train features for class dowel:  96%|█████████▌| 276/288 [07:04<00:20,  1.69s/it]Extracting train features for class dowel:  96%|█████████▌| 277/288 [07:05<00:17,  1.60s/it]Extracting train features for class dowel:  97%|█████████▋| 278/288 [07:07<00:16,  1.66s/it]Extracting train features for class dowel:  97%|█████████▋| 279/288 [07:09<00:15,  1.71s/it]Extracting train features for class dowel:  97%|█████████▋| 280/288 [07:10<00:12,  1.60s/it]Extracting train features for class dowel:  98%|█████████▊| 281/288 [07:12<00:11,  1.70s/it]Extracting train features for class dowel:  98%|█████████▊| 282/288 [07:13<00:09,  1.59s/it]Extracting train features for class dowel:  98%|█████████▊| 283/288 [07:15<00:08,  1.69s/it]Extracting train features for class dowel:  99%|█████████▊| 284/288 [07:17<00:06,  1.62s/it]Extracting train features for class dowel:  99%|█████████▉| 285/288 [07:19<00:04,  1.66s/it]Extracting train features for class dowel:  99%|█████████▉| 286/288 [07:20<00:03,  1.70s/it]Extracting train features for class dowel: 100%|█████████▉| 287/288 [07:22<00:01,  1.60s/it]Extracting train features for class dowel: 100%|██████████| 288/288 [07:24<00:00,  1.70s/it]Extracting train features for class dowel: 100%|██████████| 288/288 [07:24<00:00,  1.54s/it]


Running coreset for Fusion on class dowel...
Traceback (most recent call last):
  File "main.py", line 99, in <module>
    run_3d_ads(args)
  File "main.py", line 31, in run_3d_ads
    model.fit(cls)
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/m3dm_runner.py", line 60, in fit
    method.run_coreset()
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/feature_extractors/features_dino_fusion.py", line 174, in run_coreset
    self.coreset_idx = get_coreset_idx_randomp(self.patch_lib,
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/utils/utils.py", line 48, in get_coreset_idx_randomp
    z_lib = torch.tensor(transformer.fit_transform(z_lib))
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/random_projection.py", line 359, in fit
    X = self._validate_data(
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
  File "/usr/local/python38/lib/python3.8/site-packages/torch/_tensor.py", line 645, in __array__
    return self.numpy().astype(dtype, copy=False)
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
/usr/local/python38/lib/python3.8/site-packages/torch/utils/cpp_extension.py:284: UserWarning: 

                               !! WARNING !!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Your compiler (c++) is not compatible with the compiler Pytorch was
built with for this platform, which is g++ on linux. Please
use g++ to to compile your extension. Alternatively, you may
compile PyTorch from source using c++, and then you can also use
c++ to compile your extension.

See https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md for help
with compiling PyTorch from source.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

                              !! WARNING !!

  warnings.warn(WRONG_COMPILER_WARNING.format(
unexpected_keys
['mask_token', 'decoder_pos_embed.0.weight', 'decoder_pos_embed.0.bias', 'decoder_pos_embed.2.weight', 'decoder_pos_embed.2.bias', 'MAE_decoder.blocks.0.norm1.weight', 'MAE_decoder.blocks.0.norm1.bias', 'MAE_decoder.blocks.0.norm2.weight', 'MAE_decoder.blocks.0.norm2.bias', 'MAE_decoder.blocks.0.mlp.fc1.weight', 'MAE_decoder.blocks.0.mlp.fc1.bias', 'MAE_decoder.blocks.0.mlp.fc2.weight', 'MAE_decoder.blocks.0.mlp.fc2.bias', 'MAE_decoder.blocks.0.attn.qkv.weight', 'MAE_decoder.blocks.0.attn.proj.weight', 'MAE_decoder.blocks.0.attn.proj.bias', 'MAE_decoder.blocks.1.norm1.weight', 'MAE_decoder.blocks.1.norm1.bias', 'MAE_decoder.blocks.1.norm2.weight', 'MAE_decoder.blocks.1.norm2.bias', 'MAE_decoder.blocks.1.mlp.fc1.weight', 'MAE_decoder.blocks.1.mlp.fc1.bias', 'MAE_decoder.blocks.1.mlp.fc2.weight', 'MAE_decoder.blocks.1.mlp.fc2.bias', 'MAE_decoder.blocks.1.attn.qkv.weight', 'MAE_decoder.blocks.1.attn.proj.weight', 'MAE_decoder.blocks.1.attn.proj.bias', 'MAE_decoder.blocks.2.norm1.weight', 'MAE_decoder.blocks.2.norm1.bias', 'MAE_decoder.blocks.2.norm2.weight', 'MAE_decoder.blocks.2.norm2.bias', 'MAE_decoder.blocks.2.mlp.fc1.weight', 'MAE_decoder.blocks.2.mlp.fc1.bias', 'MAE_decoder.blocks.2.mlp.fc2.weight', 'MAE_decoder.blocks.2.mlp.fc2.bias', 'MAE_decoder.blocks.2.attn.qkv.weight', 'MAE_decoder.blocks.2.attn.proj.weight', 'MAE_decoder.blocks.2.attn.proj.bias', 'MAE_decoder.blocks.3.norm1.weight', 'MAE_decoder.blocks.3.norm1.bias', 'MAE_decoder.blocks.3.norm2.weight', 'MAE_decoder.blocks.3.norm2.bias', 'MAE_decoder.blocks.3.mlp.fc1.weight', 'MAE_decoder.blocks.3.mlp.fc1.bias', 'MAE_decoder.blocks.3.mlp.fc2.weight', 'MAE_decoder.blocks.3.mlp.fc2.bias', 'MAE_decoder.blocks.3.attn.qkv.weight', 'MAE_decoder.blocks.3.attn.proj.weight', 'MAE_decoder.blocks.3.attn.proj.bias', 'MAE_decoder.norm.weight', 'MAE_decoder.norm.bias', 'increase_dim.0.weight', 'increase_dim.0.bias']
[Transformer] Successful Loading the ckpt from checkpoints/pointmae_pretrain.pth
point: <All keys matched successfully>
7fusion_block: <All keys matched successfully>
Extracting train features for class foam:   0%|          | 0/236 [00:00<?, ?it/s]Extracting train features for class foam:   0%|          | 1/236 [00:03<13:01,  3.33s/it]Extracting train features for class foam:   1%|          | 2/236 [00:05<10:21,  2.66s/it]Extracting train features for class foam:   1%|▏         | 3/236 [00:07<09:40,  2.49s/it]Extracting train features for class foam:   2%|▏         | 4/236 [00:10<10:19,  2.67s/it]Extracting train features for class foam:   2%|▏         | 5/236 [00:13<10:46,  2.80s/it]Extracting train features for class foam:   3%|▎         | 6/236 [00:16<11:06,  2.90s/it]Extracting train features for class foam:   3%|▎         | 7/236 [00:19<11:13,  2.94s/it]Extracting train features for class foam:   3%|▎         | 8/236 [00:22<11:08,  2.93s/it]Extracting train features for class foam:   4%|▍         | 9/236 [00:25<10:26,  2.76s/it]Extracting train features for class foam:   4%|▍         | 10/236 [00:27<09:34,  2.54s/it]Extracting train features for class foam:   5%|▍         | 11/236 [00:29<09:42,  2.59s/it]Extracting train features for class foam:   5%|▌         | 12/236 [00:33<10:13,  2.74s/it]Extracting train features for class foam:   6%|▌         | 13/236 [00:36<10:39,  2.87s/it]Extracting train features for class foam:   6%|▌         | 14/236 [00:39<10:41,  2.89s/it]Extracting train features for class foam:   6%|▋         | 15/236 [00:42<10:40,  2.90s/it]Extracting train features for class foam:   7%|▋         | 16/236 [00:44<10:15,  2.80s/it]Extracting train features for class foam:   7%|▋         | 17/236 [00:46<09:20,  2.56s/it]Extracting train features for class foam:   8%|▊         | 18/236 [00:49<09:33,  2.63s/it]Extracting train features for class foam:   8%|▊         | 19/236 [00:52<09:51,  2.73s/it]Extracting train features for class foam:   8%|▊         | 20/236 [00:55<10:22,  2.88s/it]Extracting train features for class foam:   9%|▉         | 21/236 [00:59<10:56,  3.05s/it]Extracting train features for class foam:   9%|▉         | 22/236 [01:02<11:10,  3.14s/it]Extracting train features for class foam:  10%|▉         | 23/236 [01:05<11:08,  3.14s/it]Extracting train features for class foam:  10%|█         | 24/236 [01:09<11:30,  3.26s/it]Extracting train features for class foam:  11%|█         | 25/236 [01:12<11:55,  3.39s/it]Extracting train features for class foam:  11%|█         | 26/236 [01:16<12:22,  3.54s/it]Extracting train features for class foam:  11%|█▏        | 27/236 [01:20<12:30,  3.59s/it]Extracting train features for class foam:  12%|█▏        | 28/236 [01:23<12:21,  3.57s/it]Extracting train features for class foam:  12%|█▏        | 29/236 [01:26<11:50,  3.43s/it]Extracting train features for class foam:  13%|█▎        | 30/236 [01:30<11:26,  3.33s/it]Extracting train features for class foam:  13%|█▎        | 31/236 [01:32<10:48,  3.16s/it]Extracting train features for class foam:  14%|█▎        | 32/236 [01:34<09:33,  2.81s/it]Extracting train features for class foam:  14%|█▍        | 33/236 [01:37<09:13,  2.73s/it]Extracting train features for class foam:  14%|█▍        | 34/236 [01:40<09:28,  2.81s/it]Extracting train features for class foam:  15%|█▍        | 35/236 [01:43<09:38,  2.88s/it]Extracting train features for class foam:  15%|█▌        | 36/236 [01:46<09:54,  2.97s/it]Extracting train features for class foam:  16%|█▌        | 37/236 [01:49<09:53,  2.98s/it]Extracting train features for class foam:  16%|█▌        | 38/236 [01:52<09:49,  2.97s/it]Extracting train features for class foam:  17%|█▋        | 39/236 [01:55<09:36,  2.93s/it]Extracting train features for class foam:  17%|█▋        | 40/236 [01:57<08:39,  2.65s/it]Extracting train features for class foam:  17%|█▋        | 41/236 [01:59<08:25,  2.59s/it]Extracting train features for class foam:  18%|█▊        | 42/236 [02:02<08:48,  2.72s/it]Extracting train features for class foam:  18%|█▊        | 43/236 [02:06<09:16,  2.88s/it]Extracting train features for class foam:  19%|█▊        | 44/236 [02:09<09:22,  2.93s/it]Extracting train features for class foam:  19%|█▉        | 45/236 [02:12<09:37,  3.02s/it]Extracting train features for class foam:  19%|█▉        | 46/236 [02:15<09:53,  3.12s/it]Extracting train features for class foam:  20%|█▉        | 47/236 [02:18<09:53,  3.14s/it]Extracting train features for class foam:  20%|██        | 48/236 [02:21<09:28,  3.02s/it]Extracting train features for class foam:  21%|██        | 49/236 [02:23<08:29,  2.73s/it]Extracting train features for class foam:  21%|██        | 50/236 [02:26<08:17,  2.68s/it]Extracting train features for class foam:  22%|██▏       | 51/236 [02:29<08:42,  2.82s/it]Extracting train features for class foam:  22%|██▏       | 52/236 [02:32<09:10,  2.99s/it]Extracting train features for class foam:  22%|██▏       | 53/236 [02:36<09:16,  3.04s/it]Extracting train features for class foam:  23%|██▎       | 54/236 [02:39<09:32,  3.14s/it]Extracting train features for class foam:  23%|██▎       | 55/236 [02:42<09:50,  3.26s/it]Extracting train features for class foam:  24%|██▎       | 56/236 [02:45<09:25,  3.14s/it]Extracting train features for class foam:  24%|██▍       | 57/236 [02:48<08:51,  2.97s/it]Extracting train features for class foam:  25%|██▍       | 58/236 [02:50<08:28,  2.86s/it]Extracting train features for class foam:  25%|██▌       | 59/236 [02:53<08:13,  2.79s/it]Extracting train features for class foam:  25%|██▌       | 60/236 [02:56<07:57,  2.71s/it]Extracting train features for class foam:  26%|██▌       | 61/236 [02:58<07:48,  2.68s/it]Extracting train features for class foam:  26%|██▋       | 62/236 [03:01<07:48,  2.69s/it]Extracting train features for class foam:  27%|██▋       | 63/236 [03:03<07:26,  2.58s/it]Extracting train features for class foam:  27%|██▋       | 64/236 [03:05<06:52,  2.40s/it]Extracting train features for class foam:  28%|██▊       | 65/236 [03:08<06:54,  2.43s/it]Extracting train features for class foam:  28%|██▊       | 66/236 [03:11<07:24,  2.61s/it]Extracting train features for class foam:  28%|██▊       | 67/236 [03:14<07:36,  2.70s/it]Extracting train features for class foam:  29%|██▉       | 68/236 [03:17<08:04,  2.88s/it]Extracting train features for class foam:  29%|██▉       | 69/236 [03:20<08:13,  2.96s/it]Extracting train features for class foam:  30%|██▉       | 70/236 [03:23<08:12,  2.97s/it]Extracting train features for class foam:  30%|███       | 71/236 [03:26<08:02,  2.92s/it]Extracting train features for class foam:  31%|███       | 72/236 [03:28<07:21,  2.69s/it]Extracting train features for class foam:  31%|███       | 73/236 [03:30<06:51,  2.53s/it]Extracting train features for class foam:  31%|███▏      | 74/236 [03:33<06:58,  2.58s/it]Extracting train features for class foam:  32%|███▏      | 75/236 [03:36<07:09,  2.67s/it]Extracting train features for class foam:  32%|███▏      | 76/236 [03:39<07:27,  2.79s/it]Extracting train features for class foam:  33%|███▎      | 77/236 [03:42<07:37,  2.88s/it]Extracting train features for class foam:  33%|███▎      | 78/236 [03:45<07:47,  2.96s/it]Extracting train features for class foam:  33%|███▎      | 79/236 [03:48<07:43,  2.95s/it]Extracting train features for class foam:  34%|███▍      | 80/236 [03:51<07:34,  2.91s/it]Extracting train features for class foam:  34%|███▍      | 81/236 [03:54<07:20,  2.84s/it]Extracting train features for class foam:  35%|███▍      | 82/236 [03:56<07:11,  2.80s/it]Extracting train features for class foam:  35%|███▌      | 83/236 [03:59<06:57,  2.73s/it]Extracting train features for class foam:  36%|███▌      | 84/236 [04:01<06:33,  2.59s/it]Extracting train features for class foam:  36%|███▌      | 85/236 [04:03<06:03,  2.41s/it]Extracting train features for class foam:  36%|███▋      | 86/236 [04:06<06:10,  2.47s/it]Extracting train features for class foam:  37%|███▋      | 87/236 [04:09<06:28,  2.60s/it]Extracting train features for class foam:  37%|███▋      | 88/236 [04:11<06:38,  2.69s/it]Extracting train features for class foam:  38%|███▊      | 89/236 [04:14<06:21,  2.60s/it]Extracting train features for class foam:  38%|███▊      | 90/236 [04:16<05:53,  2.42s/it]Extracting train features for class foam:  39%|███▊      | 91/236 [04:18<05:51,  2.42s/it]Extracting train features for class foam:  39%|███▉      | 92/236 [04:21<06:14,  2.60s/it]Extracting train features for class foam:  39%|███▉      | 93/236 [04:24<06:28,  2.71s/it]Extracting train features for class foam:  40%|███▉      | 94/236 [04:27<06:26,  2.72s/it]Extracting train features for class foam:  40%|████      | 95/236 [04:29<05:58,  2.54s/it]Extracting train features for class foam:  41%|████      | 96/236 [04:31<05:38,  2.41s/it]Extracting train features for class foam:  41%|████      | 97/236 [04:34<05:45,  2.49s/it]Extracting train features for class foam:  42%|████▏     | 98/236 [04:37<06:00,  2.61s/it]Extracting train features for class foam:  42%|████▏     | 99/236 [04:39<05:45,  2.53s/it]Extracting train features for class foam:  42%|████▏     | 100/236 [04:41<05:25,  2.39s/it]Extracting train features for class foam:  43%|████▎     | 101/236 [04:44<05:19,  2.37s/it]Extracting train features for class foam:  43%|████▎     | 102/236 [04:46<05:34,  2.49s/it]Extracting train features for class foam:  44%|████▎     | 103/236 [04:49<05:32,  2.50s/it]Extracting train features for class foam:  44%|████▍     | 104/236 [04:51<05:09,  2.34s/it]Extracting train features for class foam:  44%|████▍     | 105/236 [04:53<04:57,  2.27s/it]Extracting train features for class foam:  45%|████▍     | 106/236 [04:56<05:10,  2.39s/it]Extracting train features for class foam:  45%|████▌     | 107/236 [04:58<05:17,  2.46s/it]Extracting train features for class foam:  46%|████▌     | 108/236 [05:01<05:16,  2.48s/it]Extracting train features for class foam:  46%|████▌     | 109/236 [05:03<04:57,  2.34s/it]Extracting train features for class foam:  47%|████▋     | 110/236 [05:05<04:55,  2.35s/it]Extracting train features for class foam:  47%|████▋     | 111/236 [05:08<05:11,  2.49s/it]Extracting train features for class foam:  47%|████▋     | 112/236 [05:11<05:28,  2.65s/it]Extracting train features for class foam:  48%|████▊     | 113/236 [05:13<05:19,  2.60s/it]Extracting train features for class foam:  48%|████▊     | 114/236 [05:15<04:55,  2.42s/it]Extracting train features for class foam:  49%|████▊     | 115/236 [05:18<04:57,  2.46s/it]Extracting train features for class foam:  49%|████▉     | 116/236 [05:21<05:14,  2.62s/it]Extracting train features for class foam:  50%|████▉     | 117/236 [05:24<05:23,  2.72s/it]Extracting train features for class foam:  50%|█████     | 118/236 [05:27<05:23,  2.74s/it]Extracting train features for class foam:  50%|█████     | 119/236 [05:29<05:00,  2.56s/it]Extracting train features for class foam:  51%|█████     | 120/236 [05:31<04:40,  2.41s/it]Extracting train features for class foam:  51%|█████▏    | 121/236 [05:34<04:51,  2.53s/it]Extracting train features for class foam:  52%|█████▏    | 122/236 [05:37<05:04,  2.67s/it]Extracting train features for class foam:  52%|█████▏    | 123/236 [05:40<05:15,  2.79s/it]Extracting train features for class foam:  53%|█████▎    | 124/236 [05:43<05:29,  2.94s/it]Extracting train features for class foam:  53%|█████▎    | 125/236 [05:46<05:25,  2.93s/it]Extracting train features for class foam:  53%|█████▎    | 126/236 [05:49<05:16,  2.88s/it]Extracting train features for class foam:  54%|█████▍    | 127/236 [05:51<04:51,  2.67s/it]Extracting train features for class foam:  54%|█████▍    | 128/236 [05:53<04:31,  2.51s/it]Extracting train features for class foam:  55%|█████▍    | 129/236 [05:56<04:37,  2.59s/it]Extracting train features for class foam:  55%|█████▌    | 130/236 [05:59<04:41,  2.65s/it]Extracting train features for class foam:  56%|█████▌    | 131/236 [06:02<04:56,  2.82s/it]Extracting train features for class foam:  56%|█████▌    | 132/236 [06:05<04:59,  2.88s/it]Extracting train features for class foam:  56%|█████▋    | 133/236 [06:08<04:53,  2.85s/it]Extracting train features for class foam:  57%|█████▋    | 134/236 [06:10<04:25,  2.61s/it]Extracting train features for class foam:  57%|█████▋    | 135/236 [06:12<04:15,  2.53s/it]Extracting train features for class foam:  58%|█████▊    | 136/236 [06:15<04:21,  2.61s/it]Extracting train features for class foam:  58%|█████▊    | 137/236 [06:18<04:32,  2.76s/it]Extracting train features for class foam:  58%|█████▊    | 138/236 [06:21<04:45,  2.92s/it]Extracting train features for class foam:  59%|█████▉    | 139/236 [06:24<04:46,  2.96s/it]Extracting train features for class foam:  59%|█████▉    | 140/236 [06:27<04:46,  2.98s/it]Extracting train features for class foam:  60%|█████▉    | 141/236 [06:30<04:31,  2.85s/it]Extracting train features for class foam:  60%|██████    | 142/236 [06:32<04:02,  2.58s/it]Extracting train features for class foam:  61%|██████    | 143/236 [06:34<03:54,  2.52s/it]Extracting train features for class foam:  61%|██████    | 144/236 [06:37<04:00,  2.61s/it]Extracting train features for class foam:  61%|██████▏   | 145/236 [06:40<04:05,  2.70s/it]Extracting train features for class foam:  62%|██████▏   | 146/236 [06:43<04:18,  2.88s/it]Extracting train features for class foam:  62%|██████▏   | 147/236 [06:46<04:23,  2.96s/it]Extracting train features for class foam:  63%|██████▎   | 148/236 [06:49<04:17,  2.93s/it]Extracting train features for class foam:  63%|██████▎   | 149/236 [06:52<04:06,  2.83s/it]Extracting train features for class foam:  64%|██████▎   | 150/236 [06:54<03:42,  2.58s/it]Extracting train features for class foam:  64%|██████▍   | 151/236 [06:56<03:36,  2.55s/it]Extracting train features for class foam:  64%|██████▍   | 152/236 [06:59<03:44,  2.68s/it]Extracting train features for class foam:  65%|██████▍   | 153/236 [07:02<03:45,  2.72s/it]Extracting train features for class foam:  65%|██████▌   | 154/236 [07:04<03:30,  2.57s/it]Extracting train features for class foam:  66%|██████▌   | 155/236 [07:06<03:14,  2.40s/it]Extracting train features for class foam:  66%|██████▌   | 156/236 [07:09<03:17,  2.47s/it]Extracting train features for class foam:  67%|██████▋   | 157/236 [07:12<03:29,  2.65s/it]Extracting train features for class foam:  67%|██████▋   | 158/236 [07:15<03:33,  2.74s/it]Extracting train features for class foam:  67%|██████▋   | 159/236 [07:18<03:35,  2.80s/it]Extracting train features for class foam:  68%|██████▊   | 160/236 [07:20<03:26,  2.72s/it]Extracting train features for class foam:  68%|██████▊   | 161/236 [07:22<03:07,  2.50s/it]Extracting train features for class foam:  69%|██████▊   | 162/236 [07:25<03:04,  2.50s/it]Extracting train features for class foam:  69%|██████▉   | 163/236 [07:28<03:09,  2.59s/it]Extracting train features for class foam:  69%|██████▉   | 164/236 [07:31<03:20,  2.79s/it]Extracting train features for class foam:  70%|██████▉   | 165/236 [07:34<03:24,  2.88s/it]Extracting train features for class foam:  70%|███████   | 166/236 [07:37<03:18,  2.84s/it]Extracting train features for class foam:  71%|███████   | 167/236 [07:39<03:05,  2.68s/it]Extracting train features for class foam:  71%|███████   | 168/236 [07:41<02:49,  2.49s/it]Extracting train features for class foam:  72%|███████▏  | 169/236 [07:44<02:44,  2.46s/it]Extracting train features for class foam:  72%|███████▏  | 170/236 [07:47<02:52,  2.61s/it]Extracting train features for class foam:  72%|███████▏  | 171/236 [07:50<02:56,  2.72s/it]Extracting train features for class foam:  73%|███████▎  | 172/236 [07:52<02:48,  2.64s/it]Extracting train features for class foam:  73%|███████▎  | 173/236 [07:54<02:34,  2.45s/it]Extracting train features for class foam:  74%|███████▎  | 174/236 [07:56<02:28,  2.40s/it]Extracting train features for class foam:  74%|███████▍  | 175/236 [07:59<02:35,  2.54s/it]Extracting train features for class foam:  75%|███████▍  | 176/236 [08:02<02:41,  2.69s/it]Extracting train features for class foam:  75%|███████▌  | 177/236 [08:05<02:35,  2.63s/it]Extracting train features for class foam:  75%|███████▌  | 178/236 [08:07<02:21,  2.44s/it]Extracting train features for class foam:  76%|███████▌  | 179/236 [08:09<02:18,  2.42s/it]Extracting train features for class foam:  76%|███████▋  | 180/236 [08:12<02:24,  2.58s/it]Extracting train features for class foam:  77%|███████▋  | 181/236 [08:15<02:27,  2.69s/it]Extracting train features for class foam:  77%|███████▋  | 182/236 [08:18<02:24,  2.68s/it]Extracting train features for class foam:  78%|███████▊  | 183/236 [08:20<02:12,  2.51s/it]Extracting train features for class foam:  78%|███████▊  | 184/236 [08:22<02:04,  2.39s/it]Extracting train features for class foam:  78%|███████▊  | 185/236 [08:24<02:03,  2.42s/it]Extracting train features for class foam:  79%|███████▉  | 186/236 [08:27<02:11,  2.62s/it]Extracting train features for class foam:  79%|███████▉  | 187/236 [08:30<02:12,  2.71s/it]Extracting train features for class foam:  80%|███████▉  | 188/236 [08:33<02:08,  2.67s/it]Extracting train features for class foam:  80%|████████  | 189/236 [08:35<01:56,  2.48s/it]Extracting train features for class foam:  81%|████████  | 190/236 [08:37<01:54,  2.49s/it]Extracting train features for class foam:  81%|████████  | 191/236 [08:40<01:57,  2.62s/it]Extracting train features for class foam:  81%|████████▏ | 192/236 [08:44<02:01,  2.77s/it]Extracting train features for class foam:  82%|████████▏ | 193/236 [08:47<02:03,  2.86s/it]Extracting train features for class foam:  82%|████████▏ | 194/236 [08:50<02:03,  2.93s/it]Extracting train features for class foam:  83%|████████▎ | 195/236 [08:53<02:02,  2.98s/it]Extracting train features for class foam:  83%|████████▎ | 196/236 [08:56<01:56,  2.91s/it]Extracting train features for class foam:  83%|████████▎ | 197/236 [08:58<01:48,  2.79s/it]Extracting train features for class foam:  84%|████████▍ | 198/236 [09:00<01:37,  2.56s/it]Extracting train features for class foam:  84%|████████▍ | 199/236 [09:03<01:35,  2.57s/it]Extracting train features for class foam:  85%|████████▍ | 200/236 [09:06<01:36,  2.68s/it]Extracting train features for class foam:  85%|████████▌ | 201/236 [09:09<01:38,  2.83s/it]Extracting train features for class foam:  86%|████████▌ | 202/236 [09:12<01:39,  2.93s/it]Extracting train features for class foam:  86%|████████▌ | 203/236 [09:15<01:38,  2.97s/it]Extracting train features for class foam:  86%|████████▋ | 204/236 [09:18<01:35,  2.98s/it]Extracting train features for class foam:  87%|████████▋ | 205/236 [09:21<01:29,  2.88s/it]Extracting train features for class foam:  87%|████████▋ | 206/236 [09:23<01:19,  2.67s/it]Extracting train features for class foam:  88%|████████▊ | 207/236 [09:25<01:11,  2.46s/it]Extracting train features for class foam:  88%|████████▊ | 208/236 [09:27<01:09,  2.47s/it]Extracting train features for class foam:  89%|████████▊ | 209/236 [09:30<01:10,  2.61s/it]Extracting train features for class foam:  89%|████████▉ | 210/236 [09:33<01:12,  2.79s/it]Extracting train features for class foam:  89%|████████▉ | 211/236 [09:36<01:10,  2.84s/it]Extracting train features for class foam:  90%|████████▉ | 212/236 [09:39<01:06,  2.77s/it]Extracting train features for class foam:  90%|█████████ | 213/236 [09:41<00:59,  2.57s/it]Extracting train features for class foam:  91%|█████████ | 214/236 [09:43<00:54,  2.48s/it]Extracting train features for class foam:  91%|█████████ | 215/236 [09:46<00:54,  2.59s/it]Extracting train features for class foam:  92%|█████████▏| 216/236 [09:49<00:51,  2.60s/it]Extracting train features for class foam:  92%|█████████▏| 217/236 [09:51<00:47,  2.51s/it]Extracting train features for class foam:  92%|█████████▏| 218/236 [09:53<00:42,  2.36s/it]Extracting train features for class foam:  93%|█████████▎| 219/236 [09:55<00:38,  2.29s/it]Extracting train features for class foam:  93%|█████████▎| 220/236 [09:58<00:37,  2.35s/it]Extracting train features for class foam:  94%|█████████▎| 221/236 [10:01<00:38,  2.60s/it]Extracting train features for class foam:  94%|█████████▍| 222/236 [10:04<00:36,  2.62s/it]Extracting train features for class foam:  94%|█████████▍| 223/236 [10:06<00:34,  2.65s/it]Extracting train features for class foam:  95%|█████████▍| 224/236 [10:09<00:33,  2.77s/it]Extracting train features for class foam:  95%|█████████▌| 225/236 [10:13<00:32,  2.91s/it]Extracting train features for class foam:  96%|█████████▌| 226/236 [10:16<00:30,  3.08s/it]Extracting train features for class foam:  96%|█████████▌| 227/236 [10:20<00:29,  3.22s/it]Extracting train features for class foam:  97%|█████████▋| 228/236 [10:23<00:25,  3.21s/it]Extracting train features for class foam:  97%|█████████▋| 229/236 [10:26<00:22,  3.15s/it]Extracting train features for class foam:  97%|█████████▋| 230/236 [10:28<00:18,  3.01s/it]Extracting train features for class foam:  98%|█████████▊| 231/236 [10:31<00:14,  2.99s/it]Extracting train features for class foam:  98%|█████████▊| 232/236 [10:35<00:12,  3.07s/it]Extracting train features for class foam:  99%|█████████▊| 233/236 [10:38<00:09,  3.07s/it]Extracting train features for class foam:  99%|█████████▉| 234/236 [10:41<00:06,  3.05s/it]Extracting train features for class foam: 100%|█████████▉| 235/236 [10:43<00:02,  2.90s/it]Extracting train features for class foam: 100%|██████████| 236/236 [10:46<00:00,  2.85s/it]Extracting train features for class foam: 100%|██████████| 236/236 [10:46<00:00,  2.74s/it]


Running coreset for Fusion on class foam...
Traceback (most recent call last):
  File "main.py", line 99, in <module>
    run_3d_ads(args)
  File "main.py", line 31, in run_3d_ads
    model.fit(cls)
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/m3dm_runner.py", line 60, in fit
    method.run_coreset()
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/feature_extractors/features_dino_fusion.py", line 174, in run_coreset
    self.coreset_idx = get_coreset_idx_randomp(self.patch_lib,
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/utils/utils.py", line 48, in get_coreset_idx_randomp
    z_lib = torch.tensor(transformer.fit_transform(z_lib))
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/random_projection.py", line 359, in fit
    X = self._validate_data(
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
  File "/usr/local/python38/lib/python3.8/site-packages/torch/_tensor.py", line 645, in __array__
    return self.numpy().astype(dtype, copy=False)
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
/usr/local/python38/lib/python3.8/site-packages/torch/utils/cpp_extension.py:284: UserWarning: 

                               !! WARNING !!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Your compiler (c++) is not compatible with the compiler Pytorch was
built with for this platform, which is g++ on linux. Please
use g++ to to compile your extension. Alternatively, you may
compile PyTorch from source using c++, and then you can also use
c++ to compile your extension.

See https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md for help
with compiling PyTorch from source.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

                              !! WARNING !!

  warnings.warn(WRONG_COMPILER_WARNING.format(
unexpected_keys
['mask_token', 'decoder_pos_embed.0.weight', 'decoder_pos_embed.0.bias', 'decoder_pos_embed.2.weight', 'decoder_pos_embed.2.bias', 'MAE_decoder.blocks.0.norm1.weight', 'MAE_decoder.blocks.0.norm1.bias', 'MAE_decoder.blocks.0.norm2.weight', 'MAE_decoder.blocks.0.norm2.bias', 'MAE_decoder.blocks.0.mlp.fc1.weight', 'MAE_decoder.blocks.0.mlp.fc1.bias', 'MAE_decoder.blocks.0.mlp.fc2.weight', 'MAE_decoder.blocks.0.mlp.fc2.bias', 'MAE_decoder.blocks.0.attn.qkv.weight', 'MAE_decoder.blocks.0.attn.proj.weight', 'MAE_decoder.blocks.0.attn.proj.bias', 'MAE_decoder.blocks.1.norm1.weight', 'MAE_decoder.blocks.1.norm1.bias', 'MAE_decoder.blocks.1.norm2.weight', 'MAE_decoder.blocks.1.norm2.bias', 'MAE_decoder.blocks.1.mlp.fc1.weight', 'MAE_decoder.blocks.1.mlp.fc1.bias', 'MAE_decoder.blocks.1.mlp.fc2.weight', 'MAE_decoder.blocks.1.mlp.fc2.bias', 'MAE_decoder.blocks.1.attn.qkv.weight', 'MAE_decoder.blocks.1.attn.proj.weight', 'MAE_decoder.blocks.1.attn.proj.bias', 'MAE_decoder.blocks.2.norm1.weight', 'MAE_decoder.blocks.2.norm1.bias', 'MAE_decoder.blocks.2.norm2.weight', 'MAE_decoder.blocks.2.norm2.bias', 'MAE_decoder.blocks.2.mlp.fc1.weight', 'MAE_decoder.blocks.2.mlp.fc1.bias', 'MAE_decoder.blocks.2.mlp.fc2.weight', 'MAE_decoder.blocks.2.mlp.fc2.bias', 'MAE_decoder.blocks.2.attn.qkv.weight', 'MAE_decoder.blocks.2.attn.proj.weight', 'MAE_decoder.blocks.2.attn.proj.bias', 'MAE_decoder.blocks.3.norm1.weight', 'MAE_decoder.blocks.3.norm1.bias', 'MAE_decoder.blocks.3.norm2.weight', 'MAE_decoder.blocks.3.norm2.bias', 'MAE_decoder.blocks.3.mlp.fc1.weight', 'MAE_decoder.blocks.3.mlp.fc1.bias', 'MAE_decoder.blocks.3.mlp.fc2.weight', 'MAE_decoder.blocks.3.mlp.fc2.bias', 'MAE_decoder.blocks.3.attn.qkv.weight', 'MAE_decoder.blocks.3.attn.proj.weight', 'MAE_decoder.blocks.3.attn.proj.bias', 'MAE_decoder.norm.weight', 'MAE_decoder.norm.bias', 'increase_dim.0.weight', 'increase_dim.0.bias']
[Transformer] Successful Loading the ckpt from checkpoints/pointmae_pretrain.pth
point: <All keys matched successfully>
7fusion_block: <All keys matched successfully>
Extracting train features for class peach:   0%|          | 0/361 [00:00<?, ?it/s]Extracting train features for class peach:   0%|          | 1/361 [00:03<18:04,  3.01s/it]Extracting train features for class peach:   1%|          | 2/361 [00:06<17:59,  3.01s/it]Extracting train features for class peach:   1%|          | 3/361 [00:09<17:53,  3.00s/it]Extracting train features for class peach:   1%|          | 4/361 [00:11<17:36,  2.96s/it]Extracting train features for class peach:   1%|▏         | 5/361 [00:14<17:43,  2.99s/it]Extracting train features for class peach:   2%|▏         | 6/361 [00:18<17:57,  3.04s/it]Extracting train features for class peach:   2%|▏         | 7/361 [00:21<17:46,  3.01s/it]Extracting train features for class peach:   2%|▏         | 8/361 [00:23<16:48,  2.86s/it]Extracting train features for class peach:   2%|▏         | 9/361 [00:25<15:48,  2.69s/it]Extracting train features for class peach:   3%|▎         | 10/361 [00:28<15:09,  2.59s/it]Extracting train features for class peach:   3%|▎         | 11/361 [00:30<14:33,  2.50s/it]Extracting train features for class peach:   3%|▎         | 12/361 [00:32<14:01,  2.41s/it]Extracting train features for class peach:   4%|▎         | 13/361 [00:34<13:06,  2.26s/it]Extracting train features for class peach:   4%|▍         | 14/361 [00:36<12:15,  2.12s/it]Extracting train features for class peach:   4%|▍         | 15/361 [00:38<11:53,  2.06s/it]Extracting train features for class peach:   4%|▍         | 16/361 [00:40<11:49,  2.06s/it]Extracting train features for class peach:   5%|▍         | 17/361 [00:42<11:18,  1.97s/it]Extracting train features for class peach:   5%|▍         | 18/361 [00:43<10:54,  1.91s/it]Extracting train features for class peach:   5%|▌         | 19/361 [00:45<10:52,  1.91s/it]Extracting train features for class peach:   6%|▌         | 20/361 [00:47<11:06,  1.95s/it]Extracting train features for class peach:   6%|▌         | 21/361 [00:50<11:26,  2.02s/it]Extracting train features for class peach:   6%|▌         | 22/361 [00:52<11:46,  2.08s/it]Extracting train features for class peach:   6%|▋         | 23/361 [00:54<11:52,  2.11s/it]Extracting train features for class peach:   7%|▋         | 24/361 [00:56<11:46,  2.10s/it]Extracting train features for class peach:   7%|▋         | 25/361 [00:58<11:43,  2.09s/it]Extracting train features for class peach:   7%|▋         | 26/361 [01:00<11:27,  2.05s/it]Extracting train features for class peach:   7%|▋         | 27/361 [01:02<11:19,  2.03s/it]Extracting train features for class peach:   8%|▊         | 28/361 [01:04<10:53,  1.96s/it]Extracting train features for class peach:   8%|▊         | 29/361 [01:06<10:22,  1.88s/it]Extracting train features for class peach:   8%|▊         | 30/361 [01:08<10:36,  1.92s/it]Extracting train features for class peach:   9%|▊         | 31/361 [01:10<10:53,  1.98s/it]Extracting train features for class peach:   9%|▉         | 32/361 [01:12<11:37,  2.12s/it]Extracting train features for class peach:   9%|▉         | 33/361 [01:15<12:26,  2.28s/it]Extracting train features for class peach:   9%|▉         | 34/361 [01:17<12:33,  2.30s/it]Extracting train features for class peach:  10%|▉         | 35/361 [01:20<12:50,  2.36s/it]Extracting train features for class peach:  10%|▉         | 36/361 [01:22<12:47,  2.36s/it]Extracting train features for class peach:  10%|█         | 37/361 [01:24<11:51,  2.20s/it]Extracting train features for class peach:  11%|█         | 38/361 [01:26<11:07,  2.07s/it]Extracting train features for class peach:  11%|█         | 39/361 [01:28<11:32,  2.15s/it]Extracting train features for class peach:  11%|█         | 40/361 [01:30<12:03,  2.25s/it]Extracting train features for class peach:  11%|█▏        | 41/361 [01:33<12:13,  2.29s/it]Extracting train features for class peach:  12%|█▏        | 42/361 [01:35<12:17,  2.31s/it]Extracting train features for class peach:  12%|█▏        | 43/361 [01:37<11:03,  2.09s/it]Extracting train features for class peach:  12%|█▏        | 44/361 [01:39<10:30,  1.99s/it]Extracting train features for class peach:  12%|█▏        | 45/361 [01:41<11:13,  2.13s/it]Extracting train features for class peach:  13%|█▎        | 46/361 [01:44<11:53,  2.26s/it]Extracting train features for class peach:  13%|█▎        | 47/361 [01:45<11:21,  2.17s/it]Extracting train features for class peach:  13%|█▎        | 48/361 [01:47<10:21,  1.98s/it]Extracting train features for class peach:  14%|█▎        | 49/361 [01:49<10:20,  1.99s/it]Extracting train features for class peach:  14%|█▍        | 50/361 [01:51<10:36,  2.05s/it]Extracting train features for class peach:  14%|█▍        | 51/361 [01:53<10:00,  1.94s/it]Extracting train features for class peach:  14%|█▍        | 52/361 [01:55<09:33,  1.86s/it]Extracting train features for class peach:  15%|█▍        | 53/361 [01:57<10:29,  2.04s/it]Extracting train features for class peach:  15%|█▍        | 54/361 [02:00<11:27,  2.24s/it]Extracting train features for class peach:  15%|█▌        | 55/361 [02:02<12:06,  2.38s/it]Extracting train features for class peach:  16%|█▌        | 56/361 [02:05<12:44,  2.51s/it]Extracting train features for class peach:  16%|█▌        | 57/361 [02:08<13:00,  2.57s/it]Extracting train features for class peach:  16%|█▌        | 58/361 [02:10<12:48,  2.54s/it]Extracting train features for class peach:  16%|█▋        | 59/361 [02:12<11:40,  2.32s/it]Extracting train features for class peach:  17%|█▋        | 60/361 [02:14<10:37,  2.12s/it]Extracting train features for class peach:  17%|█▋        | 61/361 [02:16<10:50,  2.17s/it]Extracting train features for class peach:  17%|█▋        | 62/361 [02:19<11:20,  2.27s/it]Extracting train features for class peach:  17%|█▋        | 63/361 [02:22<12:04,  2.43s/it]Extracting train features for class peach:  18%|█▊        | 64/361 [02:24<12:27,  2.52s/it]Extracting train features for class peach:  18%|█▊        | 65/361 [02:27<12:20,  2.50s/it]Extracting train features for class peach:  18%|█▊        | 66/361 [02:29<11:49,  2.40s/it]Extracting train features for class peach:  19%|█▊        | 67/361 [02:31<11:45,  2.40s/it]Extracting train features for class peach:  19%|█▉        | 68/361 [02:33<11:09,  2.28s/it]Extracting train features for class peach:  19%|█▉        | 69/361 [02:35<10:21,  2.13s/it]Extracting train features for class peach:  19%|█▉        | 70/361 [02:37<10:14,  2.11s/it]Extracting train features for class peach:  20%|█▉        | 71/361 [02:39<10:32,  2.18s/it]Extracting train features for class peach:  20%|█▉        | 72/361 [02:42<10:35,  2.20s/it]Extracting train features for class peach:  20%|██        | 73/361 [02:44<10:14,  2.13s/it]Extracting train features for class peach:  20%|██        | 74/361 [02:45<09:45,  2.04s/it]Extracting train features for class peach:  21%|██        | 75/361 [02:48<09:41,  2.03s/it]Extracting train features for class peach:  21%|██        | 76/361 [02:50<10:19,  2.17s/it]Extracting train features for class peach:  21%|██▏       | 77/361 [02:53<11:03,  2.34s/it]Extracting train features for class peach:  22%|██▏       | 78/361 [02:55<11:28,  2.43s/it]Extracting train features for class peach:  22%|██▏       | 79/361 [02:58<11:33,  2.46s/it]Extracting train features for class peach:  22%|██▏       | 80/361 [03:00<11:25,  2.44s/it]Extracting train features for class peach:  22%|██▏       | 81/361 [03:03<11:11,  2.40s/it]Extracting train features for class peach:  23%|██▎       | 82/361 [03:05<10:49,  2.33s/it]Extracting train features for class peach:  23%|██▎       | 83/361 [03:07<10:10,  2.20s/it]Extracting train features for class peach:  23%|██▎       | 84/361 [03:08<09:35,  2.08s/it]Extracting train features for class peach:  24%|██▎       | 85/361 [03:10<09:21,  2.03s/it]Extracting train features for class peach:  24%|██▍       | 86/361 [03:13<09:28,  2.07s/it]Extracting train features for class peach:  24%|██▍       | 87/361 [03:15<09:24,  2.06s/it]Extracting train features for class peach:  24%|██▍       | 88/361 [03:16<09:03,  1.99s/it]Extracting train features for class peach:  25%|██▍       | 89/361 [03:18<09:08,  2.02s/it]Extracting train features for class peach:  25%|██▍       | 90/361 [03:21<09:49,  2.17s/it]Extracting train features for class peach:  25%|██▌       | 91/361 [03:24<10:32,  2.34s/it]Extracting train features for class peach:  25%|██▌       | 92/361 [03:26<10:46,  2.40s/it]Extracting train features for class peach:  26%|██▌       | 93/361 [03:29<11:16,  2.52s/it]Extracting train features for class peach:  26%|██▌       | 94/361 [03:32<11:21,  2.55s/it]Extracting train features for class peach:  26%|██▋       | 95/361 [03:35<11:44,  2.65s/it]Extracting train features for class peach:  27%|██▋       | 96/361 [03:38<12:03,  2.73s/it]Extracting train features for class peach:  27%|██▋       | 97/361 [03:40<11:49,  2.69s/it]Extracting train features for class peach:  27%|██▋       | 98/361 [03:43<12:05,  2.76s/it]Extracting train features for class peach:  27%|██▋       | 99/361 [03:46<12:15,  2.81s/it]Extracting train features for class peach:  28%|██▊       | 100/361 [03:49<12:24,  2.85s/it]Extracting train features for class peach:  28%|██▊       | 101/361 [03:52<12:02,  2.78s/it]Extracting train features for class peach:  28%|██▊       | 102/361 [03:54<12:04,  2.80s/it]Extracting train features for class peach:  29%|██▊       | 103/361 [03:57<11:44,  2.73s/it]Extracting train features for class peach:  29%|██▉       | 104/361 [04:00<11:34,  2.70s/it]Extracting train features for class peach:  29%|██▉       | 105/361 [04:02<11:10,  2.62s/it]Extracting train features for class peach:  29%|██▉       | 106/361 [04:04<10:58,  2.58s/it]Extracting train features for class peach:  30%|██▉       | 107/361 [04:07<10:50,  2.56s/it]Extracting train features for class peach:  30%|██▉       | 108/361 [04:09<10:37,  2.52s/it]Extracting train features for class peach:  30%|███       | 109/361 [04:11<09:57,  2.37s/it]Extracting train features for class peach:  30%|███       | 110/361 [04:13<09:11,  2.20s/it]Extracting train features for class peach:  31%|███       | 111/361 [04:15<09:02,  2.17s/it]Extracting train features for class peach:  31%|███       | 112/361 [04:18<09:35,  2.31s/it]Extracting train features for class peach:  31%|███▏      | 113/361 [04:21<09:57,  2.41s/it]Extracting train features for class peach:  32%|███▏      | 114/361 [04:23<09:55,  2.41s/it]Extracting train features for class peach:  32%|███▏      | 115/361 [04:26<10:12,  2.49s/it]Extracting train features for class peach:  32%|███▏      | 116/361 [04:28<10:16,  2.51s/it]Extracting train features for class peach:  32%|███▏      | 117/361 [04:31<10:32,  2.59s/it]Extracting train features for class peach:  33%|███▎      | 118/361 [04:34<10:54,  2.69s/it]Extracting train features for class peach:  33%|███▎      | 119/361 [04:37<10:56,  2.71s/it]Extracting train features for class peach:  33%|███▎      | 120/361 [04:39<10:37,  2.64s/it]Extracting train features for class peach:  34%|███▎      | 121/361 [04:41<09:38,  2.41s/it]Extracting train features for class peach:  34%|███▍      | 122/361 [04:43<08:42,  2.19s/it]Extracting train features for class peach:  34%|███▍      | 123/361 [04:45<08:56,  2.26s/it]Extracting train features for class peach:  34%|███▍      | 124/361 [04:48<09:10,  2.32s/it]Extracting train features for class peach:  35%|███▍      | 125/361 [04:50<09:30,  2.42s/it]Extracting train features for class peach:  35%|███▍      | 126/361 [04:53<09:31,  2.43s/it]Extracting train features for class peach:  35%|███▌      | 127/361 [04:55<09:08,  2.34s/it]Extracting train features for class peach:  35%|███▌      | 128/361 [04:57<08:18,  2.14s/it]Extracting train features for class peach:  36%|███▌      | 129/361 [04:58<07:59,  2.07s/it]Extracting train features for class peach:  36%|███▌      | 130/361 [05:01<08:27,  2.20s/it]Extracting train features for class peach:  36%|███▋      | 131/361 [05:04<09:05,  2.37s/it]Extracting train features for class peach:  37%|███▋      | 132/361 [05:06<09:13,  2.42s/it]Extracting train features for class peach:  37%|███▋      | 133/361 [05:08<08:49,  2.32s/it]Extracting train features for class peach:  37%|███▋      | 134/361 [05:10<08:05,  2.14s/it]Extracting train features for class peach:  37%|███▋      | 135/361 [05:12<07:40,  2.04s/it]Extracting train features for class peach:  38%|███▊      | 136/361 [05:14<07:47,  2.08s/it]Extracting train features for class peach:  38%|███▊      | 137/361 [05:16<08:06,  2.17s/it]Extracting train features for class peach:  38%|███▊      | 138/361 [05:19<08:10,  2.20s/it]Extracting train features for class peach:  39%|███▊      | 139/361 [05:21<08:20,  2.26s/it]Extracting train features for class peach:  39%|███▉      | 140/361 [05:23<08:16,  2.25s/it]Extracting train features for class peach:  39%|███▉      | 141/361 [05:25<07:50,  2.14s/it]Extracting train features for class peach:  39%|███▉      | 142/361 [05:27<07:19,  2.01s/it]Extracting train features for class peach:  40%|███▉      | 143/361 [05:29<07:24,  2.04s/it]Extracting train features for class peach:  40%|███▉      | 144/361 [05:31<07:36,  2.10s/it]Extracting train features for class peach:  40%|████      | 145/361 [05:34<07:46,  2.16s/it]Extracting train features for class peach:  40%|████      | 146/361 [05:36<08:05,  2.26s/it]Extracting train features for class peach:  41%|████      | 147/361 [05:38<08:00,  2.25s/it]Extracting train features for class peach:  41%|████      | 148/361 [05:40<07:35,  2.14s/it]Extracting train features for class peach:  41%|████▏     | 149/361 [05:42<07:11,  2.04s/it]Extracting train features for class peach:  42%|████▏     | 150/361 [05:44<07:13,  2.05s/it]Extracting train features for class peach:  42%|████▏     | 151/361 [05:46<07:11,  2.06s/it]Extracting train features for class peach:  42%|████▏     | 152/361 [05:48<07:03,  2.03s/it]Extracting train features for class peach:  42%|████▏     | 153/361 [05:50<07:07,  2.06s/it]Extracting train features for class peach:  43%|████▎     | 154/361 [05:53<07:21,  2.13s/it]Extracting train features for class peach:  43%|████▎     | 155/361 [05:55<07:39,  2.23s/it]Extracting train features for class peach:  43%|████▎     | 156/361 [05:57<07:54,  2.32s/it]Extracting train features for class peach:  43%|████▎     | 157/361 [06:00<08:09,  2.40s/it]Extracting train features for class peach:  44%|████▍     | 158/361 [06:03<08:15,  2.44s/it]Extracting train features for class peach:  44%|████▍     | 159/361 [06:05<07:54,  2.35s/it]Extracting train features for class peach:  44%|████▍     | 160/361 [06:07<07:33,  2.26s/it]Extracting train features for class peach:  45%|████▍     | 161/361 [06:09<07:09,  2.15s/it]Extracting train features for class peach:  45%|████▍     | 162/361 [06:11<06:59,  2.11s/it]Extracting train features for class peach:  45%|████▌     | 163/361 [06:13<07:05,  2.15s/it]Extracting train features for class peach:  45%|████▌     | 164/361 [06:15<07:26,  2.27s/it]Extracting train features for class peach:  46%|████▌     | 165/361 [06:18<07:15,  2.22s/it]Extracting train features for class peach:  46%|████▌     | 166/361 [06:19<06:46,  2.08s/it]Extracting train features for class peach:  46%|████▋     | 167/361 [06:21<06:26,  1.99s/it]Extracting train features for class peach:  47%|████▋     | 168/361 [06:23<06:28,  2.02s/it]Extracting train features for class peach:  47%|████▋     | 169/361 [06:25<06:27,  2.02s/it]Extracting train features for class peach:  47%|████▋     | 170/361 [06:27<06:14,  1.96s/it]Extracting train features for class peach:  47%|████▋     | 171/361 [06:29<05:59,  1.89s/it]Extracting train features for class peach:  48%|████▊     | 172/361 [06:31<05:52,  1.86s/it]Extracting train features for class peach:  48%|████▊     | 173/361 [06:33<05:59,  1.91s/it]Extracting train features for class peach:  48%|████▊     | 174/361 [06:35<06:07,  1.96s/it]Extracting train features for class peach:  48%|████▊     | 175/361 [06:36<05:53,  1.90s/it]Extracting train features for class peach:  49%|████▉     | 176/361 [06:38<05:48,  1.88s/it]Extracting train features for class peach:  49%|████▉     | 177/361 [06:40<05:54,  1.93s/it]Extracting train features for class peach:  49%|████▉     | 178/361 [06:42<05:58,  1.96s/it]Extracting train features for class peach:  50%|████▉     | 179/361 [06:44<06:04,  2.00s/it]Extracting train features for class peach:  50%|████▉     | 180/361 [06:47<06:05,  2.02s/it]Extracting train features for class peach:  50%|█████     | 181/361 [06:48<05:51,  1.95s/it]Extracting train features for class peach:  50%|█████     | 182/361 [06:50<05:39,  1.90s/it]Extracting train features for class peach:  51%|█████     | 183/361 [06:52<05:45,  1.94s/it]Extracting train features for class peach:  51%|█████     | 184/361 [06:54<05:41,  1.93s/it]Extracting train features for class peach:  51%|█████     | 185/361 [06:56<05:49,  1.98s/it]Extracting train features for class peach:  52%|█████▏    | 186/361 [06:58<05:54,  2.03s/it]Extracting train features for class peach:  52%|█████▏    | 187/361 [07:00<05:47,  1.99s/it]Extracting train features for class peach:  52%|█████▏    | 188/361 [07:02<05:29,  1.91s/it]Extracting train features for class peach:  52%|█████▏    | 189/361 [07:04<05:34,  1.95s/it]Extracting train features for class peach:  53%|█████▎    | 190/361 [07:06<05:55,  2.08s/it]Extracting train features for class peach:  53%|█████▎    | 191/361 [07:09<06:10,  2.18s/it]Extracting train features for class peach:  53%|█████▎    | 192/361 [07:11<06:13,  2.21s/it]Extracting train features for class peach:  53%|█████▎    | 193/361 [07:13<06:13,  2.22s/it]Extracting train features for class peach:  54%|█████▎    | 194/361 [07:15<05:48,  2.09s/it]Extracting train features for class peach:  54%|█████▍    | 195/361 [07:17<05:27,  1.97s/it]Extracting train features for class peach:  54%|█████▍    | 196/361 [07:19<05:24,  1.97s/it]Extracting train features for class peach:  55%|█████▍    | 197/361 [07:21<05:35,  2.05s/it]Extracting train features for class peach:  55%|█████▍    | 198/361 [07:23<05:20,  1.97s/it]Extracting train features for class peach:  55%|█████▌    | 199/361 [07:24<05:03,  1.88s/it]Extracting train features for class peach:  55%|█████▌    | 200/361 [07:26<05:01,  1.87s/it]Extracting train features for class peach:  56%|█████▌    | 201/361 [07:28<05:12,  1.95s/it]Extracting train features for class peach:  56%|█████▌    | 202/361 [07:30<05:09,  1.95s/it]Extracting train features for class peach:  56%|█████▌    | 203/361 [07:32<04:56,  1.88s/it]Extracting train features for class peach:  57%|█████▋    | 204/361 [07:34<04:50,  1.85s/it]Extracting train features for class peach:  57%|█████▋    | 205/361 [07:36<04:55,  1.89s/it]Extracting train features for class peach:  57%|█████▋    | 206/361 [07:38<05:16,  2.04s/it]Extracting train features for class peach:  57%|█████▋    | 207/361 [07:40<05:15,  2.05s/it]Extracting train features for class peach:  58%|█████▊    | 208/361 [07:43<05:24,  2.12s/it]Extracting train features for class peach:  58%|█████▊    | 209/361 [07:45<05:36,  2.21s/it]Extracting train features for class peach:  58%|█████▊    | 210/361 [07:47<05:46,  2.29s/it]Extracting train features for class peach:  58%|█████▊    | 211/361 [07:50<05:52,  2.35s/it]Extracting train features for class peach:  59%|█████▊    | 212/361 [07:52<05:36,  2.26s/it]Extracting train features for class peach:  59%|█████▉    | 213/361 [07:54<05:34,  2.26s/it]Extracting train features for class peach:  59%|█████▉    | 214/361 [07:57<05:44,  2.34s/it]Extracting train features for class peach:  60%|█████▉    | 215/361 [08:00<06:01,  2.48s/it]Extracting train features for class peach:  60%|█████▉    | 216/361 [08:02<05:57,  2.46s/it]Extracting train features for class peach:  60%|██████    | 217/361 [08:05<05:58,  2.49s/it]Extracting train features for class peach:  60%|██████    | 218/361 [08:07<05:48,  2.44s/it]Extracting train features for class peach:  61%|██████    | 219/361 [08:09<05:35,  2.36s/it]Extracting train features for class peach:  61%|██████    | 220/361 [08:11<05:10,  2.20s/it]Extracting train features for class peach:  61%|██████    | 221/361 [08:13<04:47,  2.05s/it]Extracting train features for class peach:  61%|██████▏   | 222/361 [08:14<04:33,  1.97s/it]Extracting train features for class peach:  62%|██████▏   | 223/361 [08:16<04:21,  1.90s/it]Extracting train features for class peach:  62%|██████▏   | 224/361 [08:18<04:13,  1.85s/it]Extracting train features for class peach:  62%|██████▏   | 225/361 [08:20<04:23,  1.94s/it]Extracting train features for class peach:  63%|██████▎   | 226/361 [08:23<04:50,  2.15s/it]Extracting train features for class peach:  63%|██████▎   | 227/361 [08:25<05:03,  2.26s/it]Extracting train features for class peach:  63%|██████▎   | 228/361 [08:27<05:01,  2.27s/it]Extracting train features for class peach:  63%|██████▎   | 229/361 [08:30<05:13,  2.37s/it]Extracting train features for class peach:  64%|██████▎   | 230/361 [08:33<05:26,  2.49s/it]Extracting train features for class peach:  64%|██████▍   | 231/361 [08:35<05:22,  2.48s/it]Extracting train features for class peach:  64%|██████▍   | 232/361 [08:38<05:26,  2.53s/it]Extracting train features for class peach:  65%|██████▍   | 233/361 [08:40<05:23,  2.53s/it]Extracting train features for class peach:  65%|██████▍   | 234/361 [08:43<05:17,  2.50s/it]Extracting train features for class peach:  65%|██████▌   | 235/361 [08:45<05:04,  2.42s/it]Extracting train features for class peach:  65%|██████▌   | 236/361 [08:48<05:03,  2.43s/it]Extracting train features for class peach:  66%|██████▌   | 237/361 [08:50<04:43,  2.28s/it]Extracting train features for class peach:  66%|██████▌   | 238/361 [08:51<04:27,  2.17s/it]Extracting train features for class peach:  66%|██████▌   | 239/361 [08:54<04:28,  2.20s/it]Extracting train features for class peach:  66%|██████▋   | 240/361 [08:56<04:35,  2.27s/it]Extracting train features for class peach:  67%|██████▋   | 241/361 [08:59<04:39,  2.33s/it]Extracting train features for class peach:  67%|██████▋   | 242/361 [09:01<04:34,  2.31s/it]Extracting train features for class peach:  67%|██████▋   | 243/361 [09:03<04:31,  2.30s/it]Extracting train features for class peach:  68%|██████▊   | 244/361 [09:06<04:35,  2.36s/it]Extracting train features for class peach:  68%|██████▊   | 245/361 [09:08<04:34,  2.36s/it]Extracting train features for class peach:  68%|██████▊   | 246/361 [09:11<04:43,  2.46s/it]Extracting train features for class peach:  68%|██████▊   | 247/361 [09:13<04:51,  2.55s/it]Extracting train features for class peach:  69%|██████▊   | 248/361 [09:16<04:49,  2.56s/it]Extracting train features for class peach:  69%|██████▉   | 249/361 [09:19<04:50,  2.59s/it]Extracting train features for class peach:  69%|██████▉   | 250/361 [09:21<04:47,  2.59s/it]Extracting train features for class peach:  70%|██████▉   | 251/361 [09:24<04:39,  2.54s/it]Extracting train features for class peach:  70%|██████▉   | 252/361 [09:26<04:32,  2.50s/it]Extracting train features for class peach:  70%|███████   | 253/361 [09:28<04:18,  2.40s/it]Extracting train features for class peach:  70%|███████   | 254/361 [09:30<03:57,  2.22s/it]Extracting train features for class peach:  71%|███████   | 255/361 [09:32<03:38,  2.06s/it]Extracting train features for class peach:  71%|███████   | 256/361 [09:34<03:31,  2.01s/it]Extracting train features for class peach:  71%|███████   | 257/361 [09:36<03:28,  2.01s/it]Extracting train features for class peach:  71%|███████▏  | 258/361 [09:38<03:35,  2.10s/it]Extracting train features for class peach:  72%|███████▏  | 259/361 [09:40<03:38,  2.14s/it]Extracting train features for class peach:  72%|███████▏  | 260/361 [09:43<03:48,  2.27s/it]Extracting train features for class peach:  72%|███████▏  | 261/361 [09:45<03:50,  2.30s/it]Extracting train features for class peach:  73%|███████▎  | 262/361 [09:48<03:50,  2.33s/it]Extracting train features for class peach:  73%|███████▎  | 263/361 [09:50<03:49,  2.35s/it]Extracting train features for class peach:  73%|███████▎  | 264/361 [09:52<03:44,  2.32s/it]Extracting train features for class peach:  73%|███████▎  | 265/361 [09:54<03:39,  2.29s/it]Extracting train features for class peach:  74%|███████▎  | 266/361 [09:56<03:25,  2.16s/it]Extracting train features for class peach:  74%|███████▍  | 267/361 [09:58<03:16,  2.09s/it]Extracting train features for class peach:  74%|███████▍  | 268/361 [10:00<03:14,  2.09s/it]Extracting train features for class peach:  75%|███████▍  | 269/361 [10:02<03:11,  2.08s/it]Extracting train features for class peach:  75%|███████▍  | 270/361 [10:04<03:11,  2.10s/it]Extracting train features for class peach:  75%|███████▌  | 271/361 [10:07<03:22,  2.25s/it]Extracting train features for class peach:  75%|███████▌  | 272/361 [10:10<03:26,  2.32s/it]Extracting train features for class peach:  76%|███████▌  | 273/361 [10:12<03:22,  2.31s/it]Extracting train features for class peach:  76%|███████▌  | 274/361 [10:14<03:20,  2.30s/it]Extracting train features for class peach:  76%|███████▌  | 275/361 [10:16<03:17,  2.30s/it]Extracting train features for class peach:  76%|███████▋  | 276/361 [10:19<03:14,  2.29s/it]Extracting train features for class peach:  77%|███████▋  | 277/361 [10:21<03:17,  2.35s/it]Extracting train features for class peach:  77%|███████▋  | 278/361 [10:23<03:14,  2.34s/it]Extracting train features for class peach:  77%|███████▋  | 279/361 [10:26<03:11,  2.34s/it]Extracting train features for class peach:  78%|███████▊  | 280/361 [10:28<03:08,  2.32s/it]Extracting train features for class peach:  78%|███████▊  | 281/361 [10:30<03:01,  2.27s/it]Extracting train features for class peach:  78%|███████▊  | 282/361 [10:33<03:07,  2.37s/it]Extracting train features for class peach:  78%|███████▊  | 283/361 [10:35<03:10,  2.44s/it]Extracting train features for class peach:  79%|███████▊  | 284/361 [10:38<03:09,  2.46s/it]Extracting train features for class peach:  79%|███████▉  | 285/361 [10:41<03:13,  2.54s/it]Extracting train features for class peach:  79%|███████▉  | 286/361 [10:43<03:10,  2.54s/it]Extracting train features for class peach:  80%|███████▉  | 287/361 [10:46<03:10,  2.58s/it]Extracting train features for class peach:  80%|███████▉  | 288/361 [10:49<03:09,  2.60s/it]Extracting train features for class peach:  80%|████████  | 289/361 [10:51<02:57,  2.46s/it]Extracting train features for class peach:  80%|████████  | 290/361 [10:53<02:44,  2.32s/it]Extracting train features for class peach:  81%|████████  | 291/361 [10:54<02:28,  2.12s/it]Extracting train features for class peach:  81%|████████  | 292/361 [10:56<02:19,  2.03s/it]Extracting train features for class peach:  81%|████████  | 293/361 [10:58<02:17,  2.03s/it]Extracting train features for class peach:  81%|████████▏ | 294/361 [11:01<02:22,  2.13s/it]Extracting train features for class peach:  82%|████████▏ | 295/361 [11:03<02:20,  2.13s/it]Extracting train features for class peach:  82%|████████▏ | 296/361 [11:04<02:11,  2.02s/it]Extracting train features for class peach:  82%|████████▏ | 297/361 [11:06<02:02,  1.92s/it]Extracting train features for class peach:  83%|████████▎ | 298/361 [11:08<01:56,  1.84s/it]Extracting train features for class peach:  83%|████████▎ | 299/361 [11:10<01:58,  1.91s/it]Extracting train features for class peach:  83%|████████▎ | 300/361 [11:12<01:57,  1.93s/it]Extracting train features for class peach:  83%|████████▎ | 301/361 [11:14<01:52,  1.87s/it]Extracting train features for class peach:  84%|████████▎ | 302/361 [11:15<01:48,  1.83s/it]Extracting train features for class peach:  84%|████████▍ | 303/361 [11:17<01:47,  1.85s/it]Extracting train features for class peach:  84%|████████▍ | 304/361 [11:19<01:48,  1.90s/it]Extracting train features for class peach:  84%|████████▍ | 305/361 [11:21<01:43,  1.85s/it]Extracting train features for class peach:  85%|████████▍ | 306/361 [11:23<01:39,  1.81s/it]Extracting train features for class peach:  85%|████████▌ | 307/361 [11:25<01:39,  1.85s/it]Extracting train features for class peach:  85%|████████▌ | 308/361 [11:27<01:44,  1.97s/it]Extracting train features for class peach:  86%|████████▌ | 309/361 [11:29<01:39,  1.92s/it]Extracting train features for class peach:  86%|████████▌ | 310/361 [11:30<01:35,  1.87s/it]Extracting train features for class peach:  86%|████████▌ | 311/361 [11:32<01:34,  1.89s/it]Extracting train features for class peach:  86%|████████▋ | 312/361 [11:35<01:38,  2.00s/it]Extracting train features for class peach:  87%|████████▋ | 313/361 [11:37<01:36,  2.02s/it]Extracting train features for class peach:  87%|████████▋ | 314/361 [11:39<01:32,  1.98s/it]Extracting train features for class peach:  87%|████████▋ | 315/361 [11:40<01:29,  1.95s/it]Extracting train features for class peach:  88%|████████▊ | 316/361 [11:42<01:27,  1.95s/it]Extracting train features for class peach:  88%|████████▊ | 317/361 [11:45<01:28,  2.02s/it]Extracting train features for class peach:  88%|████████▊ | 318/361 [11:47<01:29,  2.08s/it]Extracting train features for class peach:  88%|████████▊ | 319/361 [11:49<01:29,  2.13s/it]Extracting train features for class peach:  89%|████████▊ | 320/361 [11:51<01:23,  2.04s/it]Extracting train features for class peach:  89%|████████▉ | 321/361 [11:53<01:18,  1.96s/it]Extracting train features for class peach:  89%|████████▉ | 322/361 [11:55<01:16,  1.97s/it]Extracting train features for class peach:  89%|████████▉ | 323/361 [11:57<01:19,  2.09s/it]Extracting train features for class peach:  90%|████████▉ | 324/361 [11:59<01:16,  2.08s/it]Extracting train features for class peach:  90%|█████████ | 325/361 [12:01<01:13,  2.05s/it]Extracting train features for class peach:  90%|█████████ | 326/361 [12:03<01:13,  2.09s/it]Extracting train features for class peach:  91%|█████████ | 327/361 [12:05<01:09,  2.06s/it]Extracting train features for class peach:  91%|█████████ | 328/361 [12:07<01:09,  2.10s/it]Extracting train features for class peach:  91%|█████████ | 329/361 [12:10<01:10,  2.21s/it]Extracting train features for class peach:  91%|█████████▏| 330/361 [12:12<01:09,  2.23s/it]Extracting train features for class peach:  92%|█████████▏| 331/361 [12:14<01:07,  2.25s/it]Extracting train features for class peach:  92%|█████████▏| 332/361 [12:17<01:06,  2.29s/it]Extracting train features for class peach:  92%|█████████▏| 333/361 [12:19<01:06,  2.37s/it]Extracting train features for class peach:  93%|█████████▎| 334/361 [12:22<01:05,  2.41s/it]Extracting train features for class peach:  93%|█████████▎| 335/361 [12:25<01:04,  2.49s/it]Extracting train features for class peach:  93%|█████████▎| 336/361 [12:27<01:02,  2.50s/it]Extracting train features for class peach:  93%|█████████▎| 337/361 [12:29<00:58,  2.43s/it]Extracting train features for class peach:  94%|█████████▎| 338/361 [12:32<00:54,  2.37s/it]Extracting train features for class peach:  94%|█████████▍| 339/361 [12:34<00:50,  2.31s/it]Extracting train features for class peach:  94%|█████████▍| 340/361 [12:35<00:44,  2.13s/it]Extracting train features for class peach:  94%|█████████▍| 341/361 [12:37<00:39,  1.99s/it]Extracting train features for class peach:  95%|█████████▍| 342/361 [12:39<00:37,  1.97s/it]Extracting train features for class peach:  95%|█████████▌| 343/361 [12:41<00:36,  2.01s/it]Extracting train features for class peach:  95%|█████████▌| 344/361 [12:43<00:33,  1.95s/it]Extracting train features for class peach:  96%|█████████▌| 345/361 [12:45<00:30,  1.91s/it]Extracting train features for class peach:  96%|█████████▌| 346/361 [12:47<00:28,  1.88s/it]Extracting train features for class peach:  96%|█████████▌| 347/361 [12:49<00:27,  1.99s/it]Extracting train features for class peach:  96%|█████████▋| 348/361 [12:51<00:26,  2.05s/it]Extracting train features for class peach:  97%|█████████▋| 349/361 [12:53<00:26,  2.17s/it]Extracting train features for class peach:  97%|█████████▋| 350/361 [12:56<00:23,  2.15s/it]Extracting train features for class peach:  97%|█████████▋| 351/361 [12:58<00:20,  2.08s/it]Extracting train features for class peach:  98%|█████████▊| 352/361 [12:59<00:17,  1.98s/it]Extracting train features for class peach:  98%|█████████▊| 353/361 [13:01<00:15,  1.92s/it]Extracting train features for class peach:  98%|█████████▊| 354/361 [13:03<00:13,  1.97s/it]Extracting train features for class peach:  98%|█████████▊| 355/361 [13:06<00:12,  2.10s/it]Extracting train features for class peach:  99%|█████████▊| 356/361 [13:08<00:10,  2.09s/it]Extracting train features for class peach:  99%|█████████▉| 357/361 [13:09<00:07,  1.97s/it]Extracting train features for class peach:  99%|█████████▉| 358/361 [13:11<00:06,  2.04s/it]Extracting train features for class peach:  99%|█████████▉| 359/361 [13:14<00:04,  2.16s/it]Extracting train features for class peach: 100%|█████████▉| 360/361 [13:16<00:02,  2.13s/it]Extracting train features for class peach: 100%|██████████| 361/361 [13:18<00:00,  2.02s/it]Extracting train features for class peach: 100%|██████████| 361/361 [13:18<00:00,  2.21s/it]


Running coreset for Fusion on class peach...
Traceback (most recent call last):
  File "main.py", line 99, in <module>
    run_3d_ads(args)
  File "main.py", line 31, in run_3d_ads
    model.fit(cls)
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/m3dm_runner.py", line 60, in fit
    method.run_coreset()
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/feature_extractors/features_dino_fusion.py", line 174, in run_coreset
    self.coreset_idx = get_coreset_idx_randomp(self.patch_lib,
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/utils/utils.py", line 48, in get_coreset_idx_randomp
    z_lib = torch.tensor(transformer.fit_transform(z_lib))
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/random_projection.py", line 359, in fit
    X = self._validate_data(
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
  File "/usr/local/python38/lib/python3.8/site-packages/torch/_tensor.py", line 645, in __array__
    return self.numpy().astype(dtype, copy=False)
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
/usr/local/python38/lib/python3.8/site-packages/torch/utils/cpp_extension.py:284: UserWarning: 

                               !! WARNING !!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Your compiler (c++) is not compatible with the compiler Pytorch was
built with for this platform, which is g++ on linux. Please
use g++ to to compile your extension. Alternatively, you may
compile PyTorch from source using c++, and then you can also use
c++ to compile your extension.

See https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md for help
with compiling PyTorch from source.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

                              !! WARNING !!

  warnings.warn(WRONG_COMPILER_WARNING.format(
unexpected_keys
['mask_token', 'decoder_pos_embed.0.weight', 'decoder_pos_embed.0.bias', 'decoder_pos_embed.2.weight', 'decoder_pos_embed.2.bias', 'MAE_decoder.blocks.0.norm1.weight', 'MAE_decoder.blocks.0.norm1.bias', 'MAE_decoder.blocks.0.norm2.weight', 'MAE_decoder.blocks.0.norm2.bias', 'MAE_decoder.blocks.0.mlp.fc1.weight', 'MAE_decoder.blocks.0.mlp.fc1.bias', 'MAE_decoder.blocks.0.mlp.fc2.weight', 'MAE_decoder.blocks.0.mlp.fc2.bias', 'MAE_decoder.blocks.0.attn.qkv.weight', 'MAE_decoder.blocks.0.attn.proj.weight', 'MAE_decoder.blocks.0.attn.proj.bias', 'MAE_decoder.blocks.1.norm1.weight', 'MAE_decoder.blocks.1.norm1.bias', 'MAE_decoder.blocks.1.norm2.weight', 'MAE_decoder.blocks.1.norm2.bias', 'MAE_decoder.blocks.1.mlp.fc1.weight', 'MAE_decoder.blocks.1.mlp.fc1.bias', 'MAE_decoder.blocks.1.mlp.fc2.weight', 'MAE_decoder.blocks.1.mlp.fc2.bias', 'MAE_decoder.blocks.1.attn.qkv.weight', 'MAE_decoder.blocks.1.attn.proj.weight', 'MAE_decoder.blocks.1.attn.proj.bias', 'MAE_decoder.blocks.2.norm1.weight', 'MAE_decoder.blocks.2.norm1.bias', 'MAE_decoder.blocks.2.norm2.weight', 'MAE_decoder.blocks.2.norm2.bias', 'MAE_decoder.blocks.2.mlp.fc1.weight', 'MAE_decoder.blocks.2.mlp.fc1.bias', 'MAE_decoder.blocks.2.mlp.fc2.weight', 'MAE_decoder.blocks.2.mlp.fc2.bias', 'MAE_decoder.blocks.2.attn.qkv.weight', 'MAE_decoder.blocks.2.attn.proj.weight', 'MAE_decoder.blocks.2.attn.proj.bias', 'MAE_decoder.blocks.3.norm1.weight', 'MAE_decoder.blocks.3.norm1.bias', 'MAE_decoder.blocks.3.norm2.weight', 'MAE_decoder.blocks.3.norm2.bias', 'MAE_decoder.blocks.3.mlp.fc1.weight', 'MAE_decoder.blocks.3.mlp.fc1.bias', 'MAE_decoder.blocks.3.mlp.fc2.weight', 'MAE_decoder.blocks.3.mlp.fc2.bias', 'MAE_decoder.blocks.3.attn.qkv.weight', 'MAE_decoder.blocks.3.attn.proj.weight', 'MAE_decoder.blocks.3.attn.proj.bias', 'MAE_decoder.norm.weight', 'MAE_decoder.norm.bias', 'increase_dim.0.weight', 'increase_dim.0.bias']
[Transformer] Successful Loading the ckpt from checkpoints/pointmae_pretrain.pth
point: <All keys matched successfully>
7fusion_block: <All keys matched successfully>
Extracting train features for class potato:   0%|          | 0/300 [00:00<?, ?it/s]Extracting train features for class potato:   0%|          | 1/300 [00:02<11:45,  2.36s/it]Extracting train features for class potato:   1%|          | 2/300 [00:04<11:05,  2.23s/it]Extracting train features for class potato:   1%|          | 3/300 [00:06<10:00,  2.02s/it]Extracting train features for class potato:   1%|▏         | 4/300 [00:07<09:06,  1.85s/it]Extracting train features for class potato:   2%|▏         | 5/300 [00:09<08:29,  1.73s/it]Extracting train features for class potato:   2%|▏         | 6/300 [00:10<08:15,  1.69s/it]Extracting train features for class potato:   2%|▏         | 7/300 [00:12<08:23,  1.72s/it]Extracting train features for class potato:   3%|▎         | 8/300 [00:14<08:46,  1.80s/it]Extracting train features for class potato:   3%|▎         | 9/300 [00:16<08:35,  1.77s/it]Extracting train features for class potato:   3%|▎         | 10/300 [00:18<08:32,  1.77s/it]Extracting train features for class potato:   4%|▎         | 11/300 [00:19<08:27,  1.76s/it]Extracting train features for class potato:   4%|▍         | 12/300 [00:21<07:53,  1.64s/it]Extracting train features for class potato:   4%|▍         | 13/300 [00:22<07:27,  1.56s/it]Extracting train features for class potato:   5%|▍         | 14/300 [00:24<07:09,  1.50s/it]Extracting train features for class potato:   5%|▌         | 15/300 [00:25<07:27,  1.57s/it]Extracting train features for class potato:   5%|▌         | 16/300 [00:27<07:46,  1.64s/it]Extracting train features for class potato:   6%|▌         | 17/300 [00:29<07:48,  1.65s/it]Extracting train features for class potato:   6%|▌         | 18/300 [00:30<07:34,  1.61s/it]Extracting train features for class potato:   6%|▋         | 19/300 [00:32<07:09,  1.53s/it]Extracting train features for class potato:   7%|▋         | 20/300 [00:33<06:53,  1.48s/it]Extracting train features for class potato:   7%|▋         | 21/300 [00:34<06:42,  1.44s/it]Extracting train features for class potato:   7%|▋         | 22/300 [00:36<06:34,  1.42s/it]Extracting train features for class potato:   8%|▊         | 23/300 [00:37<06:41,  1.45s/it]Extracting train features for class potato:   8%|▊         | 24/300 [00:39<06:43,  1.46s/it]Extracting train features for class potato:   8%|▊         | 25/300 [00:40<06:33,  1.43s/it]Extracting train features for class potato:   9%|▊         | 26/300 [00:41<06:27,  1.41s/it]Extracting train features for class potato:   9%|▉         | 27/300 [00:43<06:20,  1.39s/it]Extracting train features for class potato:   9%|▉         | 28/300 [00:44<06:15,  1.38s/it]Extracting train features for class potato:  10%|▉         | 29/300 [00:46<06:26,  1.43s/it]Extracting train features for class potato:  10%|█         | 30/300 [00:48<07:04,  1.57s/it]Extracting train features for class potato:  10%|█         | 31/300 [00:49<07:16,  1.62s/it]Extracting train features for class potato:  11%|█         | 32/300 [00:51<06:54,  1.55s/it]Extracting train features for class potato:  11%|█         | 33/300 [00:52<06:45,  1.52s/it]Extracting train features for class potato:  11%|█▏        | 34/300 [00:54<06:55,  1.56s/it]Extracting train features for class potato:  12%|█▏        | 35/300 [00:55<06:38,  1.50s/it]Extracting train features for class potato:  12%|█▏        | 36/300 [00:57<06:28,  1.47s/it]Extracting train features for class potato:  12%|█▏        | 37/300 [00:58<06:19,  1.44s/it]Extracting train features for class potato:  13%|█▎        | 38/300 [00:59<06:20,  1.45s/it]Extracting train features for class potato:  13%|█▎        | 39/300 [01:01<06:50,  1.57s/it]Extracting train features for class potato:  13%|█▎        | 40/300 [01:03<07:02,  1.62s/it]Extracting train features for class potato:  14%|█▎        | 41/300 [01:05<06:56,  1.61s/it]Extracting train features for class potato:  14%|█▍        | 42/300 [01:06<06:52,  1.60s/it]Extracting train features for class potato:  14%|█▍        | 43/300 [01:08<06:38,  1.55s/it]Extracting train features for class potato:  15%|█▍        | 44/300 [01:09<06:22,  1.49s/it]Extracting train features for class potato:  15%|█▌        | 45/300 [01:10<06:09,  1.45s/it]Extracting train features for class potato:  15%|█▌        | 46/300 [01:12<05:59,  1.42s/it]Extracting train features for class potato:  16%|█▌        | 47/300 [01:13<06:14,  1.48s/it]Extracting train features for class potato:  16%|█▌        | 48/300 [01:15<06:24,  1.53s/it]Extracting train features for class potato:  16%|█▋        | 49/300 [01:17<06:30,  1.56s/it]Extracting train features for class potato:  17%|█▋        | 50/300 [01:18<06:39,  1.60s/it]Extracting train features for class potato:  17%|█▋        | 51/300 [01:20<06:49,  1.64s/it]Extracting train features for class potato:  17%|█▋        | 52/300 [01:22<07:06,  1.72s/it]Extracting train features for class potato:  18%|█▊        | 53/300 [01:23<06:56,  1.69s/it]Extracting train features for class potato:  18%|█▊        | 54/300 [01:25<06:42,  1.64s/it]Extracting train features for class potato:  18%|█▊        | 55/300 [01:27<06:43,  1.65s/it]Extracting train features for class potato:  19%|█▊        | 56/300 [01:28<06:37,  1.63s/it]Extracting train features for class potato:  19%|█▉        | 57/300 [01:30<06:34,  1.62s/it]Extracting train features for class potato:  19%|█▉        | 58/300 [01:32<06:45,  1.67s/it]Extracting train features for class potato:  20%|█▉        | 59/300 [01:33<06:50,  1.70s/it]Extracting train features for class potato:  20%|██        | 60/300 [01:35<06:41,  1.67s/it]Extracting train features for class potato:  20%|██        | 61/300 [01:36<06:21,  1.60s/it]Extracting train features for class potato:  21%|██        | 62/300 [01:38<06:13,  1.57s/it]Extracting train features for class potato:  21%|██        | 63/300 [01:39<06:06,  1.55s/it]Extracting train features for class potato:  21%|██▏       | 64/300 [01:41<06:01,  1.53s/it]Extracting train features for class potato:  22%|██▏       | 65/300 [01:43<06:06,  1.56s/it]Extracting train features for class potato:  22%|██▏       | 66/300 [01:44<06:20,  1.63s/it]Extracting train features for class potato:  22%|██▏       | 67/300 [01:46<06:12,  1.60s/it]Extracting train features for class potato:  23%|██▎       | 68/300 [01:47<05:57,  1.54s/it]Extracting train features for class potato:  23%|██▎       | 69/300 [01:49<05:42,  1.48s/it]Extracting train features for class potato:  23%|██▎       | 70/300 [01:50<05:29,  1.43s/it]Extracting train features for class potato:  24%|██▎       | 71/300 [01:51<05:20,  1.40s/it]Extracting train features for class potato:  24%|██▍       | 72/300 [01:53<05:20,  1.40s/it]Extracting train features for class potato:  24%|██▍       | 73/300 [01:54<05:18,  1.40s/it]Extracting train features for class potato:  25%|██▍       | 74/300 [01:55<05:14,  1.39s/it]Extracting train features for class potato:  25%|██▌       | 75/300 [01:57<05:11,  1.38s/it]Extracting train features for class potato:  25%|██▌       | 76/300 [01:58<05:27,  1.46s/it]Extracting train features for class potato:  26%|██▌       | 77/300 [02:00<05:43,  1.54s/it]Extracting train features for class potato:  26%|██▌       | 78/300 [02:02<05:32,  1.50s/it]Extracting train features for class potato:  26%|██▋       | 79/300 [02:03<05:25,  1.47s/it]Extracting train features for class potato:  27%|██▋       | 80/300 [02:05<05:35,  1.52s/it]Extracting train features for class potato:  27%|██▋       | 81/300 [02:06<05:36,  1.54s/it]Extracting train features for class potato:  27%|██▋       | 82/300 [02:08<05:26,  1.50s/it]Extracting train features for class potato:  28%|██▊       | 83/300 [02:09<05:15,  1.46s/it]Extracting train features for class potato:  28%|██▊       | 84/300 [02:10<05:08,  1.43s/it]Extracting train features for class potato:  28%|██▊       | 85/300 [02:12<05:07,  1.43s/it]Extracting train features for class potato:  29%|██▊       | 86/300 [02:13<05:07,  1.44s/it]Extracting train features for class potato:  29%|██▉       | 87/300 [02:15<05:04,  1.43s/it]Extracting train features for class potato:  29%|██▉       | 88/300 [02:16<05:13,  1.48s/it]Extracting train features for class potato:  30%|██▉       | 89/300 [02:18<05:35,  1.59s/it]Extracting train features for class potato:  30%|███       | 90/300 [02:20<05:40,  1.62s/it]Extracting train features for class potato:  30%|███       | 91/300 [02:21<05:35,  1.60s/it]Extracting train features for class potato:  31%|███       | 92/300 [02:23<05:24,  1.56s/it]Extracting train features for class potato:  31%|███       | 93/300 [02:24<05:07,  1.48s/it]Extracting train features for class potato:  31%|███▏      | 94/300 [02:25<04:57,  1.44s/it]Extracting train features for class potato:  32%|███▏      | 95/300 [02:27<05:12,  1.53s/it]Extracting train features for class potato:  32%|███▏      | 96/300 [02:29<05:30,  1.62s/it]Extracting train features for class potato:  32%|███▏      | 97/300 [02:30<05:13,  1.55s/it]Extracting train features for class potato:  33%|███▎      | 98/300 [02:32<05:01,  1.49s/it]Extracting train features for class potato:  33%|███▎      | 99/300 [02:33<04:53,  1.46s/it]Extracting train features for class potato:  33%|███▎      | 100/300 [02:35<04:48,  1.44s/it]Extracting train features for class potato:  34%|███▎      | 101/300 [02:36<04:40,  1.41s/it]Extracting train features for class potato:  34%|███▍      | 102/300 [02:37<04:34,  1.38s/it]Extracting train features for class potato:  34%|███▍      | 103/300 [02:39<04:47,  1.46s/it]Extracting train features for class potato:  35%|███▍      | 104/300 [02:41<05:03,  1.55s/it]Extracting train features for class potato:  35%|███▌      | 105/300 [02:42<05:06,  1.57s/it]Extracting train features for class potato:  35%|███▌      | 106/300 [02:44<04:59,  1.54s/it]Extracting train features for class potato:  36%|███▌      | 107/300 [02:45<04:48,  1.50s/it]Extracting train features for class potato:  36%|███▌      | 108/300 [02:46<04:38,  1.45s/it]Extracting train features for class potato:  36%|███▋      | 109/300 [02:48<04:32,  1.42s/it]Extracting train features for class potato:  37%|███▋      | 110/300 [02:49<04:27,  1.41s/it]Extracting train features for class potato:  37%|███▋      | 111/300 [02:51<04:21,  1.38s/it]Extracting train features for class potato:  37%|███▋      | 112/300 [02:52<04:16,  1.36s/it]Extracting train features for class potato:  38%|███▊      | 113/300 [02:54<04:35,  1.47s/it]Extracting train features for class potato:  38%|███▊      | 114/300 [02:55<04:40,  1.51s/it]Extracting train features for class potato:  38%|███▊      | 115/300 [02:57<04:40,  1.52s/it]Extracting train features for class potato:  39%|███▊      | 116/300 [02:58<04:46,  1.56s/it]Extracting train features for class potato:  39%|███▉      | 117/300 [03:00<05:12,  1.71s/it]Extracting train features for class potato:  39%|███▉      | 118/300 [03:02<05:27,  1.80s/it]Extracting train features for class potato:  40%|███▉      | 119/300 [03:04<05:17,  1.75s/it]Extracting train features for class potato:  40%|████      | 120/300 [03:06<05:05,  1.70s/it]Extracting train features for class potato:  40%|████      | 121/300 [03:07<05:08,  1.72s/it]Extracting train features for class potato:  41%|████      | 122/300 [03:09<04:58,  1.68s/it]Extracting train features for class potato:  41%|████      | 123/300 [03:10<04:42,  1.59s/it]Extracting train features for class potato:  41%|████▏     | 124/300 [03:12<04:31,  1.54s/it]Extracting train features for class potato:  42%|████▏     | 125/300 [03:14<04:38,  1.59s/it]Extracting train features for class potato:  42%|████▏     | 126/300 [03:15<04:36,  1.59s/it]Extracting train features for class potato:  42%|████▏     | 127/300 [03:16<04:24,  1.53s/it]Extracting train features for class potato:  43%|████▎     | 128/300 [03:18<04:25,  1.54s/it]Extracting train features for class potato:  43%|████▎     | 129/300 [03:20<04:37,  1.62s/it]Extracting train features for class potato:  43%|████▎     | 130/300 [03:22<04:47,  1.69s/it]Extracting train features for class potato:  44%|████▎     | 131/300 [03:24<05:01,  1.78s/it]Extracting train features for class potato:  44%|████▍     | 132/300 [03:26<05:05,  1.82s/it]Extracting train features for class potato:  44%|████▍     | 133/300 [03:27<05:00,  1.80s/it]Extracting train features for class potato:  45%|████▍     | 134/300 [03:29<05:00,  1.81s/it]Extracting train features for class potato:  45%|████▌     | 135/300 [03:31<04:38,  1.69s/it]Extracting train features for class potato:  45%|████▌     | 136/300 [03:32<04:24,  1.61s/it]Extracting train features for class potato:  46%|████▌     | 137/300 [03:33<04:08,  1.53s/it]Extracting train features for class potato:  46%|████▌     | 138/300 [03:35<03:56,  1.46s/it]Extracting train features for class potato:  46%|████▋     | 139/300 [03:36<03:48,  1.42s/it]Extracting train features for class potato:  47%|████▋     | 140/300 [03:37<03:42,  1.39s/it]Extracting train features for class potato:  47%|████▋     | 141/300 [03:39<03:40,  1.39s/it]Extracting train features for class potato:  47%|████▋     | 142/300 [03:40<03:48,  1.45s/it]Extracting train features for class potato:  48%|████▊     | 143/300 [03:42<04:05,  1.56s/it]Extracting train features for class potato:  48%|████▊     | 144/300 [03:44<04:27,  1.72s/it]Extracting train features for class potato:  48%|████▊     | 145/300 [03:46<04:38,  1.79s/it]Extracting train features for class potato:  49%|████▊     | 146/300 [03:48<04:39,  1.82s/it]Extracting train features for class potato:  49%|████▉     | 147/300 [03:50<04:27,  1.75s/it]Extracting train features for class potato:  49%|████▉     | 148/300 [03:51<04:19,  1.70s/it]Extracting train features for class potato:  50%|████▉     | 149/300 [03:53<04:18,  1.72s/it]Extracting train features for class potato:  50%|█████     | 150/300 [03:55<04:14,  1.70s/it]Extracting train features for class potato:  50%|█████     | 151/300 [03:56<04:12,  1.69s/it]Extracting train features for class potato:  51%|█████     | 152/300 [03:58<04:05,  1.66s/it]Extracting train features for class potato:  51%|█████     | 153/300 [03:59<03:56,  1.61s/it]Extracting train features for class potato:  51%|█████▏    | 154/300 [04:01<03:50,  1.58s/it]Extracting train features for class potato:  52%|█████▏    | 155/300 [04:02<03:44,  1.55s/it]Extracting train features for class potato:  52%|█████▏    | 156/300 [04:04<03:41,  1.54s/it]Extracting train features for class potato:  52%|█████▏    | 157/300 [04:05<03:39,  1.53s/it]Extracting train features for class potato:  53%|█████▎    | 158/300 [04:07<03:34,  1.51s/it]Extracting train features for class potato:  53%|█████▎    | 159/300 [04:08<03:34,  1.52s/it]Extracting train features for class potato:  53%|█████▎    | 160/300 [04:10<03:35,  1.54s/it]Extracting train features for class potato:  54%|█████▎    | 161/300 [04:12<03:47,  1.64s/it]Extracting train features for class potato:  54%|█████▍    | 162/300 [04:14<04:06,  1.79s/it]Extracting train features for class potato:  54%|█████▍    | 163/300 [04:16<03:55,  1.72s/it]Extracting train features for class potato:  55%|█████▍    | 164/300 [04:17<03:48,  1.68s/it]Extracting train features for class potato:  55%|█████▌    | 165/300 [04:19<03:55,  1.75s/it]Extracting train features for class potato:  55%|█████▌    | 166/300 [04:21<03:51,  1.72s/it]Extracting train features for class potato:  56%|█████▌    | 167/300 [04:22<03:36,  1.63s/it]Extracting train features for class potato:  56%|█████▌    | 168/300 [04:24<03:32,  1.61s/it]Extracting train features for class potato:  56%|█████▋    | 169/300 [04:25<03:30,  1.60s/it]Extracting train features for class potato:  57%|█████▋    | 170/300 [04:27<03:20,  1.54s/it]Extracting train features for class potato:  57%|█████▋    | 171/300 [04:28<03:13,  1.50s/it]Extracting train features for class potato:  57%|█████▋    | 172/300 [04:30<03:09,  1.48s/it]Extracting train features for class potato:  58%|█████▊    | 173/300 [04:31<03:05,  1.46s/it]Extracting train features for class potato:  58%|█████▊    | 174/300 [04:32<03:05,  1.47s/it]Extracting train features for class potato:  58%|█████▊    | 175/300 [04:34<03:16,  1.57s/it]Extracting train features for class potato:  59%|█████▊    | 176/300 [04:36<03:18,  1.60s/it]Extracting train features for class potato:  59%|█████▉    | 177/300 [04:37<03:06,  1.52s/it]Extracting train features for class potato:  59%|█████▉    | 178/300 [04:39<02:58,  1.46s/it]Extracting train features for class potato:  60%|█████▉    | 179/300 [04:40<02:52,  1.42s/it]Extracting train features for class potato:  60%|██████    | 180/300 [04:41<02:47,  1.40s/it]Extracting train features for class potato:  60%|██████    | 181/300 [04:43<02:44,  1.38s/it]Extracting train features for class potato:  61%|██████    | 182/300 [04:44<02:47,  1.42s/it]Extracting train features for class potato:  61%|██████    | 183/300 [04:45<02:42,  1.39s/it]Extracting train features for class potato:  61%|██████▏   | 184/300 [04:47<02:38,  1.37s/it]Extracting train features for class potato:  62%|██████▏   | 185/300 [04:48<02:35,  1.35s/it]Extracting train features for class potato:  62%|██████▏   | 186/300 [04:49<02:34,  1.35s/it]Extracting train features for class potato:  62%|██████▏   | 187/300 [04:51<02:34,  1.37s/it]Extracting train features for class potato:  63%|██████▎   | 188/300 [04:52<02:39,  1.42s/it]Extracting train features for class potato:  63%|██████▎   | 189/300 [04:54<02:49,  1.53s/it]Extracting train features for class potato:  63%|██████▎   | 190/300 [04:56<02:48,  1.53s/it]Extracting train features for class potato:  64%|██████▎   | 191/300 [04:57<02:39,  1.46s/it]Extracting train features for class potato:  64%|██████▍   | 192/300 [04:58<02:32,  1.41s/it]Extracting train features for class potato:  64%|██████▍   | 193/300 [05:00<02:28,  1.39s/it]Extracting train features for class potato:  65%|██████▍   | 194/300 [05:01<02:24,  1.37s/it]Extracting train features for class potato:  65%|██████▌   | 195/300 [05:02<02:23,  1.36s/it]Extracting train features for class potato:  65%|██████▌   | 196/300 [05:04<02:21,  1.36s/it]Extracting train features for class potato:  66%|██████▌   | 197/300 [05:05<02:20,  1.37s/it]Extracting train features for class potato:  66%|██████▌   | 198/300 [05:06<02:23,  1.40s/it]Extracting train features for class potato:  66%|██████▋   | 199/300 [05:08<02:28,  1.47s/it]Extracting train features for class potato:  67%|██████▋   | 200/300 [05:10<02:27,  1.48s/it]Extracting train features for class potato:  67%|██████▋   | 201/300 [05:11<02:23,  1.45s/it]Extracting train features for class potato:  67%|██████▋   | 202/300 [05:12<02:24,  1.48s/it]Extracting train features for class potato:  68%|██████▊   | 203/300 [05:14<02:27,  1.52s/it]Extracting train features for class potato:  68%|██████▊   | 204/300 [05:16<02:30,  1.56s/it]Extracting train features for class potato:  68%|██████▊   | 205/300 [05:17<02:25,  1.53s/it]Extracting train features for class potato:  69%|██████▊   | 206/300 [05:19<02:20,  1.49s/it]Extracting train features for class potato:  69%|██████▉   | 207/300 [05:20<02:16,  1.47s/it]Extracting train features for class potato:  69%|██████▉   | 208/300 [05:21<02:14,  1.46s/it]Extracting train features for class potato:  70%|██████▉   | 209/300 [05:23<02:13,  1.47s/it]Extracting train features for class potato:  70%|███████   | 210/300 [05:24<02:12,  1.47s/it]Extracting train features for class potato:  70%|███████   | 211/300 [05:26<02:07,  1.43s/it]Extracting train features for class potato:  71%|███████   | 212/300 [05:27<02:02,  1.39s/it]Extracting train features for class potato:  71%|███████   | 213/300 [05:28<02:00,  1.39s/it]Extracting train features for class potato:  71%|███████▏  | 214/300 [05:30<01:59,  1.38s/it]Extracting train features for class potato:  72%|███████▏  | 215/300 [05:31<01:56,  1.37s/it]Extracting train features for class potato:  72%|███████▏  | 216/300 [05:33<01:54,  1.37s/it]Extracting train features for class potato:  72%|███████▏  | 217/300 [05:34<01:55,  1.40s/it]Extracting train features for class potato:  73%|███████▎  | 218/300 [05:36<02:02,  1.49s/it]Extracting train features for class potato:  73%|███████▎  | 219/300 [05:37<02:03,  1.53s/it]Extracting train features for class potato:  73%|███████▎  | 220/300 [05:39<02:00,  1.50s/it]Extracting train features for class potato:  74%|███████▎  | 221/300 [05:40<01:57,  1.48s/it]Extracting train features for class potato:  74%|███████▍  | 222/300 [05:42<01:55,  1.49s/it]Extracting train features for class potato:  74%|███████▍  | 223/300 [05:43<01:52,  1.47s/it]Extracting train features for class potato:  75%|███████▍  | 224/300 [05:45<01:52,  1.49s/it]Extracting train features for class potato:  75%|███████▌  | 225/300 [05:46<01:48,  1.45s/it]Extracting train features for class potato:  75%|███████▌  | 226/300 [05:48<01:49,  1.48s/it]Extracting train features for class potato:  76%|███████▌  | 227/300 [05:49<01:49,  1.49s/it]Extracting train features for class potato:  76%|███████▌  | 228/300 [05:50<01:43,  1.44s/it]Extracting train features for class potato:  76%|███████▋  | 229/300 [05:52<01:44,  1.47s/it]Extracting train features for class potato:  77%|███████▋  | 230/300 [05:54<01:50,  1.58s/it]Extracting train features for class potato:  77%|███████▋  | 231/300 [05:55<01:50,  1.60s/it]Extracting train features for class potato:  77%|███████▋  | 232/300 [05:57<01:47,  1.59s/it]Extracting train features for class potato:  78%|███████▊  | 233/300 [05:59<01:47,  1.60s/it]Extracting train features for class potato:  78%|███████▊  | 234/300 [06:00<01:45,  1.60s/it]Extracting train features for class potato:  78%|███████▊  | 235/300 [06:02<01:42,  1.57s/it]Extracting train features for class potato:  79%|███████▊  | 236/300 [06:03<01:37,  1.52s/it]Extracting train features for class potato:  79%|███████▉  | 237/300 [06:05<01:34,  1.49s/it]Extracting train features for class potato:  79%|███████▉  | 238/300 [06:06<01:30,  1.46s/it]Extracting train features for class potato:  80%|███████▉  | 239/300 [06:07<01:27,  1.44s/it]Extracting train features for class potato:  80%|████████  | 240/300 [06:09<01:25,  1.42s/it]Extracting train features for class potato:  80%|████████  | 241/300 [06:10<01:23,  1.42s/it]Extracting train features for class potato:  81%|████████  | 242/300 [06:12<01:23,  1.44s/it]Extracting train features for class potato:  81%|████████  | 243/300 [06:13<01:22,  1.44s/it]Extracting train features for class potato:  81%|████████▏ | 244/300 [06:15<01:22,  1.48s/it]Extracting train features for class potato:  82%|████████▏ | 245/300 [06:16<01:25,  1.55s/it]Extracting train features for class potato:  82%|████████▏ | 246/300 [06:18<01:23,  1.54s/it]Extracting train features for class potato:  82%|████████▏ | 247/300 [06:19<01:19,  1.49s/it]Extracting train features for class potato:  83%|████████▎ | 248/300 [06:21<01:15,  1.46s/it]Extracting train features for class potato:  83%|████████▎ | 249/300 [06:22<01:14,  1.46s/it]Extracting train features for class potato:  83%|████████▎ | 250/300 [06:24<01:14,  1.50s/it]Extracting train features for class potato:  84%|████████▎ | 251/300 [06:25<01:11,  1.46s/it]Extracting train features for class potato:  84%|████████▍ | 252/300 [06:26<01:08,  1.43s/it]Extracting train features for class potato:  84%|████████▍ | 253/300 [06:28<01:08,  1.46s/it]Extracting train features for class potato:  85%|████████▍ | 254/300 [06:30<01:10,  1.53s/it]Extracting train features for class potato:  85%|████████▌ | 255/300 [06:31<01:09,  1.55s/it]Extracting train features for class potato:  85%|████████▌ | 256/300 [06:33<01:08,  1.55s/it]Extracting train features for class potato:  86%|████████▌ | 257/300 [06:35<01:08,  1.60s/it]Extracting train features for class potato:  86%|████████▌ | 258/300 [06:36<01:08,  1.63s/it]Extracting train features for class potato:  86%|████████▋ | 259/300 [06:38<01:08,  1.66s/it]Extracting train features for class potato:  87%|████████▋ | 260/300 [06:40<01:07,  1.69s/it]Extracting train features for class potato:  87%|████████▋ | 261/300 [06:41<01:05,  1.68s/it]Extracting train features for class potato:  87%|████████▋ | 262/300 [06:43<01:02,  1.63s/it]Extracting train features for class potato:  88%|████████▊ | 263/300 [06:44<00:59,  1.61s/it]Extracting train features for class potato:  88%|████████▊ | 264/300 [06:46<00:56,  1.57s/it]Extracting train features for class potato:  88%|████████▊ | 265/300 [06:47<00:53,  1.53s/it]Extracting train features for class potato:  89%|████████▊ | 266/300 [06:49<00:52,  1.54s/it]Extracting train features for class potato:  89%|████████▉ | 267/300 [06:51<00:51,  1.56s/it]Extracting train features for class potato:  89%|████████▉ | 268/300 [06:52<00:53,  1.67s/it]Extracting train features for class potato:  90%|████████▉ | 269/300 [06:55<00:56,  1.83s/it]Extracting train features for class potato:  90%|█████████ | 270/300 [06:57<00:55,  1.86s/it]Extracting train features for class potato:  90%|█████████ | 271/300 [06:58<00:52,  1.81s/it]Extracting train features for class potato:  91%|█████████ | 272/300 [07:00<00:46,  1.66s/it]Extracting train features for class potato:  91%|█████████ | 273/300 [07:01<00:42,  1.56s/it]Extracting train features for class potato:  91%|█████████▏| 274/300 [07:02<00:39,  1.51s/it]Extracting train features for class potato:  92%|█████████▏| 275/300 [07:04<00:36,  1.47s/it]Extracting train features for class potato:  92%|█████████▏| 276/300 [07:05<00:34,  1.43s/it]Extracting train features for class potato:  92%|█████████▏| 277/300 [07:06<00:32,  1.42s/it]Extracting train features for class potato:  93%|█████████▎| 278/300 [07:08<00:31,  1.43s/it]Extracting train features for class potato:  93%|█████████▎| 279/300 [07:09<00:30,  1.45s/it]Extracting train features for class potato:  93%|█████████▎| 280/300 [07:11<00:30,  1.53s/it]Extracting train features for class potato:  94%|█████████▎| 281/300 [07:13<00:29,  1.58s/it]Extracting train features for class potato:  94%|█████████▍| 282/300 [07:14<00:28,  1.58s/it]Extracting train features for class potato:  94%|█████████▍| 283/300 [07:16<00:26,  1.56s/it]Extracting train features for class potato:  95%|█████████▍| 284/300 [07:17<00:24,  1.52s/it]Extracting train features for class potato:  95%|█████████▌| 285/300 [07:19<00:21,  1.45s/it]Extracting train features for class potato:  95%|█████████▌| 286/300 [07:20<00:19,  1.41s/it]Extracting train features for class potato:  96%|█████████▌| 287/300 [07:21<00:18,  1.41s/it]Extracting train features for class potato:  96%|█████████▌| 288/300 [07:23<00:16,  1.41s/it]Extracting train features for class potato:  96%|█████████▋| 289/300 [07:24<00:15,  1.45s/it]Extracting train features for class potato:  97%|█████████▋| 290/300 [07:26<00:14,  1.47s/it]Extracting train features for class potato:  97%|█████████▋| 291/300 [07:27<00:13,  1.53s/it]Extracting train features for class potato:  97%|█████████▋| 292/300 [07:29<00:12,  1.61s/it]Extracting train features for class potato:  98%|█████████▊| 293/300 [07:31<00:11,  1.59s/it]Extracting train features for class potato:  98%|█████████▊| 294/300 [07:32<00:09,  1.53s/it]Extracting train features for class potato:  98%|█████████▊| 295/300 [07:34<00:07,  1.49s/it]Extracting train features for class potato:  99%|█████████▊| 296/300 [07:35<00:06,  1.51s/it]Extracting train features for class potato:  99%|█████████▉| 297/300 [07:37<00:04,  1.62s/it]Extracting train features for class potato:  99%|█████████▉| 298/300 [07:39<00:03,  1.70s/it]Extracting train features for class potato: 100%|█████████▉| 299/300 [07:40<00:01,  1.61s/it]Extracting train features for class potato: 100%|██████████| 300/300 [07:42<00:00,  1.54s/it]Extracting train features for class potato: 100%|██████████| 300/300 [07:42<00:00,  1.54s/it]


Running coreset for Fusion on class potato...
Traceback (most recent call last):
  File "main.py", line 99, in <module>
    run_3d_ads(args)
  File "main.py", line 31, in run_3d_ads
    model.fit(cls)
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/m3dm_runner.py", line 60, in fit
    method.run_coreset()
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/feature_extractors/features_dino_fusion.py", line 174, in run_coreset
    self.coreset_idx = get_coreset_idx_randomp(self.patch_lib,
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/utils/utils.py", line 48, in get_coreset_idx_randomp
    z_lib = torch.tensor(transformer.fit_transform(z_lib))
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/random_projection.py", line 359, in fit
    X = self._validate_data(
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
  File "/usr/local/python38/lib/python3.8/site-packages/torch/_tensor.py", line 645, in __array__
    return self.numpy().astype(dtype, copy=False)
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
/usr/local/python38/lib/python3.8/site-packages/torch/utils/cpp_extension.py:284: UserWarning: 

                               !! WARNING !!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Your compiler (c++) is not compatible with the compiler Pytorch was
built with for this platform, which is g++ on linux. Please
use g++ to to compile your extension. Alternatively, you may
compile PyTorch from source using c++, and then you can also use
c++ to compile your extension.

See https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md for help
with compiling PyTorch from source.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

                              !! WARNING !!

  warnings.warn(WRONG_COMPILER_WARNING.format(
unexpected_keys
['mask_token', 'decoder_pos_embed.0.weight', 'decoder_pos_embed.0.bias', 'decoder_pos_embed.2.weight', 'decoder_pos_embed.2.bias', 'MAE_decoder.blocks.0.norm1.weight', 'MAE_decoder.blocks.0.norm1.bias', 'MAE_decoder.blocks.0.norm2.weight', 'MAE_decoder.blocks.0.norm2.bias', 'MAE_decoder.blocks.0.mlp.fc1.weight', 'MAE_decoder.blocks.0.mlp.fc1.bias', 'MAE_decoder.blocks.0.mlp.fc2.weight', 'MAE_decoder.blocks.0.mlp.fc2.bias', 'MAE_decoder.blocks.0.attn.qkv.weight', 'MAE_decoder.blocks.0.attn.proj.weight', 'MAE_decoder.blocks.0.attn.proj.bias', 'MAE_decoder.blocks.1.norm1.weight', 'MAE_decoder.blocks.1.norm1.bias', 'MAE_decoder.blocks.1.norm2.weight', 'MAE_decoder.blocks.1.norm2.bias', 'MAE_decoder.blocks.1.mlp.fc1.weight', 'MAE_decoder.blocks.1.mlp.fc1.bias', 'MAE_decoder.blocks.1.mlp.fc2.weight', 'MAE_decoder.blocks.1.mlp.fc2.bias', 'MAE_decoder.blocks.1.attn.qkv.weight', 'MAE_decoder.blocks.1.attn.proj.weight', 'MAE_decoder.blocks.1.attn.proj.bias', 'MAE_decoder.blocks.2.norm1.weight', 'MAE_decoder.blocks.2.norm1.bias', 'MAE_decoder.blocks.2.norm2.weight', 'MAE_decoder.blocks.2.norm2.bias', 'MAE_decoder.blocks.2.mlp.fc1.weight', 'MAE_decoder.blocks.2.mlp.fc1.bias', 'MAE_decoder.blocks.2.mlp.fc2.weight', 'MAE_decoder.blocks.2.mlp.fc2.bias', 'MAE_decoder.blocks.2.attn.qkv.weight', 'MAE_decoder.blocks.2.attn.proj.weight', 'MAE_decoder.blocks.2.attn.proj.bias', 'MAE_decoder.blocks.3.norm1.weight', 'MAE_decoder.blocks.3.norm1.bias', 'MAE_decoder.blocks.3.norm2.weight', 'MAE_decoder.blocks.3.norm2.bias', 'MAE_decoder.blocks.3.mlp.fc1.weight', 'MAE_decoder.blocks.3.mlp.fc1.bias', 'MAE_decoder.blocks.3.mlp.fc2.weight', 'MAE_decoder.blocks.3.mlp.fc2.bias', 'MAE_decoder.blocks.3.attn.qkv.weight', 'MAE_decoder.blocks.3.attn.proj.weight', 'MAE_decoder.blocks.3.attn.proj.bias', 'MAE_decoder.norm.weight', 'MAE_decoder.norm.bias', 'increase_dim.0.weight', 'increase_dim.0.bias']
[Transformer] Successful Loading the ckpt from checkpoints/pointmae_pretrain.pth
point: <All keys matched successfully>
7fusion_block: <All keys matched successfully>
Extracting train features for class rope:   0%|          | 0/298 [00:00<?, ?it/s]Extracting train features for class rope:   0%|          | 1/298 [00:01<08:56,  1.81s/it]Extracting train features for class rope:   1%|          | 2/298 [00:03<07:38,  1.55s/it]Extracting train features for class rope:   1%|          | 3/298 [00:04<07:41,  1.56s/it]Extracting train features for class rope:   1%|▏         | 4/298 [00:06<07:05,  1.45s/it]Extracting train features for class rope:   2%|▏         | 5/298 [00:07<06:50,  1.40s/it]Extracting train features for class rope:   2%|▏         | 6/298 [00:08<06:35,  1.36s/it]Extracting train features for class rope:   2%|▏         | 7/298 [00:09<06:27,  1.33s/it]Extracting train features for class rope:   3%|▎         | 8/298 [00:11<06:20,  1.31s/it]Extracting train features for class rope:   3%|▎         | 9/298 [00:12<06:15,  1.30s/it]Extracting train features for class rope:   3%|▎         | 10/298 [00:13<06:12,  1.29s/it]Extracting train features for class rope:   4%|▎         | 11/298 [00:15<06:12,  1.30s/it]Extracting train features for class rope:   4%|▍         | 12/298 [00:16<06:28,  1.36s/it]Extracting train features for class rope:   4%|▍         | 13/298 [00:17<06:19,  1.33s/it]Extracting train features for class rope:   5%|▍         | 14/298 [00:19<06:13,  1.32s/it]Extracting train features for class rope:   5%|▌         | 15/298 [00:20<06:27,  1.37s/it]Extracting train features for class rope:   5%|▌         | 16/298 [00:21<06:29,  1.38s/it]Extracting train features for class rope:   6%|▌         | 17/298 [00:23<06:18,  1.35s/it]Extracting train features for class rope:   6%|▌         | 18/298 [00:24<06:09,  1.32s/it]Extracting train features for class rope:   6%|▋         | 19/298 [00:26<06:25,  1.38s/it]Extracting train features for class rope:   7%|▋         | 20/298 [00:27<06:15,  1.35s/it]Extracting train features for class rope:   7%|▋         | 21/298 [00:28<06:07,  1.33s/it]Extracting train features for class rope:   7%|▋         | 22/298 [00:29<06:01,  1.31s/it]Extracting train features for class rope:   8%|▊         | 23/298 [00:31<06:23,  1.39s/it]Extracting train features for class rope:   8%|▊         | 24/298 [00:32<06:16,  1.38s/it]Extracting train features for class rope:   8%|▊         | 25/298 [00:34<06:10,  1.36s/it]Extracting train features for class rope:   9%|▊         | 26/298 [00:35<06:01,  1.33s/it]Extracting train features for class rope:   9%|▉         | 27/298 [00:36<06:16,  1.39s/it]Extracting train features for class rope:   9%|▉         | 28/298 [00:38<06:23,  1.42s/it]Extracting train features for class rope:  10%|▉         | 29/298 [00:39<06:09,  1.37s/it]Extracting train features for class rope:  10%|█         | 30/298 [00:40<05:59,  1.34s/it]Extracting train features for class rope:  10%|█         | 31/298 [00:42<06:10,  1.39s/it]Extracting train features for class rope:  11%|█         | 32/298 [00:43<06:11,  1.40s/it]Extracting train features for class rope:  11%|█         | 33/298 [00:45<06:00,  1.36s/it]Extracting train features for class rope:  11%|█▏        | 34/298 [00:46<05:51,  1.33s/it]Extracting train features for class rope:  12%|█▏        | 35/298 [00:47<06:03,  1.38s/it]Extracting train features for class rope:  12%|█▏        | 36/298 [00:49<05:52,  1.35s/it]Extracting train features for class rope:  12%|█▏        | 37/298 [00:50<05:47,  1.33s/it]Extracting train features for class rope:  13%|█▎        | 38/298 [00:51<05:41,  1.31s/it]Extracting train features for class rope:  13%|█▎        | 39/298 [00:53<06:01,  1.40s/it]Extracting train features for class rope:  13%|█▎        | 40/298 [00:54<05:51,  1.36s/it]Extracting train features for class rope:  14%|█▍        | 41/298 [00:55<05:43,  1.34s/it]Extracting train features for class rope:  14%|█▍        | 42/298 [00:57<05:37,  1.32s/it]Extracting train features for class rope:  14%|█▍        | 43/298 [00:58<05:56,  1.40s/it]Extracting train features for class rope:  15%|█▍        | 44/298 [01:00<06:01,  1.42s/it]Extracting train features for class rope:  15%|█▌        | 45/298 [01:01<05:49,  1.38s/it]Extracting train features for class rope:  15%|█▌        | 46/298 [01:02<05:41,  1.35s/it]Extracting train features for class rope:  16%|█▌        | 47/298 [01:04<05:40,  1.36s/it]Extracting train features for class rope:  16%|█▌        | 48/298 [01:05<05:51,  1.41s/it]Extracting train features for class rope:  16%|█▋        | 49/298 [01:06<05:40,  1.37s/it]Extracting train features for class rope:  17%|█▋        | 50/298 [01:08<05:32,  1.34s/it]Extracting train features for class rope:  17%|█▋        | 51/298 [01:09<05:26,  1.32s/it]Extracting train features for class rope:  17%|█▋        | 52/298 [01:10<05:38,  1.38s/it]Extracting train features for class rope:  18%|█▊        | 53/298 [01:12<05:28,  1.34s/it]Extracting train features for class rope:  18%|█▊        | 54/298 [01:13<05:21,  1.32s/it]Extracting train features for class rope:  18%|█▊        | 55/298 [01:14<05:16,  1.30s/it]Extracting train features for class rope:  19%|█▉        | 56/298 [01:16<05:37,  1.40s/it]Extracting train features for class rope:  19%|█▉        | 57/298 [01:17<05:28,  1.36s/it]Extracting train features for class rope:  19%|█▉        | 58/298 [01:18<05:20,  1.33s/it]Extracting train features for class rope:  20%|█▉        | 59/298 [01:20<05:14,  1.32s/it]Extracting train features for class rope:  20%|██        | 60/298 [01:21<05:31,  1.39s/it]Extracting train features for class rope:  20%|██        | 61/298 [01:23<05:32,  1.40s/it]Extracting train features for class rope:  21%|██        | 62/298 [01:24<05:21,  1.36s/it]Extracting train features for class rope:  21%|██        | 63/298 [01:25<05:12,  1.33s/it]Extracting train features for class rope:  21%|██▏       | 64/298 [01:27<05:24,  1.39s/it]Extracting train features for class rope:  22%|██▏       | 65/298 [01:28<05:27,  1.40s/it]Extracting train features for class rope:  22%|██▏       | 66/298 [01:29<05:16,  1.36s/it]Extracting train features for class rope:  22%|██▏       | 67/298 [01:31<05:11,  1.35s/it]Extracting train features for class rope:  23%|██▎       | 68/298 [01:32<05:20,  1.39s/it]Extracting train features for class rope:  23%|██▎       | 69/298 [01:34<05:22,  1.41s/it]Extracting train features for class rope:  23%|██▎       | 70/298 [01:35<05:12,  1.37s/it]Extracting train features for class rope:  24%|██▍       | 71/298 [01:36<05:04,  1.34s/it]Extracting train features for class rope:  24%|██▍       | 72/298 [01:38<05:14,  1.39s/it]Extracting train features for class rope:  24%|██▍       | 73/298 [01:39<05:12,  1.39s/it]Extracting train features for class rope:  25%|██▍       | 74/298 [01:40<05:03,  1.35s/it]Extracting train features for class rope:  25%|██▌       | 75/298 [01:42<04:56,  1.33s/it]Extracting train features for class rope:  26%|██▌       | 76/298 [01:43<05:07,  1.38s/it]Extracting train features for class rope:  26%|██▌       | 77/298 [01:44<05:00,  1.36s/it]Extracting train features for class rope:  26%|██▌       | 78/298 [01:46<04:52,  1.33s/it]Extracting train features for class rope:  27%|██▋       | 79/298 [01:47<04:51,  1.33s/it]Extracting train features for class rope:  27%|██▋       | 80/298 [01:49<05:04,  1.40s/it]Extracting train features for class rope:  27%|██▋       | 81/298 [01:50<04:58,  1.38s/it]Extracting train features for class rope:  28%|██▊       | 82/298 [01:51<04:50,  1.34s/it]Extracting train features for class rope:  28%|██▊       | 83/298 [01:53<04:43,  1.32s/it]Extracting train features for class rope:  28%|██▊       | 84/298 [01:54<04:58,  1.40s/it]Extracting train features for class rope:  29%|██▊       | 85/298 [01:55<04:53,  1.38s/it]Extracting train features for class rope:  29%|██▉       | 86/298 [01:57<04:45,  1.35s/it]Extracting train features for class rope:  29%|██▉       | 87/298 [01:58<04:38,  1.32s/it]Extracting train features for class rope:  30%|██▉       | 88/298 [02:00<04:52,  1.39s/it]Extracting train features for class rope:  30%|██▉       | 89/298 [02:01<04:51,  1.39s/it]Extracting train features for class rope:  30%|███       | 90/298 [02:02<04:41,  1.36s/it]Extracting train features for class rope:  31%|███       | 91/298 [02:03<04:35,  1.33s/it]Extracting train features for class rope:  31%|███       | 92/298 [02:05<04:47,  1.40s/it]Extracting train features for class rope:  31%|███       | 93/298 [02:06<04:42,  1.38s/it]Extracting train features for class rope:  32%|███▏      | 94/298 [02:08<04:34,  1.35s/it]Extracting train features for class rope:  32%|███▏      | 95/298 [02:09<04:27,  1.32s/it]Extracting train features for class rope:  32%|███▏      | 96/298 [02:10<04:42,  1.40s/it]Extracting train features for class rope:  33%|███▎      | 97/298 [02:12<04:32,  1.35s/it]Extracting train features for class rope:  33%|███▎      | 98/298 [02:13<04:25,  1.33s/it]Extracting train features for class rope:  33%|███▎      | 99/298 [02:14<04:19,  1.31s/it]Extracting train features for class rope:  34%|███▎      | 100/298 [02:16<04:34,  1.39s/it]Extracting train features for class rope:  34%|███▍      | 101/298 [02:17<04:33,  1.39s/it]Extracting train features for class rope:  34%|███▍      | 102/298 [02:18<04:25,  1.35s/it]Extracting train features for class rope:  35%|███▍      | 103/298 [02:20<04:20,  1.34s/it]Extracting train features for class rope:  35%|███▍      | 104/298 [02:21<04:26,  1.38s/it]Extracting train features for class rope:  35%|███▌      | 105/298 [02:23<04:31,  1.41s/it]Extracting train features for class rope:  36%|███▌      | 106/298 [02:24<04:21,  1.36s/it]Extracting train features for class rope:  36%|███▌      | 107/298 [02:25<04:14,  1.33s/it]Extracting train features for class rope:  36%|███▌      | 108/298 [02:27<04:23,  1.39s/it]Extracting train features for class rope:  37%|███▋      | 109/298 [02:28<04:24,  1.40s/it]Extracting train features for class rope:  37%|███▋      | 110/298 [02:29<04:15,  1.36s/it]Extracting train features for class rope:  37%|███▋      | 111/298 [02:31<04:08,  1.33s/it]Extracting train features for class rope:  38%|███▊      | 112/298 [02:32<04:18,  1.39s/it]Extracting train features for class rope:  38%|███▊      | 113/298 [02:34<04:18,  1.40s/it]Extracting train features for class rope:  38%|███▊      | 114/298 [02:35<04:10,  1.36s/it]Extracting train features for class rope:  39%|███▊      | 115/298 [02:36<04:03,  1.33s/it]Extracting train features for class rope:  39%|███▉      | 116/298 [02:38<04:12,  1.39s/it]Extracting train features for class rope:  39%|███▉      | 117/298 [02:39<04:09,  1.38s/it]Extracting train features for class rope:  40%|███▉      | 118/298 [02:40<04:02,  1.35s/it]Extracting train features for class rope:  40%|███▉      | 119/298 [02:42<03:56,  1.32s/it]Extracting train features for class rope:  40%|████      | 120/298 [02:43<04:07,  1.39s/it]Extracting train features for class rope:  41%|████      | 121/298 [02:44<04:00,  1.36s/it]Extracting train features for class rope:  41%|████      | 122/298 [02:46<03:53,  1.33s/it]Extracting train features for class rope:  41%|████▏     | 123/298 [02:47<03:49,  1.31s/it]Extracting train features for class rope:  42%|████▏     | 124/298 [02:49<04:02,  1.39s/it]Extracting train features for class rope:  42%|████▏     | 125/298 [02:50<04:04,  1.41s/it]Extracting train features for class rope:  42%|████▏     | 126/298 [02:51<03:55,  1.37s/it]Extracting train features for class rope:  43%|████▎     | 127/298 [02:53<03:48,  1.34s/it]Extracting train features for class rope:  43%|████▎     | 128/298 [02:54<03:50,  1.36s/it]Extracting train features for class rope:  43%|████▎     | 129/298 [02:55<03:56,  1.40s/it]Extracting train features for class rope:  44%|████▎     | 130/298 [02:57<03:47,  1.36s/it]Extracting train features for class rope:  44%|████▍     | 131/298 [02:58<03:42,  1.33s/it]Extracting train features for class rope:  44%|████▍     | 132/298 [02:59<03:47,  1.37s/it]Extracting train features for class rope:  45%|████▍     | 133/298 [03:01<03:53,  1.41s/it]Extracting train features for class rope:  45%|████▍     | 134/298 [03:02<03:46,  1.38s/it]Extracting train features for class rope:  45%|████▌     | 135/298 [03:03<03:39,  1.35s/it]Extracting train features for class rope:  46%|████▌     | 136/298 [03:05<03:45,  1.39s/it]Extracting train features for class rope:  46%|████▌     | 137/298 [03:06<03:46,  1.40s/it]Extracting train features for class rope:  46%|████▋     | 138/298 [03:08<03:37,  1.36s/it]Extracting train features for class rope:  47%|████▋     | 139/298 [03:09<03:31,  1.33s/it]Extracting train features for class rope:  47%|████▋     | 140/298 [03:10<03:37,  1.38s/it]Extracting train features for class rope:  47%|████▋     | 141/298 [03:12<03:37,  1.39s/it]Extracting train features for class rope:  48%|████▊     | 142/298 [03:13<03:30,  1.35s/it]Extracting train features for class rope:  48%|████▊     | 143/298 [03:14<03:24,  1.32s/it]Extracting train features for class rope:  48%|████▊     | 144/298 [03:16<03:31,  1.37s/it]Extracting train features for class rope:  49%|████▊     | 145/298 [03:17<03:26,  1.35s/it]Extracting train features for class rope:  49%|████▉     | 146/298 [03:18<03:21,  1.32s/it]Extracting train features for class rope:  49%|████▉     | 147/298 [03:20<03:24,  1.35s/it]Extracting train features for class rope:  50%|████▉     | 148/298 [03:21<03:28,  1.39s/it]Extracting train features for class rope:  50%|█████     | 149/298 [03:23<03:21,  1.35s/it]Extracting train features for class rope:  50%|█████     | 150/298 [03:24<03:16,  1.33s/it]Extracting train features for class rope:  51%|█████     | 151/298 [03:25<03:21,  1.37s/it]Extracting train features for class rope:  51%|█████     | 152/298 [03:27<03:24,  1.40s/it]Extracting train features for class rope:  51%|█████▏    | 153/298 [03:28<03:17,  1.36s/it]Extracting train features for class rope:  52%|█████▏    | 154/298 [03:29<03:11,  1.33s/it]Extracting train features for class rope:  52%|█████▏    | 155/298 [03:31<03:19,  1.39s/it]Extracting train features for class rope:  52%|█████▏    | 156/298 [03:32<03:22,  1.43s/it]Extracting train features for class rope:  53%|█████▎    | 157/298 [03:34<03:14,  1.38s/it]Extracting train features for class rope:  53%|█████▎    | 158/298 [03:35<03:10,  1.36s/it]Extracting train features for class rope:  53%|█████▎    | 159/298 [03:36<03:09,  1.37s/it]Extracting train features for class rope:  54%|█████▎    | 160/298 [03:38<03:13,  1.40s/it]Extracting train features for class rope:  54%|█████▍    | 161/298 [03:39<03:06,  1.36s/it]Extracting train features for class rope:  54%|█████▍    | 162/298 [03:40<03:01,  1.34s/it]Extracting train features for class rope:  55%|█████▍    | 163/298 [03:42<03:02,  1.35s/it]Extracting train features for class rope:  55%|█████▌    | 164/298 [03:43<03:06,  1.39s/it]Extracting train features for class rope:  55%|█████▌    | 165/298 [03:44<02:59,  1.35s/it]Extracting train features for class rope:  56%|█████▌    | 166/298 [03:46<02:55,  1.33s/it]Extracting train features for class rope:  56%|█████▌    | 167/298 [03:47<03:00,  1.38s/it]Extracting train features for class rope:  56%|█████▋    | 168/298 [03:49<03:02,  1.40s/it]Extracting train features for class rope:  57%|█████▋    | 169/298 [03:50<02:55,  1.36s/it]Extracting train features for class rope:  57%|█████▋    | 170/298 [03:51<02:50,  1.33s/it]Extracting train features for class rope:  57%|█████▋    | 171/298 [03:53<02:55,  1.38s/it]Extracting train features for class rope:  58%|█████▊    | 172/298 [03:54<02:55,  1.39s/it]Extracting train features for class rope:  58%|█████▊    | 173/298 [03:55<02:49,  1.36s/it]Extracting train features for class rope:  58%|█████▊    | 174/298 [03:57<02:44,  1.33s/it]Extracting train features for class rope:  59%|█████▊    | 175/298 [03:58<02:49,  1.38s/it]Extracting train features for class rope:  59%|█████▉    | 176/298 [04:00<02:51,  1.40s/it]Extracting train features for class rope:  59%|█████▉    | 177/298 [04:01<02:44,  1.36s/it]Extracting train features for class rope:  60%|█████▉    | 178/298 [04:02<02:39,  1.33s/it]Extracting train features for class rope:  60%|██████    | 179/298 [04:04<02:45,  1.39s/it]Extracting train features for class rope:  60%|██████    | 180/298 [04:05<02:52,  1.46s/it]Extracting train features for class rope:  61%|██████    | 181/298 [04:07<02:45,  1.41s/it]Extracting train features for class rope:  61%|██████    | 182/298 [04:08<02:39,  1.38s/it]Extracting train features for class rope:  61%|██████▏   | 183/298 [04:09<02:35,  1.36s/it]Extracting train features for class rope:  62%|██████▏   | 184/298 [04:11<02:44,  1.45s/it]Extracting train features for class rope:  62%|██████▏   | 185/298 [04:12<02:47,  1.48s/it]Extracting train features for class rope:  62%|██████▏   | 186/298 [04:14<02:41,  1.44s/it]Extracting train features for class rope:  63%|██████▎   | 187/298 [04:15<02:36,  1.41s/it]Extracting train features for class rope:  63%|██████▎   | 188/298 [04:16<02:33,  1.40s/it]Extracting train features for class rope:  63%|██████▎   | 189/298 [04:18<02:38,  1.46s/it]Extracting train features for class rope:  64%|██████▍   | 190/298 [04:20<02:45,  1.53s/it]Extracting train features for class rope:  64%|██████▍   | 191/298 [04:21<02:44,  1.54s/it]Extracting train features for class rope:  64%|██████▍   | 192/298 [04:23<02:38,  1.49s/it]Extracting train features for class rope:  65%|██████▍   | 193/298 [04:24<02:33,  1.47s/it]Extracting train features for class rope:  65%|██████▌   | 194/298 [04:26<02:32,  1.47s/it]Extracting train features for class rope:  65%|██████▌   | 195/298 [04:27<02:32,  1.48s/it]Extracting train features for class rope:  66%|██████▌   | 196/298 [04:29<02:30,  1.48s/it]Extracting train features for class rope:  66%|██████▌   | 197/298 [04:30<02:31,  1.50s/it]Extracting train features for class rope:  66%|██████▋   | 198/298 [04:32<02:38,  1.58s/it]Extracting train features for class rope:  67%|██████▋   | 199/298 [04:34<02:42,  1.65s/it]Extracting train features for class rope:  67%|██████▋   | 200/298 [04:35<02:39,  1.63s/it]Extracting train features for class rope:  67%|██████▋   | 201/298 [04:37<02:28,  1.53s/it]Extracting train features for class rope:  68%|██████▊   | 202/298 [04:38<02:20,  1.47s/it]Extracting train features for class rope:  68%|██████▊   | 203/298 [04:39<02:15,  1.42s/it]Extracting train features for class rope:  68%|██████▊   | 204/298 [04:41<02:20,  1.49s/it]Extracting train features for class rope:  69%|██████▉   | 205/298 [04:42<02:19,  1.50s/it]Extracting train features for class rope:  69%|██████▉   | 206/298 [04:44<02:11,  1.43s/it]Extracting train features for class rope:  69%|██████▉   | 207/298 [04:45<02:05,  1.38s/it]Extracting train features for class rope:  70%|██████▉   | 208/298 [04:46<02:04,  1.39s/it]Extracting train features for class rope:  70%|███████   | 209/298 [04:48<02:06,  1.42s/it]Extracting train features for class rope:  70%|███████   | 210/298 [04:49<02:01,  1.39s/it]Extracting train features for class rope:  71%|███████   | 211/298 [04:50<01:57,  1.35s/it]Extracting train features for class rope:  71%|███████   | 212/298 [04:52<01:54,  1.33s/it]Extracting train features for class rope:  71%|███████▏  | 213/298 [04:53<01:57,  1.38s/it]Extracting train features for class rope:  72%|███████▏  | 214/298 [04:54<01:53,  1.35s/it]Extracting train features for class rope:  72%|███████▏  | 215/298 [04:56<01:49,  1.32s/it]Extracting train features for class rope:  72%|███████▏  | 216/298 [04:57<01:47,  1.31s/it]Extracting train features for class rope:  73%|███████▎  | 217/298 [04:58<01:50,  1.37s/it]Extracting train features for class rope:  73%|███████▎  | 218/298 [05:00<01:46,  1.34s/it]Extracting train features for class rope:  73%|███████▎  | 219/298 [05:01<01:44,  1.32s/it]Extracting train features for class rope:  74%|███████▍  | 220/298 [05:02<01:42,  1.31s/it]Extracting train features for class rope:  74%|███████▍  | 221/298 [05:04<01:48,  1.41s/it]Extracting train features for class rope:  74%|███████▍  | 222/298 [05:05<01:44,  1.38s/it]Extracting train features for class rope:  75%|███████▍  | 223/298 [05:07<01:41,  1.35s/it]Extracting train features for class rope:  75%|███████▌  | 224/298 [05:08<01:38,  1.33s/it]Extracting train features for class rope:  76%|███████▌  | 225/298 [05:09<01:40,  1.38s/it]Extracting train features for class rope:  76%|███████▌  | 226/298 [05:11<01:43,  1.43s/it]Extracting train features for class rope:  76%|███████▌  | 227/298 [05:12<01:38,  1.39s/it]Extracting train features for class rope:  77%|███████▋  | 228/298 [05:13<01:35,  1.36s/it]Extracting train features for class rope:  77%|███████▋  | 229/298 [05:15<01:32,  1.34s/it]Extracting train features for class rope:  77%|███████▋  | 230/298 [05:16<01:37,  1.43s/it]Extracting train features for class rope:  78%|███████▊  | 231/298 [05:18<01:34,  1.41s/it]Extracting train features for class rope:  78%|███████▊  | 232/298 [05:19<01:31,  1.38s/it]Extracting train features for class rope:  78%|███████▊  | 233/298 [05:20<01:28,  1.36s/it]Extracting train features for class rope:  79%|███████▊  | 234/298 [05:22<01:30,  1.41s/it]Extracting train features for class rope:  79%|███████▉  | 235/298 [05:23<01:30,  1.43s/it]Extracting train features for class rope:  79%|███████▉  | 236/298 [05:25<01:25,  1.39s/it]Extracting train features for class rope:  80%|███████▉  | 237/298 [05:26<01:22,  1.36s/it]Extracting train features for class rope:  80%|███████▉  | 238/298 [05:27<01:22,  1.37s/it]Extracting train features for class rope:  80%|████████  | 239/298 [05:29<01:22,  1.39s/it]Extracting train features for class rope:  81%|████████  | 240/298 [05:30<01:18,  1.36s/it]Extracting train features for class rope:  81%|████████  | 241/298 [05:31<01:15,  1.33s/it]Extracting train features for class rope:  81%|████████  | 242/298 [05:33<01:17,  1.39s/it]Extracting train features for class rope:  82%|████████▏ | 243/298 [05:34<01:15,  1.37s/it]Extracting train features for class rope:  82%|████████▏ | 244/298 [05:35<01:12,  1.34s/it]Extracting train features for class rope:  82%|████████▏ | 245/298 [05:37<01:09,  1.32s/it]Extracting train features for class rope:  83%|████████▎ | 246/298 [05:38<01:12,  1.40s/it]Extracting train features for class rope:  83%|████████▎ | 247/298 [05:40<01:09,  1.36s/it]Extracting train features for class rope:  83%|████████▎ | 248/298 [05:41<01:06,  1.33s/it]Extracting train features for class rope:  84%|████████▎ | 249/298 [05:42<01:04,  1.32s/it]Extracting train features for class rope:  84%|████████▍ | 250/298 [05:44<01:07,  1.41s/it]Extracting train features for class rope:  84%|████████▍ | 251/298 [05:45<01:06,  1.41s/it]Extracting train features for class rope:  85%|████████▍ | 252/298 [05:46<01:02,  1.37s/it]Extracting train features for class rope:  85%|████████▍ | 253/298 [05:48<01:00,  1.34s/it]Extracting train features for class rope:  85%|████████▌ | 254/298 [05:49<01:01,  1.39s/it]Extracting train features for class rope:  86%|████████▌ | 255/298 [05:51<01:00,  1.42s/it]Extracting train features for class rope:  86%|████████▌ | 256/298 [05:52<00:57,  1.37s/it]Extracting train features for class rope:  86%|████████▌ | 257/298 [05:53<00:55,  1.34s/it]Extracting train features for class rope:  87%|████████▋ | 258/298 [05:55<00:55,  1.38s/it]Extracting train features for class rope:  87%|████████▋ | 259/298 [05:56<00:54,  1.41s/it]Extracting train features for class rope:  87%|████████▋ | 260/298 [05:57<00:51,  1.37s/it]Extracting train features for class rope:  88%|████████▊ | 261/298 [05:59<00:49,  1.34s/it]Extracting train features for class rope:  88%|████████▊ | 262/298 [06:00<00:49,  1.39s/it]Extracting train features for class rope:  88%|████████▊ | 263/298 [06:02<00:47,  1.37s/it]Extracting train features for class rope:  89%|████████▊ | 264/298 [06:03<00:45,  1.34s/it]Extracting train features for class rope:  89%|████████▉ | 265/298 [06:04<00:43,  1.32s/it]Extracting train features for class rope:  89%|████████▉ | 266/298 [06:06<00:44,  1.38s/it]Extracting train features for class rope:  90%|████████▉ | 267/298 [06:07<00:42,  1.38s/it]Extracting train features for class rope:  90%|████████▉ | 268/298 [06:08<00:40,  1.36s/it]Extracting train features for class rope:  90%|█████████ | 269/298 [06:10<00:38,  1.34s/it]Extracting train features for class rope:  91%|█████████ | 270/298 [06:11<00:37,  1.33s/it]Extracting train features for class rope:  91%|█████████ | 271/298 [06:12<00:37,  1.39s/it]Extracting train features for class rope:  91%|█████████▏| 272/298 [06:14<00:35,  1.36s/it]Extracting train features for class rope:  92%|█████████▏| 273/298 [06:15<00:33,  1.34s/it]Extracting train features for class rope:  92%|█████████▏| 274/298 [06:16<00:32,  1.34s/it]Extracting train features for class rope:  92%|█████████▏| 275/298 [06:18<00:32,  1.43s/it]Extracting train features for class rope:  93%|█████████▎| 276/298 [06:20<00:32,  1.48s/it]Extracting train features for class rope:  93%|█████████▎| 277/298 [06:21<00:29,  1.42s/it]Extracting train features for class rope:  93%|█████████▎| 278/298 [06:22<00:28,  1.41s/it]Extracting train features for class rope:  94%|█████████▎| 279/298 [06:24<00:27,  1.46s/it]Extracting train features for class rope:  94%|█████████▍| 280/298 [06:25<00:27,  1.51s/it]Extracting train features for class rope:  94%|█████████▍| 281/298 [06:27<00:24,  1.46s/it]Extracting train features for class rope:  95%|█████████▍| 282/298 [06:28<00:22,  1.41s/it]Extracting train features for class rope:  95%|█████████▍| 283/298 [06:30<00:21,  1.46s/it]Extracting train features for class rope:  95%|█████████▌| 284/298 [06:31<00:21,  1.53s/it]Extracting train features for class rope:  96%|█████████▌| 285/298 [06:33<00:19,  1.47s/it]Extracting train features for class rope:  96%|█████████▌| 286/298 [06:34<00:16,  1.41s/it]Extracting train features for class rope:  96%|█████████▋| 287/298 [06:36<00:16,  1.51s/it]Extracting train features for class rope:  97%|█████████▋| 288/298 [06:37<00:14,  1.47s/it]Extracting train features for class rope:  97%|█████████▋| 289/298 [06:38<00:12,  1.41s/it]Extracting train features for class rope:  97%|█████████▋| 290/298 [06:40<00:10,  1.37s/it]Extracting train features for class rope:  98%|█████████▊| 291/298 [06:41<00:09,  1.36s/it]Extracting train features for class rope:  98%|█████████▊| 292/298 [06:43<00:08,  1.40s/it]Extracting train features for class rope:  98%|█████████▊| 293/298 [06:44<00:06,  1.38s/it]Extracting train features for class rope:  99%|█████████▊| 294/298 [06:45<00:05,  1.35s/it]Extracting train features for class rope:  99%|█████████▉| 295/298 [06:46<00:03,  1.33s/it]Extracting train features for class rope:  99%|█████████▉| 296/298 [06:48<00:02,  1.36s/it]Extracting train features for class rope: 100%|█████████▉| 297/298 [06:49<00:01,  1.40s/it]Extracting train features for class rope: 100%|██████████| 298/298 [06:51<00:00,  1.38s/it]Extracting train features for class rope: 100%|██████████| 298/298 [06:51<00:00,  1.38s/it]


Running coreset for Fusion on class rope...
Traceback (most recent call last):
  File "main.py", line 99, in <module>
    run_3d_ads(args)
  File "main.py", line 31, in run_3d_ads
    model.fit(cls)
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/m3dm_runner.py", line 60, in fit
    method.run_coreset()
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/feature_extractors/features_dino_fusion.py", line 174, in run_coreset
    self.coreset_idx = get_coreset_idx_randomp(self.patch_lib,
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/utils/utils.py", line 48, in get_coreset_idx_randomp
    z_lib = torch.tensor(transformer.fit_transform(z_lib))
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/random_projection.py", line 359, in fit
    X = self._validate_data(
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
  File "/usr/local/python38/lib/python3.8/site-packages/torch/_tensor.py", line 645, in __array__
    return self.numpy().astype(dtype, copy=False)
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
/usr/local/python38/lib/python3.8/site-packages/torch/utils/cpp_extension.py:284: UserWarning: 

                               !! WARNING !!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Your compiler (c++) is not compatible with the compiler Pytorch was
built with for this platform, which is g++ on linux. Please
use g++ to to compile your extension. Alternatively, you may
compile PyTorch from source using c++, and then you can also use
c++ to compile your extension.

See https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md for help
with compiling PyTorch from source.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

                              !! WARNING !!

  warnings.warn(WRONG_COMPILER_WARNING.format(
unexpected_keys
['mask_token', 'decoder_pos_embed.0.weight', 'decoder_pos_embed.0.bias', 'decoder_pos_embed.2.weight', 'decoder_pos_embed.2.bias', 'MAE_decoder.blocks.0.norm1.weight', 'MAE_decoder.blocks.0.norm1.bias', 'MAE_decoder.blocks.0.norm2.weight', 'MAE_decoder.blocks.0.norm2.bias', 'MAE_decoder.blocks.0.mlp.fc1.weight', 'MAE_decoder.blocks.0.mlp.fc1.bias', 'MAE_decoder.blocks.0.mlp.fc2.weight', 'MAE_decoder.blocks.0.mlp.fc2.bias', 'MAE_decoder.blocks.0.attn.qkv.weight', 'MAE_decoder.blocks.0.attn.proj.weight', 'MAE_decoder.blocks.0.attn.proj.bias', 'MAE_decoder.blocks.1.norm1.weight', 'MAE_decoder.blocks.1.norm1.bias', 'MAE_decoder.blocks.1.norm2.weight', 'MAE_decoder.blocks.1.norm2.bias', 'MAE_decoder.blocks.1.mlp.fc1.weight', 'MAE_decoder.blocks.1.mlp.fc1.bias', 'MAE_decoder.blocks.1.mlp.fc2.weight', 'MAE_decoder.blocks.1.mlp.fc2.bias', 'MAE_decoder.blocks.1.attn.qkv.weight', 'MAE_decoder.blocks.1.attn.proj.weight', 'MAE_decoder.blocks.1.attn.proj.bias', 'MAE_decoder.blocks.2.norm1.weight', 'MAE_decoder.blocks.2.norm1.bias', 'MAE_decoder.blocks.2.norm2.weight', 'MAE_decoder.blocks.2.norm2.bias', 'MAE_decoder.blocks.2.mlp.fc1.weight', 'MAE_decoder.blocks.2.mlp.fc1.bias', 'MAE_decoder.blocks.2.mlp.fc2.weight', 'MAE_decoder.blocks.2.mlp.fc2.bias', 'MAE_decoder.blocks.2.attn.qkv.weight', 'MAE_decoder.blocks.2.attn.proj.weight', 'MAE_decoder.blocks.2.attn.proj.bias', 'MAE_decoder.blocks.3.norm1.weight', 'MAE_decoder.blocks.3.norm1.bias', 'MAE_decoder.blocks.3.norm2.weight', 'MAE_decoder.blocks.3.norm2.bias', 'MAE_decoder.blocks.3.mlp.fc1.weight', 'MAE_decoder.blocks.3.mlp.fc1.bias', 'MAE_decoder.blocks.3.mlp.fc2.weight', 'MAE_decoder.blocks.3.mlp.fc2.bias', 'MAE_decoder.blocks.3.attn.qkv.weight', 'MAE_decoder.blocks.3.attn.proj.weight', 'MAE_decoder.blocks.3.attn.proj.bias', 'MAE_decoder.norm.weight', 'MAE_decoder.norm.bias', 'increase_dim.0.weight', 'increase_dim.0.bias']
[Transformer] Successful Loading the ckpt from checkpoints/pointmae_pretrain.pth
point: <All keys matched successfully>
7fusion_block: <All keys matched successfully>
Extracting train features for class tire:   0%|          | 0/210 [00:00<?, ?it/s]Extracting train features for class tire:   0%|          | 1/210 [00:02<07:50,  2.25s/it]Extracting train features for class tire:   1%|          | 2/210 [00:04<06:54,  1.99s/it]Extracting train features for class tire:   1%|▏         | 3/210 [00:05<06:30,  1.89s/it]Extracting train features for class tire:   2%|▏         | 4/210 [00:07<06:16,  1.83s/it]Extracting train features for class tire:   2%|▏         | 5/210 [00:09<06:05,  1.78s/it]Extracting train features for class tire:   3%|▎         | 6/210 [00:10<05:54,  1.74s/it]Extracting train features for class tire:   3%|▎         | 7/210 [00:12<05:43,  1.69s/it]Extracting train features for class tire:   4%|▍         | 8/210 [00:14<05:36,  1.66s/it]Extracting train features for class tire:   4%|▍         | 9/210 [00:15<05:30,  1.64s/it]Extracting train features for class tire:   5%|▍         | 10/210 [00:17<05:25,  1.63s/it]Extracting train features for class tire:   5%|▌         | 11/210 [00:18<05:22,  1.62s/it]Extracting train features for class tire:   6%|▌         | 12/210 [00:20<05:19,  1.62s/it]Extracting train features for class tire:   6%|▌         | 13/210 [00:22<05:17,  1.61s/it]Extracting train features for class tire:   7%|▋         | 14/210 [00:23<05:15,  1.61s/it]Extracting train features for class tire:   7%|▋         | 15/210 [00:25<05:14,  1.61s/it]Extracting train features for class tire:   8%|▊         | 16/210 [00:26<05:12,  1.61s/it]Extracting train features for class tire:   8%|▊         | 17/210 [00:28<05:11,  1.61s/it]Extracting train features for class tire:   9%|▊         | 18/210 [00:30<05:09,  1.61s/it]Extracting train features for class tire:   9%|▉         | 19/210 [00:31<05:08,  1.61s/it]Extracting train features for class tire:  10%|▉         | 20/210 [00:33<05:06,  1.61s/it]Extracting train features for class tire:  10%|█         | 21/210 [00:34<05:03,  1.61s/it]Extracting train features for class tire:  10%|█         | 22/210 [00:36<05:00,  1.60s/it]Extracting train features for class tire:  11%|█         | 23/210 [00:38<04:58,  1.60s/it]Extracting train features for class tire:  11%|█▏        | 24/210 [00:39<04:56,  1.59s/it]Extracting train features for class tire:  12%|█▏        | 25/210 [00:41<04:55,  1.60s/it]Extracting train features for class tire:  12%|█▏        | 26/210 [00:42<04:53,  1.59s/it]Extracting train features for class tire:  13%|█▎        | 27/210 [00:44<04:51,  1.59s/it]Extracting train features for class tire:  13%|█▎        | 28/210 [00:46<04:49,  1.59s/it]Extracting train features for class tire:  14%|█▍        | 29/210 [00:47<04:47,  1.59s/it]Extracting train features for class tire:  14%|█▍        | 30/210 [00:49<04:46,  1.59s/it]Extracting train features for class tire:  15%|█▍        | 31/210 [00:50<04:44,  1.59s/it]Extracting train features for class tire:  15%|█▌        | 32/210 [00:52<04:42,  1.59s/it]Extracting train features for class tire:  16%|█▌        | 33/210 [00:54<04:42,  1.60s/it]Extracting train features for class tire:  16%|█▌        | 34/210 [00:55<04:40,  1.59s/it]Extracting train features for class tire:  17%|█▋        | 35/210 [00:57<04:38,  1.59s/it]Extracting train features for class tire:  17%|█▋        | 36/210 [00:58<04:36,  1.59s/it]Extracting train features for class tire:  18%|█▊        | 37/210 [01:00<04:36,  1.60s/it]Extracting train features for class tire:  18%|█▊        | 38/210 [01:02<04:36,  1.61s/it]Extracting train features for class tire:  19%|█▊        | 39/210 [01:03<04:34,  1.60s/it]Extracting train features for class tire:  19%|█▉        | 40/210 [01:05<04:32,  1.60s/it]Extracting train features for class tire:  20%|█▉        | 41/210 [01:06<04:29,  1.60s/it]Extracting train features for class tire:  20%|██        | 42/210 [01:08<04:27,  1.59s/it]Extracting train features for class tire:  20%|██        | 43/210 [01:10<04:25,  1.59s/it]Extracting train features for class tire:  21%|██        | 44/210 [01:11<04:26,  1.61s/it]Extracting train features for class tire:  21%|██▏       | 45/210 [01:13<04:25,  1.61s/it]Extracting train features for class tire:  22%|██▏       | 46/210 [01:14<04:26,  1.62s/it]Extracting train features for class tire:  22%|██▏       | 47/210 [01:16<04:26,  1.63s/it]Extracting train features for class tire:  23%|██▎       | 48/210 [01:18<04:27,  1.65s/it]Extracting train features for class tire:  23%|██▎       | 49/210 [01:20<04:27,  1.66s/it]Extracting train features for class tire:  24%|██▍       | 50/210 [01:21<04:28,  1.68s/it]Extracting train features for class tire:  24%|██▍       | 51/210 [01:23<04:29,  1.69s/it]Extracting train features for class tire:  25%|██▍       | 52/210 [01:25<04:32,  1.73s/it]Extracting train features for class tire:  25%|██▌       | 53/210 [01:27<04:34,  1.75s/it]Extracting train features for class tire:  26%|██▌       | 54/210 [01:28<04:36,  1.77s/it]Extracting train features for class tire:  26%|██▌       | 55/210 [01:30<04:36,  1.78s/it]Extracting train features for class tire:  27%|██▋       | 56/210 [01:32<04:35,  1.79s/it]Extracting train features for class tire:  27%|██▋       | 57/210 [01:34<04:36,  1.80s/it]Extracting train features for class tire:  28%|██▊       | 58/210 [01:36<04:36,  1.82s/it]Extracting train features for class tire:  28%|██▊       | 59/210 [01:38<04:36,  1.83s/it]Extracting train features for class tire:  29%|██▊       | 60/210 [01:39<04:34,  1.83s/it]Extracting train features for class tire:  29%|██▉       | 61/210 [01:41<04:30,  1.81s/it]Extracting train features for class tire:  30%|██▉       | 62/210 [01:43<04:29,  1.82s/it]Extracting train features for class tire:  30%|███       | 63/210 [01:45<04:26,  1.81s/it]Extracting train features for class tire:  30%|███       | 64/210 [01:47<04:22,  1.80s/it]Extracting train features for class tire:  31%|███       | 65/210 [01:48<04:19,  1.79s/it]Extracting train features for class tire:  31%|███▏      | 66/210 [01:50<04:18,  1.79s/it]Extracting train features for class tire:  32%|███▏      | 67/210 [01:52<04:18,  1.81s/it]Extracting train features for class tire:  32%|███▏      | 68/210 [01:54<04:17,  1.82s/it]Extracting train features for class tire:  33%|███▎      | 69/210 [01:56<04:13,  1.80s/it]Extracting train features for class tire:  33%|███▎      | 70/210 [01:57<04:12,  1.80s/it]Extracting train features for class tire:  34%|███▍      | 71/210 [01:59<04:11,  1.81s/it]Extracting train features for class tire:  34%|███▍      | 72/210 [02:01<04:11,  1.82s/it]Extracting train features for class tire:  35%|███▍      | 73/210 [02:03<04:12,  1.85s/it]Extracting train features for class tire:  35%|███▌      | 74/210 [02:05<04:14,  1.87s/it]Extracting train features for class tire:  36%|███▌      | 75/210 [02:07<04:16,  1.90s/it]Extracting train features for class tire:  36%|███▌      | 76/210 [02:09<04:19,  1.94s/it]Extracting train features for class tire:  37%|███▋      | 77/210 [02:11<04:23,  1.98s/it]Extracting train features for class tire:  37%|███▋      | 78/210 [02:13<04:25,  2.01s/it]Extracting train features for class tire:  38%|███▊      | 79/210 [02:15<04:25,  2.02s/it]Extracting train features for class tire:  38%|███▊      | 80/210 [02:17<04:25,  2.04s/it]Extracting train features for class tire:  39%|███▊      | 81/210 [02:19<04:23,  2.04s/it]Extracting train features for class tire:  39%|███▉      | 82/210 [02:21<04:21,  2.04s/it]Extracting train features for class tire:  40%|███▉      | 83/210 [02:23<04:20,  2.05s/it]Extracting train features for class tire:  40%|████      | 84/210 [02:25<04:20,  2.07s/it]Extracting train features for class tire:  40%|████      | 85/210 [02:28<04:20,  2.09s/it]Extracting train features for class tire:  41%|████      | 86/210 [02:30<04:19,  2.09s/it]Extracting train features for class tire:  41%|████▏     | 87/210 [02:32<04:17,  2.10s/it]Extracting train features for class tire:  42%|████▏     | 88/210 [02:34<04:16,  2.10s/it]Extracting train features for class tire:  42%|████▏     | 89/210 [02:36<04:14,  2.10s/it]Extracting train features for class tire:  43%|████▎     | 90/210 [02:38<04:12,  2.11s/it]Extracting train features for class tire:  43%|████▎     | 91/210 [02:40<04:10,  2.11s/it]Extracting train features for class tire:  44%|████▍     | 92/210 [02:42<04:09,  2.12s/it]Extracting train features for class tire:  44%|████▍     | 93/210 [02:44<04:08,  2.12s/it]Extracting train features for class tire:  45%|████▍     | 94/210 [02:47<04:04,  2.11s/it]Extracting train features for class tire:  45%|████▌     | 95/210 [02:49<04:02,  2.11s/it]Extracting train features for class tire:  46%|████▌     | 96/210 [02:51<03:59,  2.10s/it]Extracting train features for class tire:  46%|████▌     | 97/210 [02:53<03:58,  2.11s/it]Extracting train features for class tire:  47%|████▋     | 98/210 [02:55<03:56,  2.11s/it]Extracting train features for class tire:  47%|████▋     | 99/210 [02:57<03:55,  2.12s/it]Extracting train features for class tire:  48%|████▊     | 100/210 [02:59<03:52,  2.11s/it]Extracting train features for class tire:  48%|████▊     | 101/210 [03:01<03:49,  2.10s/it]Extracting train features for class tire:  49%|████▊     | 102/210 [03:03<03:46,  2.10s/it]Extracting train features for class tire:  49%|████▉     | 103/210 [03:06<03:43,  2.09s/it]Extracting train features for class tire:  50%|████▉     | 104/210 [03:08<03:40,  2.08s/it]Extracting train features for class tire:  50%|█████     | 105/210 [03:10<03:39,  2.09s/it]Extracting train features for class tire:  50%|█████     | 106/210 [03:12<03:38,  2.10s/it]Extracting train features for class tire:  51%|█████     | 107/210 [03:14<03:37,  2.11s/it]Extracting train features for class tire:  51%|█████▏    | 108/210 [03:16<03:35,  2.11s/it]Extracting train features for class tire:  52%|█████▏    | 109/210 [03:18<03:34,  2.12s/it]Extracting train features for class tire:  52%|█████▏    | 110/210 [03:20<03:32,  2.13s/it]Extracting train features for class tire:  53%|█████▎    | 111/210 [03:22<03:31,  2.13s/it]Extracting train features for class tire:  53%|█████▎    | 112/210 [03:25<03:28,  2.12s/it]Extracting train features for class tire:  54%|█████▍    | 113/210 [03:27<03:25,  2.12s/it]Extracting train features for class tire:  54%|█████▍    | 114/210 [03:29<03:23,  2.12s/it]Extracting train features for class tire:  55%|█████▍    | 115/210 [03:31<03:20,  2.11s/it]Extracting train features for class tire:  55%|█████▌    | 116/210 [03:33<03:17,  2.10s/it]Extracting train features for class tire:  56%|█████▌    | 117/210 [03:35<03:14,  2.09s/it]Extracting train features for class tire:  56%|█████▌    | 118/210 [03:37<03:11,  2.08s/it]Extracting train features for class tire:  57%|█████▋    | 119/210 [03:39<03:09,  2.09s/it]Extracting train features for class tire:  57%|█████▋    | 120/210 [03:41<03:07,  2.09s/it]Extracting train features for class tire:  58%|█████▊    | 121/210 [03:43<03:06,  2.09s/it]Extracting train features for class tire:  58%|█████▊    | 122/210 [03:46<03:05,  2.11s/it]Extracting train features for class tire:  59%|█████▊    | 123/210 [03:48<03:03,  2.11s/it]Extracting train features for class tire:  59%|█████▉    | 124/210 [03:50<03:01,  2.11s/it]Extracting train features for class tire:  60%|█████▉    | 125/210 [03:52<02:59,  2.11s/it]Extracting train features for class tire:  60%|██████    | 126/210 [03:54<02:56,  2.11s/it]Extracting train features for class tire:  60%|██████    | 127/210 [03:56<02:55,  2.11s/it]Extracting train features for class tire:  61%|██████    | 128/210 [03:58<02:53,  2.12s/it]Extracting train features for class tire:  61%|██████▏   | 129/210 [04:00<02:51,  2.12s/it]Extracting train features for class tire:  62%|██████▏   | 130/210 [04:02<02:49,  2.12s/it]Extracting train features for class tire:  62%|██████▏   | 131/210 [04:05<02:47,  2.12s/it]Extracting train features for class tire:  63%|██████▎   | 132/210 [04:07<02:44,  2.11s/it]Extracting train features for class tire:  63%|██████▎   | 133/210 [04:09<02:42,  2.10s/it]Extracting train features for class tire:  64%|██████▍   | 134/210 [04:11<02:38,  2.09s/it]Extracting train features for class tire:  64%|██████▍   | 135/210 [04:13<02:35,  2.07s/it]Extracting train features for class tire:  65%|██████▍   | 136/210 [04:15<02:31,  2.05s/it]Extracting train features for class tire:  65%|██████▌   | 137/210 [04:17<02:29,  2.04s/it]Extracting train features for class tire:  66%|██████▌   | 138/210 [04:19<02:25,  2.02s/it]Extracting train features for class tire:  66%|██████▌   | 139/210 [04:21<02:23,  2.02s/it]Extracting train features for class tire:  67%|██████▋   | 140/210 [04:23<02:22,  2.04s/it]Extracting train features for class tire:  67%|██████▋   | 141/210 [04:25<02:21,  2.06s/it]Extracting train features for class tire:  68%|██████▊   | 142/210 [04:27<02:20,  2.06s/it]Extracting train features for class tire:  68%|██████▊   | 143/210 [04:29<02:17,  2.06s/it]Extracting train features for class tire:  69%|██████▊   | 144/210 [04:31<02:15,  2.05s/it]Extracting train features for class tire:  69%|██████▉   | 145/210 [04:33<02:12,  2.04s/it]Extracting train features for class tire:  70%|██████▉   | 146/210 [04:35<02:09,  2.02s/it]Extracting train features for class tire:  70%|███████   | 147/210 [04:37<02:06,  2.00s/it]Extracting train features for class tire:  70%|███████   | 148/210 [04:39<02:02,  1.98s/it]Extracting train features for class tire:  71%|███████   | 149/210 [04:41<01:59,  1.95s/it]Extracting train features for class tire:  71%|███████▏  | 150/210 [04:43<01:55,  1.93s/it]Extracting train features for class tire:  72%|███████▏  | 151/210 [04:45<01:52,  1.91s/it]Extracting train features for class tire:  72%|███████▏  | 152/210 [04:47<01:50,  1.90s/it]Extracting train features for class tire:  73%|███████▎  | 153/210 [04:48<01:47,  1.88s/it]Extracting train features for class tire:  73%|███████▎  | 154/210 [04:50<01:44,  1.86s/it]Extracting train features for class tire:  74%|███████▍  | 155/210 [04:52<01:41,  1.85s/it]Extracting train features for class tire:  74%|███████▍  | 156/210 [04:54<01:39,  1.84s/it]Extracting train features for class tire:  75%|███████▍  | 157/210 [04:56<01:37,  1.84s/it]Extracting train features for class tire:  75%|███████▌  | 158/210 [04:58<01:34,  1.83s/it]Extracting train features for class tire:  76%|███████▌  | 159/210 [04:59<01:32,  1.82s/it]Extracting train features for class tire:  76%|███████▌  | 160/210 [05:01<01:29,  1.80s/it]Extracting train features for class tire:  77%|███████▋  | 161/210 [05:03<01:27,  1.78s/it]Extracting train features for class tire:  77%|███████▋  | 162/210 [05:05<01:24,  1.77s/it]Extracting train features for class tire:  78%|███████▊  | 163/210 [05:06<01:21,  1.74s/it]Extracting train features for class tire:  78%|███████▊  | 164/210 [05:08<01:18,  1.71s/it]Extracting train features for class tire:  79%|███████▊  | 165/210 [05:10<01:16,  1.70s/it]Extracting train features for class tire:  79%|███████▉  | 166/210 [05:11<01:14,  1.69s/it]Extracting train features for class tire:  80%|███████▉  | 167/210 [05:13<01:11,  1.67s/it]Extracting train features for class tire:  80%|████████  | 168/210 [05:14<01:09,  1.66s/it]Extracting train features for class tire:  80%|████████  | 169/210 [05:16<01:07,  1.66s/it]Extracting train features for class tire:  81%|████████  | 170/210 [05:18<01:06,  1.66s/it]Extracting train features for class tire:  81%|████████▏ | 171/210 [05:19<01:04,  1.65s/it]Extracting train features for class tire:  82%|████████▏ | 172/210 [05:21<01:02,  1.64s/it]Extracting train features for class tire:  82%|████████▏ | 173/210 [05:23<01:00,  1.63s/it]Extracting train features for class tire:  83%|████████▎ | 174/210 [05:24<00:58,  1.63s/it]Extracting train features for class tire:  83%|████████▎ | 175/210 [05:26<00:56,  1.62s/it]Extracting train features for class tire:  84%|████████▍ | 176/210 [05:27<00:55,  1.62s/it]Extracting train features for class tire:  84%|████████▍ | 177/210 [05:29<00:53,  1.63s/it]Extracting train features for class tire:  85%|████████▍ | 178/210 [05:31<00:53,  1.66s/it]Extracting train features for class tire:  85%|████████▌ | 179/210 [05:33<00:52,  1.69s/it]Extracting train features for class tire:  86%|████████▌ | 180/210 [05:34<00:51,  1.71s/it]Extracting train features for class tire:  86%|████████▌ | 181/210 [05:36<00:49,  1.72s/it]Extracting train features for class tire:  87%|████████▋ | 182/210 [05:38<00:47,  1.71s/it]Extracting train features for class tire:  87%|████████▋ | 183/210 [05:39<00:45,  1.69s/it]Extracting train features for class tire:  88%|████████▊ | 184/210 [05:41<00:43,  1.68s/it]Extracting train features for class tire:  88%|████████▊ | 185/210 [05:43<00:41,  1.68s/it]Extracting train features for class tire:  89%|████████▊ | 186/210 [05:44<00:39,  1.66s/it]Extracting train features for class tire:  89%|████████▉ | 187/210 [05:46<00:37,  1.64s/it]Extracting train features for class tire:  90%|████████▉ | 188/210 [05:48<00:35,  1.64s/it]Extracting train features for class tire:  90%|█████████ | 189/210 [05:49<00:34,  1.63s/it]Extracting train features for class tire:  90%|█████████ | 190/210 [05:51<00:32,  1.63s/it]Extracting train features for class tire:  91%|█████████ | 191/210 [05:52<00:30,  1.63s/it]Extracting train features for class tire:  91%|█████████▏| 192/210 [05:54<00:29,  1.62s/it]Extracting train features for class tire:  92%|█████████▏| 193/210 [05:56<00:27,  1.62s/it]Extracting train features for class tire:  92%|█████████▏| 194/210 [05:57<00:25,  1.62s/it]Extracting train features for class tire:  93%|█████████▎| 195/210 [05:59<00:24,  1.62s/it]Extracting train features for class tire:  93%|█████████▎| 196/210 [06:01<00:22,  1.62s/it]Extracting train features for class tire:  94%|█████████▍| 197/210 [06:02<00:21,  1.62s/it]Extracting train features for class tire:  94%|█████████▍| 198/210 [06:04<00:19,  1.62s/it]Extracting train features for class tire:  95%|█████████▍| 199/210 [06:05<00:17,  1.63s/it]Extracting train features for class tire:  95%|█████████▌| 200/210 [06:07<00:16,  1.63s/it]Extracting train features for class tire:  96%|█████████▌| 201/210 [06:09<00:14,  1.62s/it]Extracting train features for class tire:  96%|█████████▌| 202/210 [06:10<00:12,  1.61s/it]Extracting train features for class tire:  97%|█████████▋| 203/210 [06:12<00:11,  1.61s/it]Extracting train features for class tire:  97%|█████████▋| 204/210 [06:13<00:09,  1.61s/it]Extracting train features for class tire:  98%|█████████▊| 205/210 [06:15<00:08,  1.61s/it]Extracting train features for class tire:  98%|█████████▊| 206/210 [06:17<00:06,  1.61s/it]Extracting train features for class tire:  99%|█████████▊| 207/210 [06:18<00:04,  1.61s/it]Extracting train features for class tire:  99%|█████████▉| 208/210 [06:20<00:03,  1.62s/it]Extracting train features for class tire: 100%|█████████▉| 209/210 [06:22<00:01,  1.61s/it]Extracting train features for class tire: 100%|██████████| 210/210 [06:23<00:00,  1.61s/it]Extracting train features for class tire: 100%|██████████| 210/210 [06:23<00:00,  1.83s/it]


Running coreset for Fusion on class tire...
Traceback (most recent call last):
  File "main.py", line 99, in <module>
    run_3d_ads(args)
  File "main.py", line 31, in run_3d_ads
    model.fit(cls)
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/m3dm_runner.py", line 60, in fit
    method.run_coreset()
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/feature_extractors/features_dino_fusion.py", line 174, in run_coreset
    self.coreset_idx = get_coreset_idx_randomp(self.patch_lib,
  File "/youtu_fuxi_team1_ceph/yuanpengtu/noise_3D/M3DM_test3/utils/utils.py", line 48, in get_coreset_idx_randomp
    z_lib = torch.tensor(transformer.fit_transform(z_lib))
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/base.py", line 867, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/random_projection.py", line 359, in fit
    X = self._validate_data(
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/base.py", line 577, in _validate_data
    X = check_array(X, input_name="X", **check_params)
  File "/usr/local/python38/lib/python3.8/site-packages/sklearn/utils/validation.py", line 856, in check_array
    array = np.asarray(array, order=order, dtype=dtype)
  File "/usr/local/python38/lib/python3.8/site-packages/torch/_tensor.py", line 645, in __array__
    return self.numpy().astype(dtype, copy=False)
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
